<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado | Notas de Clase: Series de Tiempo</title>
  <meta name="description" content="Estas notas corresponde al curso de Series de Tiempo de la Facultad de Economía de la UNAM. Este es un trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo benjov@ciencias.unam.mx o omarxalpha@gmail.com" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado | Notas de Clase: Series de Tiempo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Estas notas corresponde al curso de Series de Tiempo de la Facultad de Economía de la UNAM. Este es un trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo benjov@ciencias.unam.mx o omarxalpha@gmail.com" />
  <meta name="github-repo" content="https://github.com/benjov/Series-Tiempo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado | Notas de Clase: Series de Tiempo" />
  
  <meta name="twitter:description" content="Estas notas corresponde al curso de Series de Tiempo de la Facultad de Economía de la UNAM. Este es un trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo benjov@ciencias.unam.mx o omarxalpha@gmail.com" />
  

<meta name="author" content="Benjamín Oliva, Omar Alfaro Rivera &amp; Emiliano Pérez Caullieres" />


<meta name="date" content="2025-07-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="procesos-no-estacionarios-univariados.html"/>
<link rel="next" href="modelos-univariados-y-multivariados-de-volatilidad.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path=""><a href="#an%C3%A1lisis-de-series-de-tiempo"><i class="fa fa-check"></i>Análisis de Series de Tiempo</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Contexto del documento</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="05-VAR.html"><a href="#introducci%C3%B3n"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="05-VAR.html"><a href="#introducci%C3%B3n-al-an%C3%A1lisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia"><i class="fa fa-check"></i><b>2</b> Introducción al Análisis de Series de Tiempo y Elementos de Ecuaciones en Diferencia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><i class="fa fa-check"></i><b>2.1</b> La naturaleza de los datos de Series de Tiempo</a></li>
<li class="chapter" data-level="2.2" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html#ejemplos-y-aplicaciones-de-las-series-de-tiempo"><i class="fa fa-check"></i><b>2.2</b> Ejemplos y aplicaciones de las Series de Tiempo</a></li>
<li class="chapter" data-level="2.3" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html#ecuaciones-en-diferencia-para-procesos-deterministas"><i class="fa fa-check"></i><b>2.3</b> Ecuaciones en Diferencia para procesos deterministas</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html#ecuaciones-en-diferencia-lineales-de-primer-orden"><i class="fa fa-check"></i><b>2.3.1</b> Ecuaciones en Diferencia Lineales de Primer Orden</a></li>
<li class="chapter" data-level="2.3.2" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html#ecuaciones-en-diferencia-lineales-de-segundo-orden-y-de-orden-superior"><i class="fa fa-check"></i><b>2.3.2</b> Ecuaciones en Diferencia Lineales de Segundo Orden y de orden superior</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><a href="introducción-al-análisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html#operador-de-rezago-l"><i class="fa fa-check"></i><b>2.4</b> Operador de rezago L</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html"><i class="fa fa-check"></i><b>3</b> Procesos Estacionarios y Modelos Univariados</a>
<ul>
<li class="chapter" data-level="3.1" data-path="05-VAR.html"><a href="#definici%C3%B3n-de-ergodicidad-y-estacionariedad"><i class="fa fa-check"></i><b>3.1</b> Definición de ergodicidad y estacionariedad</a></li>
<li class="chapter" data-level="3.2" data-path="05-VAR.html"><a href="#funci%C3%B3n-de-autocorrelaci%C3%B3n"><i class="fa fa-check"></i><b>3.2</b> Función de autocorrelación</a></li>
<li class="chapter" data-level="3.3" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#procesos-estacionarios-univariados"><i class="fa fa-check"></i><b>3.3</b> Procesos estacionarios univariados</a></li>
<li class="chapter" data-level="3.4" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#procesos-autoregresivos-ar"><i class="fa fa-check"></i><b>3.4</b> Procesos Autoregresivos (AR)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#ar1"><i class="fa fa-check"></i><b>3.4.1</b> AR(1)</a></li>
<li class="chapter" data-level="3.4.2" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#ar2"><i class="fa fa-check"></i><b>3.4.2</b> AR(2)</a></li>
<li class="chapter" data-level="3.4.3" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#arp"><i class="fa fa-check"></i><b>3.4.3</b> AR(p)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="05-VAR.html"><a href="#procesos-de-medias-m%C3%B3viles-ma"><i class="fa fa-check"></i><b>3.5</b> Procesos de Medias Móviles (MA)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#ma1"><i class="fa fa-check"></i><b>3.5.1</b> MA(1)</a></li>
<li class="chapter" data-level="3.5.2" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#maq"><i class="fa fa-check"></i><b>3.5.2</b> MA(q)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#procesos-armap-q-y-arimap-d-q"><i class="fa fa-check"></i><b>3.6</b> Procesos ARMA(p, q) y ARIMA(p, d, q)</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#arma1-1"><i class="fa fa-check"></i><b>3.6.1</b> ARMA(1, 1)</a></li>
<li class="chapter" data-level="3.6.2" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#armap-q"><i class="fa fa-check"></i><b>3.6.2</b> ARMA(p, q)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="05-VAR.html"><a href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><i class="fa fa-check"></i><b>3.7</b> Función de Autocorrelación Parcial</a></li>
<li class="chapter" data-level="3.8" data-path="05-VAR.html"><a href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><i class="fa fa-check"></i><b>3.8</b> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)</a></li>
<li class="chapter" data-level="3.9" data-path="05-VAR.html"><a href="#pron%C3%B3sticos"><i class="fa fa-check"></i><b>3.9</b> Pronósticos</a></li>
<li class="chapter" data-level="3.10" data-path="05-VAR.html"><a href="#desestacionalizaci%C3%B3n-y-filtrado-de-series"><i class="fa fa-check"></i><b>3.10</b> Desestacionalización y filtrado de Series</a></li>
<li class="chapter" data-level="3.11" data-path="05-VAR.html"><a href="#motivaci%C3%B3n"><i class="fa fa-check"></i><b>3.11</b> Motivación</a></li>
<li class="chapter" data-level="3.12" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#filtro-hodrick-prescott"><i class="fa fa-check"></i><b>3.12</b> Filtro Hodrick-Prescott</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="procesos-estacionarios-y-modelos-univariados.html"><a href="procesos-estacionarios-y-modelos-univariados.html#filtro-hodrick-prescott-planteado-por-st-amant-van-norden"><i class="fa fa-check"></i><b>3.12.1</b> Filtro Hodrick-Prescott planteado por St-Amant &amp; van Norden</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="procesos-no-estacionarios-univariados.html"><a href="procesos-no-estacionarios-univariados.html"><i class="fa fa-check"></i><b>4</b> Procesos No Estacionarios Univariados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="05-VAR.html"><a href="#definici%C3%B3n-y-formas-de-no-estacionariedad"><i class="fa fa-check"></i><b>4.1</b> Definición y formas de No Estacionariedad</a></li>
<li class="chapter" data-level="4.2" data-path="05-VAR.html"><a href="#pruebas-de-ra%C3%ADces-unitarias"><i class="fa fa-check"></i><b>4.2</b> Pruebas de Raíces Unitarias</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="procesos-no-estacionarios-univariados.html"><a href="procesos-no-estacionarios-univariados.html#dickey---fuller-df"><i class="fa fa-check"></i><b>4.2.1</b> Dickey - Fuller (DF)</a></li>
<li class="chapter" data-level="4.2.2" data-path="procesos-no-estacionarios-univariados.html"><a href="procesos-no-estacionarios-univariados.html#dickey---fuller-aumentada-adf"><i class="fa fa-check"></i><b>4.2.2</b> Dickey - Fuller Aumentada (ADF)</a></li>
<li class="chapter" data-level="4.2.3" data-path="procesos-no-estacionarios-univariados.html"><a href="procesos-no-estacionarios-univariados.html#phillips---perron-pp"><i class="fa fa-check"></i><b>4.2.3</b> Phillips - Perron (PP)</a></li>
<li class="chapter" data-level="4.2.4" data-path="procesos-no-estacionarios-univariados.html"><a href="procesos-no-estacionarios-univariados.html#kwiatkowsky---phillips---schmidt---shin-kpss"><i class="fa fa-check"></i><b>4.2.4</b> Kwiatkowsky - Phillips - Schmidt - Shin (KPSS)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-VAR.html"><a href="#causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegraci%C3%B3n-modelos-ardl-y-filtro-multivariado"><i class="fa fa-check"></i><b>5</b> Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado</a>
<ul>
<li class="chapter" data-level="5.1" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><i class="fa fa-check"></i><b>5.1</b> Causalidad de Granger</a></li>
<li class="chapter" data-level="5.2" data-path="05-VAR.html"><a href="#definici%C3%B3n-y-representaci%C3%B3n-del-sistema-o-modelo-de-vectores-autorregresicos-varp"><i class="fa fa-check"></i><b>5.2</b> Definición y representación del Sistema o Modelo de Vectores Autorregresicos (VAR(p))</a></li>
<li class="chapter" data-level="5.3" data-path="05-VAR.html"><a href="#an%C3%A1lisis-de-impulso-respuesta"><i class="fa fa-check"></i><b>5.3</b> Análisis de Impulso-Respuesta</a></li>
<li class="chapter" data-level="5.4" data-path="05-VAR.html"><a href="#identificaci%C3%B3n-de-los-choques-estructurales-en-los-modelos-var"><i class="fa fa-check"></i><b>5.4</b> Identificación de los Choques Estructurales en los Modelos VAR</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="05-VAR.html"><a href="#var-recursivo---identificaci%C3%B3n-recursiva"><i class="fa fa-check"></i><b>5.4.1</b> VAR Recursivo - Identificación Recursiva</a></li>
<li class="chapter" data-level="5.4.2" data-path="05-VAR.html"><a href="#var-estructural---restricci%C3%B3n-de-largo-plazo"><i class="fa fa-check"></i><b>5.4.2</b> VAR Estructural - Restricción de largo plazo</a></li>
<li class="chapter" data-level="5.4.3" data-path="05-VAR.html"><a href="#var-estructural---imposici%C3%B3n-de-restricciones-de-signo"><i class="fa fa-check"></i><b>5.4.3</b> VAR Estructural - Imposición de restricciones de signo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="05-VAR.html"><a href="#cointegraci%C3%B3n"><i class="fa fa-check"></i><b>5.5</b> Cointegración</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="05-VAR.html"><a href="#definici%C3%B3n-y-propiedades-del-proceso-de-cointegraci%C3%B3n"><i class="fa fa-check"></i><b>5.5.1</b> Definición y propiedades del proceso de cointegración</a></li>
<li class="chapter" data-level="5.5.2" data-path="05-VAR.html"><a href="#cointegraci%C3%B3n-para-modelos-de-m%C3%A1s-de-una-ecuaci%C3%B3n-o-para-modelos-basados-en-vectores-autoregresivos"><i class="fa fa-check"></i><b>5.5.2</b> Cointegración para modelos de más de una ecuación o para modelos basados en Vectores Autoregresivos</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#modelos-adrl"><i class="fa fa-check"></i><b>5.6</b> Modelos ADRL</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="05-VAR.html"><a href="#teor%C3%ADa"><i class="fa fa-check"></i><b>5.6.1</b> Teoría</a></li>
<li class="chapter" data-level="5.6.2" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#ejemplo"><i class="fa fa-check"></i><b>5.6.2</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#filtro-kalman"><i class="fa fa-check"></i><b>5.7</b> Filtro Kalman</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="05-VAR.html"><a href="#modelos-estado-espacio-y-teor%C3%ADa-econ%C3%B3mica"><i class="fa fa-check"></i><b>5.7.1</b> Modelos Estado-Espacio y Teoría Económica</a></li>
<li class="chapter" data-level="5.7.2" data-path="05-VAR.html"><a href="#recursi%C3%B3n-del-filtro-kalman"><i class="fa fa-check"></i><b>5.7.2</b> Recursión del Filtro Kalman</a></li>
<li class="chapter" data-level="5.7.3" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#ganancia-de-kalman"><i class="fa fa-check"></i><b>5.7.3</b> Ganancia de Kalman</a></li>
<li class="chapter" data-level="5.7.4" data-path="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#algoritmo-del-filtro-kalman-y-del-suavizador-de-kalman"><i class="fa fa-check"></i><b>5.7.4</b> Algoritmo del Filtro Kalman y del Suavizador de Kalman</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html"><i class="fa fa-check"></i><b>6</b> Modelos Univariados y Multivariados de Volatilidad</a>
<ul>
<li class="chapter" data-level="6.1" data-path="05-VAR.html"><a href="#motivaci%C3%B3n-1"><i class="fa fa-check"></i><b>6.1</b> Motivación</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#value-at-risk-var"><i class="fa fa-check"></i><b>6.1.1</b> Value at Risk (VaR)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#prueba-de-normalidad"><i class="fa fa-check"></i><b>6.2</b> Prueba de normalidad</a></li>
<li class="chapter" data-level="6.3" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#modelos-arch-y-garch-univariados"><i class="fa fa-check"></i><b>6.3</b> Modelos ARCH y GARCH Univariados</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#ejemplo-arch1"><i class="fa fa-check"></i><b>6.3.1</b> Ejemplo ARCH(1)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#ejemplo-garch01"><i class="fa fa-check"></i><b>6.4</b> Ejemplo GARCH(0,1)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="05-VAR.html"><a href="#selecci%C3%B3n-garchpq-%C3%B3ptimo"><i class="fa fa-check"></i><b>6.4.1</b> Selección GARCH(p,q) óptimo</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#modelos-arch-y-garch-multivariados"><i class="fa fa-check"></i><b>6.5</b> Modelos ARCH y GARCH Multivariados</a></li>
<li class="chapter" data-level="6.6" data-path="modelos-univariados-y-multivariados-de-volatilidad.html"><a href="modelos-univariados-y-multivariados-de-volatilidad.html#pruebas-para-detectar-efectos-arch"><i class="fa fa-check"></i><b>6.6</b> Pruebas para detectar efectos ARCH</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><i class="fa fa-check"></i><b>7</b> Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#modelos-de-datos-panel-y-panel-var"><i class="fa fa-check"></i><b>7.1</b> Modelos de Datos Panel y Panel VAR</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="05-VAR.html"><a href="#motivaci%C3%B3n-2"><i class="fa fa-check"></i><b>7.1.1</b> Motivación</a></li>
<li class="chapter" data-level="7.1.2" data-path="05-VAR.html"><a href="#pruebas-de-ra%C3%ADces-unitarias-en-panel"><i class="fa fa-check"></i><b>7.1.2</b> Pruebas de Raíces Unitarias en Panel</a></li>
<li class="chapter" data-level="7.1.3" data-path="05-VAR.html"><a href="#ejemplo-pruebas-de-ra%C3%ADces-unitarias-en-panel"><i class="fa fa-check"></i><b>7.1.3</b> Ejemplo: Pruebas de Raíces Unitarias en Panel</a></li>
<li class="chapter" data-level="7.1.4" data-path="05-VAR.html"><a href="#ejemplo-modelo-dif-in-dif-para-el-inpc-de-an%C3%A1lisis-cl%C3%ADnicos-update-nov-2022"><i class="fa fa-check"></i><b>7.1.4</b> Ejemplo: Modelo Dif-in-Dif para el INPC de análisis clínicos (update nov-2022)</a></li>
<li class="chapter" data-level="7.1.5" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#panel-var"><i class="fa fa-check"></i><b>7.1.5</b> Panel VAR</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#ejemplos-panel-varp"><i class="fa fa-check"></i><b>7.2</b> Ejemplos: Panel VAR(p)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#ejemplo-1"><i class="fa fa-check"></i><b>7.2.1</b> Ejemplo 1</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#ejemplo-2"><i class="fa fa-check"></i><b>7.2.2</b> Ejemplo 2:</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="05-VAR.html"><a href="#cointegraci%C3%B3n-1"><i class="fa fa-check"></i><b>7.3</b> Cointegración</a></li>
<li class="chapter" data-level="7.4" data-path="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><a href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html#modelos-no-lineales"><i class="fa fa-check"></i><b>7.4</b> Modelos No Lineales</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="05-VAR.html"><a href="#modelos-de-cambio-de-r%C3%A9gimen"><i class="fa fa-check"></i><b>7.4.1</b> Modelos de cambio de régimen</a></li>
<li class="chapter" data-level="7.4.2" data-path="05-VAR.html"><a href="#reg%C3%ADmenes-determinados-por-informaci%C3%B3n-observable"><i class="fa fa-check"></i><b>7.4.2</b> Regímenes determinados por información observable</a></li>
<li class="chapter" data-level="7.4.3" data-path="05-VAR.html"><a href="#reg%C3%ADmenes-determinados-por-variables-no-observables"><i class="fa fa-check"></i><b>7.4.3</b> Regímenes determinados por variables no observables</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="05-VAR.html"><a href="#ejemplo-modelos-de-cambio-de-reg%C3%ADmen-tar"><i class="fa fa-check"></i><b>7.5</b> Ejemplo: Modelos de Cambio de Regímen (TAR)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de Clase: Series de Tiempo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado<a href="#causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegraci%C3%B3n-modelos-ardl-y-filtro-multivariado" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En este capítulo removeremos el supuesto de que el análisis es
univariado, ya que introduciremos la posibilidad de que los procesos
generadores de datos compartan información entre dos o más series. Como
primera aproximación desarrollaremos el concepto de Causalidad de
Granger. Mediante esta metodología discutiremos cuándo dos series se
causan estadísticamente. Posteriormente, introduciremos una técnica más
sofisticada conocida como la metodología de Vectores Autoregresivos
(VAR), la cual es una generalización de los procesos Autoregresivos (AR)
que analizamos al principio del curso. Finalmente, introduciremos la
técnica de cointegración y de rezagos distribuidos (ARDL) para los casos
en que las series que analicemos sean procesos no estacionarios.</p>
<p>A partir de este punto, asumiremos que las series empleadas son
estacionarias en sus primeras diferencias y solo nos preocuparemos por
su estacionariedad en los casos particulares de Cointegración y los
modelos ARDL.</p>
<div id="causalidad-de-granger" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Causalidad de Granger<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#causalidad-de-granger" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta ahora hemos supuesto que una serie puede ser explicada únicamente
con la información contenida en ella misma. No obstante, en adelante
trataremos de analizar el caso en el que buscamos determinar relaciones
entre variables y cómo el comportamiento de una serie influye en las
demás. Algunas relaciones más importantes son las llamadas: causalidad.
En este caso analizaremos el procedimiento de Granger (1969), conocido
como causalidad de Granger. En adelante asumiremos que las series
involucradas son débilmente estacionarias.</p>
<p>Sean <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> dos series débilmente estacionarias. Definamos a <span class="math inline">\(I_t\)</span> un
conjunto de toda la información disponible hasta el momento <span class="math inline">\(t\)</span>.
Asimismo, digamos que <span class="math inline">\(\overline{X}_t\)</span> y <span class="math inline">\(\overline{Y}_t\)</span> son los
conjuntos de toda la información disponible (actual y pasada) de <span class="math inline">\(X\)</span> y
<span class="math inline">\(Y\)</span>, respectivamente. Es decir: <span class="math display">\[\begin{eqnarray*}
    \overline{X}_t &amp; := &amp; \{ X_t, X_{t-1}, X_{t-2}, \ldots \} \\
    \overline{Y}_t &amp; := &amp; \{ Y_t, Y_{t-1}, Y_{t-2}, \ldots \} \\
    I_t &amp; := &amp; \overline{X}_t + \overline{Y}_t
\end{eqnarray*}\]</span></p>
<p>Adicionalmente, definamos <span class="math inline">\(\sigma^2(*)\)</span> como la varianza del término de
error estimado de una regresión dada. Dicho lo anterior, digamos que:</p>
<p>La definición anterior aplica de igual forma si se reemplaza a <span class="math inline">\(X\)</span> por
<span class="math inline">\(Y\)</span> y a <span class="math inline">\(Y\)</span> por <span class="math inline">\(X\)</span>, respectivamente. De acuerdo a la definición
anterior, existen 5 diferentes posibilidades de relaciones causales
entre las dos series:</p>
<p>Por lo anterior, representaremos mediante un <span class="math inline">\(AR(p)\)</span> con variables
exógenas lo siguiente: <span class="math display">\[\begin{equation}
    A(L)
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    a_{11}(L) &amp; a_{12}(L) \\ a_{21}(L) &amp; a_{22}(L)
    \end{bmatrix}
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
    (\#eq:GrangerEq)
\end{equation}\]</span></p>
<p>O en su versión <span class="math inline">\(MA(q)\)</span> con variables exógenas: <span class="math display">\[\begin{equation}
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    B(L)
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    b_{11}(L) &amp; b_{12}(L) \\ b_{21}(L) &amp; b_{22}(L)
    \end{bmatrix}
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
\end{equation}\]</span></p>
<p>Para determinar el test de causalidad utilizaremos una especificación
similar a la de la ecuación <a href="#eq:GrangerEq">(<strong>??</strong>)</a>. Para probar si <span class="math inline">\(X\)</span>
causa a <span class="math inline">\(Y\)</span>, consideraremos la siguiente regresión: <span class="math display">\[\begin{equation}
    Y_t = \alpha_0 + \sum^{k_1}_{k = 1} a^k_{11} Y_{t-k} + \sum^{k_2}_{k = k_0} a^k_{12} X_{t-k} + U_{1,t}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(k_0 = 1\)</span> y, en general, se asume que <span class="math inline">\(k_1 = k_2\)</span>. Asimismo, el
valor de estas constantes se puede determinar con el criterio de Akaike
(o cualquier otro criterio de información). No obstante, algunos autores
sugieren que una buena práctica es considerar valores de <span class="math inline">\(k_1\)</span> y <span class="math inline">\(k_2\)</span>
que recorran al 4, 8, 12 y 16.</p>
<p>Dicho lo anterior, el test de causalidad de Granger se establece con una
prueba F, en la cual se prueba la siguiente hipótesis nula:
<span class="math display">\[\begin{equation}
    H_0: a^1_{12} = a^2_{12} = \ldots = a^{k2}_{12} = 0
\end{equation}\]</span></p>
<p>. Consideremos como variables analizadas al Índice
Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>), al Tipo de Cambio
(<span class="math inline">\(TDC_t\)</span>) y al rendimiento anual de los Cetes a 28 días (<span class="math inline">\(CETE28_t\)</span>),
todas desestacionalizadas para el periodo de enero de 2000 a julio de
2019. Dado que la metodología de Granger supone que las series son
estacionarias, utilizaremos las diferencias logarítmicas de cada una de
las tres series (es decir, utilizaremos una transformación del tipo
<span class="math inline">\(ln(X_t) - ln(X_{t-1})\)</span>). La Figura <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig61">5.1</a> muestra las series
en su transformación de diferencias logarítmicas.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb1-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-7" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb1-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-8" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb1-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-9" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-10" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb1-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb1-13"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-13" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Datos_Ad.RData&quot;</span>)</span>
<span id="cb1-14"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-15" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb1-16"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-16" tabindex="-1"></a>INPC <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>INPC_Ad, </span>
<span id="cb1-17"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-17" tabindex="-1"></a>           <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb1-18"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-18" tabindex="-1"></a>           <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb1-19"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-20" tabindex="-1"></a>DLINPC <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>INPC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb1-21"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-22" tabindex="-1"></a>TC <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>TC_Ad, </span>
<span id="cb1-23"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-23" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb1-24"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-24" tabindex="-1"></a>         <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb1-25"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-25" tabindex="-1"></a></span>
<span id="cb1-26"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-26" tabindex="-1"></a>DLTC <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>TC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb1-27"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-27" tabindex="-1"></a></span>
<span id="cb1-28"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-28" tabindex="-1"></a>CETE28 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad, </span>
<span id="cb1-29"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-29" tabindex="-1"></a>             <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb1-30"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-30" tabindex="-1"></a>             <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb1-31"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-31" tabindex="-1"></a></span>
<span id="cb1-32"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb1-32" tabindex="-1"></a>DLCETE28 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-2" tabindex="-1"></a><span class="co">#png(&quot;Plots/DLGranger.png&quot;, width = 800, height = 1200)</span></span>
<span id="cb2-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb2-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-6" tabindex="-1"></a><span class="fu">plot</span>(DLINPC, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb2-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diferencias Logarítmicas del INPC&quot;</span>,</span>
<span id="cb2-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-8" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb2-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-10" tabindex="-1"></a><span class="fu">plot</span>(DLTC, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb2-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-11" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diferencias Logarítmicas del Tipo de Cambio&quot;</span>,</span>
<span id="cb2-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-12" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb2-13"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-14" tabindex="-1"></a><span class="fu">plot</span>(DLCETE28, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb2-15"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-15" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diferencias Logarítmicas de los Cetes a 28 dias&quot;</span>,</span>
<span id="cb2-16"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb2-16" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig61"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig61-1.png" alt="Series en diferencias logarítmicas dadas por las siguientes expresiones: $DLINPC_t = ln(DLINPC_t) - ln(DLINPC_{t-1})$, $DLTC_t = ln(TC_t) - ln(TC_{t-1})$ y $DLCETE28_t = ln(CETE28_t) - ln(CETE28_{t-1})$." width="672" />
<p class="caption">
Figure 5.1: Series en diferencias logarítmicas dadas por las siguientes expresiones: <span class="math inline">\(DLINPC_t = ln(DLINPC_t) - ln(DLINPC_{t-1})\)</span>, <span class="math inline">\(DLTC_t = ln(TC_t) - ln(TC_{t-1})\)</span> y <span class="math inline">\(DLCETE28_t = ln(CETE28_t) - ln(CETE28_{t-1})\)</span>.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb3-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb3-3" tabindex="-1"></a><span class="co">#dev.off()</span></span></code></pre></div>
<p>Por simplicidad, en el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:Granger">5.1</a> se muestra el resultado
de aplicar el test de Granger a diferentes especificaciones, con rezagos
4, 8, 12 y 16, sólo para la serie de Tipo de Cambio en diferencias
logarítmicas. En cada una de las pruebas se compara el modelo
considerado como regresor a la variable que es candidata de causar,
respecto del modelo sin considerar a dicha variable.</p>
<table>
<caption><span id="tab:Granger">Table 5.1: </span> Prueba de si <span class="math inline">\(DLINPC_t\)</span> Granger causa a <span class="math inline">\(DLTC_t\)</span>.</caption>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">Estadiística F</th>
<th align="center">Probabilidad (<span class="math inline">\(&gt;\)</span>F)</th>
<th align="center">Significancia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">3.2621</td>
<td align="center">0.01265</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">1.9079</td>
<td align="center">0.06030</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">2.2577</td>
<td align="center">0.01067</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="center">1.6735</td>
<td align="center">0.05495</td>
<td align="center">*</td>
</tr>
<tr class="odd">
<td align="center">Notas:</td>
<td align="center">***</td>
<td align="center">signif.</td>
<td align="center">al 0.1%</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center">**</td>
<td align="center">signif.</td>
<td align="center">al 1%</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">*</td>
<td align="center">signif.</td>
<td align="center">al 5%</td>
</tr>
</tbody>
</table>
<p>De acuerdo con el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:Granger">5.1</a>, podemos concluir que existe
información estadísticamente significativa para concluir que la
inflación causa a la tasa de depreciación cambiaria, ambas medidas como
las diferencias logaritmicas. El resto de los resultados para las otras
combinaciones de causalidad se encuentran en el R Markdown llamado Clase
13 ubicado en el repositorio de GitHub.</p>
</div>
<div id="definición-y-representación-del-sistema-o-modelo-de-vectores-autorregresicos-varp" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Definición y representación del Sistema o Modelo de Vectores Autorregresicos (VAR(p))<a href="#definici%C3%B3n-y-representaci%C3%B3n-del-sistema-o-modelo-de-vectores-autorregresicos-varp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección ampliaremos la discusión planteada en el apartado
anterior. En el sentido de que en la sección pasada nuestra discusión se
limitó al análisis de causalidad entre dos variables a la vez, que si
bien es posible extenderlo a más variables, es un procedimiento limitado
a casos particulares por las siguientes razones.</p>
<p>El procedimiento de causalidad de Granger supone que es posible
identificar un sistema de ecuaciones que debe conformarse una vez que se
ha identificado el sentido de la causalidad. Así, el proceso anterior
necesita del conocimiento previo de las relaciones que existen entre las
variables.</p>
<p>Adicionalmente, no resuelve el problema más general que está relacionado
con cómo identificar la causalidad cuando se tienen múltiples variables
con múltiples sentidos de causalidad. En esta sección analizaremos una
mejor aproximación al problema de cómo identificar la causalidad
múltiple. Por lo tanto, como mecanismo para solucionar el problema
planteado, analizaremos el caso de un Sistema o Modelo de Vectores
Autoregresivos conocido como VAR.</p>
<p>El primer supuesto del que partiremos es que existe algún grado de
endogeneidad entre las variables consideradas en el análisis.
Adicionalmente, el segundo supuesto que estableceremos es que requerimos
que las variables que tengamos consideradas sean estacionarias.</p>
<p>Por lo anterior, diremos que un modelo de Vectores Autoregresivos (VAR)
es un procedimiento que sigue fundado en el supuesto de que las
variables consideradas son estacionarias. Así, hasta este momento del
curso hemos pasado de modelos univariados a modelos multivariados, pero
no hemos podido dejar de asumir que las series son estacionarias.</p>
<p>En lo subsecuente asumiremos que las series empleadas son estacionarias
y sólo lo demostraremos cuando, en su caso, sea necesario. Esto no
significa que el lector deba asumir estacionariedad. Por el contrario,
siempre debe probar que las series son estacionarias antes de iniciar la
implementación de cualquier técnica de series de tiempo.</p>
<p>Ahora bien, iniciaremos con el establecimiento de la representación del
proceso. Digamos que tenemos un proceso estocástico <span class="math inline">\(\mathbf{X}_t\)</span>
estacionario vectorial de dimensión <span class="math inline">\(k\)</span>: <span class="math display">\[\begin{equation*}
    \mathbf{X}_t =
    \begin{bmatrix}
    X_{1t} \\ X_{2t} \\ \vdots \\ X_{kt}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Para cualquier <span class="math inline">\(i = 1, 2, \ldots, p\)</span>: <span class="math display">\[\begin{equation*}
    \mathbf{X}_{t-i} =
    \begin{bmatrix}
    X_{1t-i} \\ X_{2t-i} \\ \vdots \\ X_{kt-i}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Donde cada <span class="math inline">\(X_{kt}\)</span> en <span class="math inline">\(\mathbf{X}_t\)</span> es una serie de tiempo por sí
misma. De esta forma, la expresión reducida del modelo o el proceso
<span class="math inline">\(VAR(p)\)</span> estará dado por: <span class="math display">\[\begin{equation}
    \mathbf{X}_t = \boldsymbol{\delta} + A_1 \mathbf{X}_{t-1} + A_2 \mathbf{X}_{t-2} + \ldots + A_p \mathbf{X}_{t-p} + \mathbf{U}_{t}
    (\#eq:VARp)
\end{equation}\]</span></p>
<p>Donde cada uno de las <span class="math inline">\(A_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, son matrices
cuadradas de dimensión <span class="math inline">\(k\)</span> y <span class="math inline">\(\mathbf{U}_t\)</span> representa un vector de
dimensión <span class="math inline">\(k \times 1\)</span> con los residuales en el momento del tiempo <span class="math inline">\(t\)</span>
que son, por individual, un proceso puramente aleatorio. También se
incorpora un vector de términos constantes denominado como
<span class="math inline">\(\mathbf{\delta}\)</span>, el cual es de dimensión <span class="math inline">\(k \times 1\)</span>.</p>
<p>Así, la ecuación <a href="#eq:VARp">(<strong>??</strong>)</a> supone la siguiente estructura del
vector <span class="math inline">\(\boldsymbol{\delta}\)</span>: <span class="math display">\[\begin{equation*}
    \boldsymbol{\delta} =
    \begin{bmatrix}
    \delta_{1} \\ \delta_{2} \\ \vdots \\ \delta_{k}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>También, la ecuación <a href="#eq:VARp">(<strong>??</strong>)</a> supone que cada matriz <span class="math inline">\(A_i\)</span>,
<span class="math inline">\(i = 1, 2, \ldots, p\)</span> está definida de la siguiente forma:
<span class="math display">\[\begin{equation*}
    \mathbf{A}_i =
    \begin{bmatrix}
    a^{(i)}_{11} &amp; a^{(i)}_{12} &amp; \ldots &amp; a^{(i)}_{1k} \\ a^{(i)}_{21} &amp; a^{(i)}_{22} &amp; \ldots &amp; a^{(i)}_{2k} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ a^{(i)}_{k1} &amp; a^{(i)}_{k2} &amp; \ldots &amp; a^{(i)}_{kk}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(i = 1, 2, \ldots, p\)</span>.</p>
<p>Retomando la ecuación <a href="#eq:VARp">(<strong>??</strong>)</a> y considerando que podemos ocupar
el operador rezago <span class="math inline">\(L^j\)</span> de forma análoga al caso del modelo <span class="math inline">\(AR(p)\)</span>,
pero aplicado a un vector, tenemos las siguientes ecuaciones:
<span class="math display" id="eq:VARCorto">\[\begin{eqnarray}
    \mathbf{X}_t - A_1 \mathbf{X}_{t-1} - A_2 \mathbf{X}_{t-2} - \ldots - A_p \mathbf{X}_{t-p} &amp; = &amp; \boldsymbol{\delta} + \mathbf{U}_{t} \nonumber \\
    \mathbf{X}_t - A_1 L \mathbf{X}_{t} - A_2 L^2 \mathbf{X}_{t} - \ldots - A_p L^p \mathbf{X}_{t-p} &amp; = &amp; \boldsymbol{\delta} + \mathbf{U}_{t} \nonumber \\
    (I_k - \mathbf{A_1} L - \mathbf{A_2} L^2 - \ldots - \mathbf{A_p} L^p) \mathbf{X}_t &amp; = &amp; \boldsymbol{\delta} + \mathbf{U}_{t} \nonumber \\
    \mathbf{A}(L) \mathbf{X}_t &amp; = &amp; \boldsymbol{\delta} + \mathbf{U}_{t}
    \tag{5.1}
\end{eqnarray}\]</span></p>
<p>Adicionalmente, requeriremos que dado que <span class="math inline">\(\mathbf{U}_t\)</span> es un proceso
puramente aleatorio, este debe cumplir con las siguientes condiciones:</p>
<ol style="list-style-type: decimal">
<li><p>El valor esperado del término de error es cero: <span class="math display">\[\begin{equation}
   \mathbb{E}[\mathbf{U}_t] = 0
  \end{equation}\]</span></p></li>
<li><p>Existe una matriz de varianzas y covarianzas entre los términos de
error contemporáneos dada por: <span class="math display">\[\begin{eqnarray}
   \mathbb{E}[\mathbf{U}_t \mathbf{U}_t&#39;]
   &amp; = &amp;
   \mathbb{E} \left[
   \begin{bmatrix}
   U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
   \end{bmatrix}
   \begin{bmatrix}
   U^{(t)}_{1} &amp; U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k}
   \end{bmatrix}
   \right] \nonumber \\
   &amp; = &amp; \mathbb{E}
   \begin{bmatrix}
   U^{(t)}_{1} U^{(t)}_{1} &amp; U^{(t)}_{1} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{1} U^{(t)}_{k} \\
   U^{(t)}_{2} U^{(t)}_{1} &amp; U^{(t)}_{2} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{2} U^{(t)}_{k} \\
   \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
   U^{(t)}_{k} U^{(t)}_{1} &amp; U^{(t)}_{k} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k} U^{(t)}_{k}
   \end{bmatrix} \nonumber \\
   &amp; = &amp; \begin{bmatrix}
   \sigma^2_1 &amp; \rho_{12} &amp; \ldots &amp; \rho_{1k} \\
   \rho_{21} &amp; \sigma^2_2 &amp; \ldots &amp; \rho_{2k} \\
   \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
   \rho_{k1} &amp; \rho_{k2} &amp; \ldots &amp; \sigma^2_k
   \end{bmatrix} \nonumber \\
   &amp; = &amp; \mathbf{\Sigma}_{UU}
   (\#eq:SigmaVAR)
  \end{eqnarray}\]</span></p></li>
<li><p>La matriz de varianzas y covarianzas no contemporáneas es nula. Es
decir, que para todo <span class="math inline">\(t \neq s\)</span>: <span class="math display">\[\begin{eqnarray}
    \mathbb{E} [\mathbf{U}_t \mathbf{U}_s&#39;]
    &amp; = &amp;
    \mathbb{E} \left[
    \begin{bmatrix}
    U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
    \end{bmatrix}
    \begin{bmatrix}
    U^{(s)}_{1} &amp; U^{(s)}_{2} &amp; \ldots &amp; U^{(s)}_{k}
    \end{bmatrix}
    \right] \nonumber \\
    &amp; =  &amp; \mathbb{E}
    \begin{bmatrix}
    U^{(t)}_{1} U^{(s)}_{1} &amp; U^{(t)}_{1} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{1} U^{(s)}_{k} \\
    U^{(t)}_{2} U^{(s)}_{1} &amp; U^{(t)}_{2} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{2} U^{(s)}_{k} \\
    \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
    U^{(t)}_{k} U^{(s)}_{1} &amp; U^{(t)}_{k} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{k} U^{(s)}_{k}
    \end{bmatrix} \nonumber \\
    &amp; = &amp; \mathbf{0}
    (\#eq:RhoVAR)
\end{eqnarray}\]</span></p></li>
</ol>
<p>Las ecuaciones <a href="#eq:SigmaVAR">(<strong>??</strong>)</a> y <a href="#eq:RhoVAR">(<strong>??</strong>)</a> significan que los
residuales <span class="math inline">\(\mathbf{U}_t\)</span> pueden estar correlacionados entre ellos solo
en el caso de que la información sea contemporánea, pero no tienen
información en común entre residuales de otros periodos.</p>
<p>Al igual que en el caso del modelo o especificación <span class="math inline">\(AR(p)\)</span> en la
especificación del modelo <span class="math inline">\(VAR(p)\)</span> existen condiciones de estabilidad.
Dichas condiciones están dadas por lo siguiente, definamos el siguiente
polinomio que resulta de tomar la matriz <span class="math inline">\(\mathbf{A}(L)\)</span> en la ecuación
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:VARCorto">(5.1)</a>: <span class="math display">\[\begin{equation}
    Det[I_t - A_1 z - A_2 z^2 - \ldots - A_p z^p] \neq 0
\end{equation}\]</span></p>
<p>Donde las raíces del polinomio cumplen que <span class="math inline">\(|z| \leq 1\)</span>, es decir, se
ubican dentro del circulo unitario.</p>
<p>La ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:VARCorto">(5.1)</a> puede ser rexpresada en una forma similar
al un proceso de MA. Al respecto, de forma similar a la siguiente
ecuación podemos construir un modelo <span class="math inline">\(VARMA(p,q)\)</span>, el cual no estudiamos
es este curso.</p>
<p>Reromando el primer planteamiento, podemos escribir: <span class="math display">\[\begin{eqnarray}
    \mathbf{X}_t &amp; = &amp; \mathbf{A}^{-1}(L) \boldsymbol{\delta} + \mathbf{A}^{-1}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \boldsymbol{\mu} + \boldsymbol{\beta}(L) \mathbf{U}_t
    (\#eq:VARMAq)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\boldsymbol{\mu}\)</span> es un vector de <span class="math inline">\(k \times 1\)</span> constantes y
<span class="math inline">\(\boldsymbol{\beta}(L)\)</span> es una matriz que depende de <span class="math inline">\(L\)</span>.</p>
<p>Por el lado de las matrices que representan la autocovarianza, estás
resultan de resolver lo siguiente: <span class="math display">\[\begin{equation}
    \Gamma_X(\tau) = E[(\mathbf{X}_t - \mu)(\mathbf{X}_{t-\tau} - \mu)&#39;]
\end{equation}\]</span></p>
<p>Ahora, sin pérdida de generalidad digamos que la especificación VAR(p)
en la ecuación <a href="#eq:VARp">(<strong>??</strong>)</a> no tiene constante, por lo que
<span class="math inline">\(\boldsymbol{\delta} = \mathbf{0}\)</span>, lo que implica que
<span class="math inline">\(\boldsymbol{\mu} = \mathbf{0}\)</span>. De esta forma las matrices de
autocovarianza resultan de: <span class="math display">\[\begin{eqnarray*}
    \Gamma_{\mathbf{X}}(\tau) &amp; = &amp; E[(\mathbf{X}_t)(\mathbf{X}_{t-\tau})&#39;] \\
    &amp; = &amp; \mathbf{A_1} E[(\mathbf{X}_{t-1})(\mathbf{X}_{t-\tau})&#39;] + \mathbf{A_2} E[(\mathbf{X}_{t-2})(\mathbf{X}_{t-\tau})&#39;] \\
    &amp;   &amp; + \ldots + \mathbf{A_p} E[(\mathbf{X}_{t-p})(\mathbf{X}_{t-\tau})&#39;] + E[(\mathbf{U}_t(\mathbf{X}_{t-\tau})&#39;]
\end{eqnarray*}\]</span></p>
<p>Finalmente, al igual que en el caso <span class="math inline">\(AR(p)\)</span>, requerimos de una métrica
que nos permita determinar el número de rezagos óptimo <span class="math inline">\(p\)</span> en el
<span class="math inline">\(VAR(p)\)</span>. Así, establecemos criterios de información similares a los del
<span class="math inline">\(AR(p)\)</span> dados por:</p>
<p>1.Final Prediction Error (FPE): <span class="math display">\[\begin{equation}
        FPE(p) = \left[ \frac{T + kp + 1}{T - kp - 1} \right]^k |\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)|
        \end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Akaike Criterion (AIC): <span class="math display">\[\begin{equation}
     AIC(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{2}{T}
     \end{equation}\]</span></p></li>
<li><p>Hannan - Quinn Criterion (HQ): <span class="math display">\[\begin{equation}
     HQ(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{2ln(ln(2))}{T}
     \end{equation}\]</span></p></li>
<li><p>Schwartz Criterion (SC): <span class="math display">\[\begin{equation}
     SC(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{ln(T)}{T}
     \end{equation}\]</span></p></li>
</ol>
<p>Donde la matriz de varianzas y covarianzas contemporáneas estará dada
por: <span class="math display">\[\begin{equation*}
            \mathbf{\Sigma}_{\hat{U}\hat{U}}(p) = \mathbb{E} \left[
            \begin{bmatrix}
            U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
            \end{bmatrix}
            \begin{bmatrix}
            U^{(t)}_{1} &amp; U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k}
            \end{bmatrix}
            \right]
    \end{equation*}\]</span></p>
<p>. Ahora veámos un ejemplo de estimación de <span class="math inline">\(VAR(p)\)</span>.
Para el ejemplo utilizaremos las series de INPC, Tipo de Cambio,
rendimiento de los Cetes a 28 días, el IGAE y el Índice de Producción
Industrial de los Estados Unidos, todas desestacionalizadas y para el
período de enero de 2000 a julio de 2019. Dado que el supuesto
estacionariedad sigue presente en nuestro análisis, emplearemos cada una
de las series en su versión de diferencias logaritmicas. Las Figuras
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig62">5.2</a> y <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig63">5.3</a> muestra las series referidas.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb4-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-4" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb4-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-5" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb4-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-6" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb4-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-7" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb4-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-8" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb4-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-9" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb4-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-10" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb4-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-13"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-13" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Datos_Ad.RData&quot;</span>)</span>
<span id="cb4-14"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-15" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-16"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-16" tabindex="-1"></a>DLINPC <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>INPC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb4-17"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-18" tabindex="-1"></a>DLTC <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>TC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb4-19"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-20" tabindex="-1"></a>DLCETE28 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb4-21"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-21" tabindex="-1"></a></span>
<span id="cb4-22"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-22" tabindex="-1"></a>DLIGAE <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>IGAE_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb4-23"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-24" tabindex="-1"></a>DLIPI <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>( <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>IPI_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>) ))</span>
<span id="cb4-25"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-26" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(DLINPC, DLTC, DLCETE28, DLIGAE, DLIPI))</span>
<span id="cb4-27"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-27" tabindex="-1"></a></span>
<span id="cb4-28"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-28" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos, </span>
<span id="cb4-29"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb4-29" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(Datos, <span class="at">plot.type =</span> <span class="st">&quot;s&quot;</span>, </span>
<span id="cb5-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-2" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb5-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Series en Diferencias logaritmicas&quot;</span>, </span>
<span id="cb5-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Variacion&quot;</span>)</span>
<span id="cb5-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;INPC&quot;</span>, <span class="st">&quot;TC&quot;</span>, <span class="st">&quot;CETES28&quot;</span>, <span class="st">&quot;IGAE&quot;</span>, <span class="st">&quot;IPI&quot;</span>),</span>
<span id="cb5-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-7" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb5-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb5-8" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig62"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig62-1.png" alt="Series en diferencias logarítmicas (Forma 1)" width="672" />
<p class="caption">
Figure 5.2: Series en diferencias logarítmicas (Forma 1)
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(Datos, <span class="at">plot.type =</span> <span class="st">&quot;m&quot;</span>, </span>
<span id="cb6-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb6-2" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb6-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb6-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Series en Diferencias logaritmicas&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig63"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig63-1.png" alt="Series en diferencias logarítmicas (Forma 2)" width="672" />
<p class="caption">
Figure 5.3: Series en diferencias logarítmicas (Forma 2)
</p>
</div>
<p>Dicho lo anterior, a continuación mostraremos la tabla que resume el
valor de los distintos criterios de información para una especificación
de un <span class="math inline">\(VAR(p)\)</span> con constante. Notése que es posible especificar un
<span class="math inline">\(VAR(p)\)</span> con tendencia, siempre que exista evidencia de que algunas de
las series sean estacionarias alrededor de una tendencia. Caso que no
aplica hasta este momento, ya que nuestro análisis de estacionariedad es
claro respecto a la media constante (más adelante aportaremos la
evidencia de esto), lo cual elimina la posibilidad de incluir una
tendencia.</p>
<p>En el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:NumSelectVAR">5.2</a> reportamos el número de rezagos
propuesto a partir de cada criterio de información y en el Cuadro
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:SelectVAR">5.3</a> reportamos los resultados de aplicar una prueba de
criterios de información para diferentes valores de rezagos. Del cual se
concluye que el número óptimo de rezagos es 2 (según el criterio AIC y
el FPE) y 1 (según el criterio HQ y el SC). Recordemos que es común que
el criterio AIC siempre reporte el mayor valor de rezagos, por lo que es
una buena práctica utilizarlo como referente principal.</p>
<table>
<caption><span id="tab:NumSelectVAR">Table 5.2: </span> Número de rezagos determinados por cada uno de los
criterios de información para diferentes especificaciones de modelos
VAR(p) con término constante de la series <span class="math inline">\(DLINPC_t\)</span>, <span class="math inline">\(DLTC_t\)</span>,
<span class="math inline">\(DLCETE28_t\)</span>, <span class="math inline">\(DLIGAE_t\)</span> y <span class="math inline">\(DLIPI_t\)</span>.</caption>
<thead>
<tr class="header">
<th align="center"><strong>AIC</strong></th>
<th align="center"><strong>HQ</strong></th>
<th align="center"><strong>SC</strong></th>
<th align="center"><strong>FPE</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:SelectVAR">Table 5.3: </span> Criterios de información para diferentes
especificaciones de modelos VAR(p) con término constante de la series
<span class="math inline">\(DLINPC_t\)</span>, <span class="math inline">\(DLTC_t\)</span>, <span class="math inline">\(DLCETE28_t\)</span>, <span class="math inline">\(DLIGAE_t\)</span> y <span class="math inline">\(DLIPI_t\)</span>.</caption>
<colgroup>
<col width="14%" />
<col width="21%" />
<col width="21%" />
<col width="21%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">AIC</th>
<th align="center">HQ</th>
<th align="center">SC</th>
<th align="center">FPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-4.636412e+01</td>
<td align="center">-4.617847e+01</td>
<td align="center">-4.590430e+01</td>
<td align="center">7.317262e-21</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-4.639541e+01</td>
<td align="center">-4.605506e+01</td>
<td align="center">-4.555241e+01</td>
<td align="center">7.094216e-21</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">-4.635305e+01</td>
<td align="center">-4.585799e+01</td>
<td align="center">-4.512686e+01</td>
<td align="center">7.407479e-21</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb7-1" tabindex="-1"></a><span class="fu">VARselect</span>(Datos, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      2      1      1      2 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -4.343694e+01 -4.348783e+01 -4.342685e+01 -4.338688e+01 -4.329316e+01
## HQ(n)  -4.327594e+01 -4.319266e+01 -4.299751e+01 -4.282338e+01 -4.259549e+01
## SC(n)  -4.303604e+01 -4.275285e+01 -4.235779e+01 -4.198374e+01 -4.155594e+01
## FPE(n)  1.366449e-19  1.298899e-19  1.381225e-19  1.438821e-19  1.582460e-19
##                    6             7             8             9            10
## AIC(n) -4.324317e+01 -4.329021e+01 -4.324194e+01 -4.322014e+01 -4.317881e+01
## HQ(n)  -4.241133e+01 -4.232420e+01 -4.214176e+01 -4.198580e+01 -4.181030e+01
## SC(n)  -4.117187e+01 -4.088482e+01 -4.050247e+01 -4.014660e+01 -3.977118e+01
## FPE(n)  1.667106e-19  1.595179e-19  1.680601e-19  1.726236e-19  1.810365e-19
##                   11            12
## AIC(n) -4.311914e+01 -4.305022e+01
## HQ(n)  -4.161646e+01 -4.141338e+01
## SC(n)  -3.937743e+01 -3.897444e+01
## FPE(n)  1.936459e-19  2.093856e-19</code></pre>
<p>De esta forma, justificamos la estimación de un <span class="math inline">\(VAR(2)\)</span>. Los resultados
del mismo se reportan en los siguientes cuadros, en los que se muestra
el resultado de una de las ecuaciones. Los resultados restantes se
encuentran en el código de R mostrado más abajo. Primero mostraremos los
resultados de las raíces del polinomio característico en el Cuadro
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:RootsVAR">5.4</a>, seguido de un cuadro para la ecuación del IGAE en
el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:IGAEVAR">5.5</a> (por simplicidad se omiten las otras cuatro
ecuaciones del VAR(2)), y del Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:SigmaVARp">5.6</a> con la matriz
<span class="math inline">\(\mathbf{\Sigma}_{\hat{U}\hat{U}}\)</span> estimada del VAR.</p>
<table>
<caption><span id="tab:RootsVAR">Table 5.4: </span> Raíces del polinomio característico de un VAR(2).</caption>
<tbody>
<tr class="odd">
<td align="center">0.7452</td>
<td align="center">0.4403</td>
<td align="center">0.4403</td>
<td align="center">0.3503</td>
<td align="center">0.3503</td>
</tr>
<tr class="even">
<td align="center">0.3342</td>
<td align="center">0.3342</td>
<td align="center">0.3339</td>
<td align="center">0.3339</td>
<td align="center">0.06951</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:IGAEVAR">Table 5.5: </span> Criterios de información para diferentes
especificaciones de modelos VAR(p) con término constante de la series
<span class="math inline">\(DLINPC_t\)</span>, <span class="math inline">\(DLTC_t\)</span>, <span class="math inline">\(DLCETE28_t\)</span>, <span class="math inline">\(DLIGAE_t\)</span> y <span class="math inline">\(DLIPI_t\)</span>.</caption>
<colgroup>
<col width="25%" />
<col width="18%" />
<col width="17%" />
<col width="14%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Coeficiente</th>
<th align="center">Error Est.</th>
<th align="center">Estad. t</th>
<th align="center">Prob.(<span class="math inline">\(&gt;\)</span> t)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLINPC_{t-1}\)</span></td>
<td align="center">-0.2584978</td>
<td align="center">0.1658396</td>
<td align="center">-1.559</td>
<td align="center">0.120493</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLTC_{t-1}\)</span></td>
<td align="center">0.0022016</td>
<td align="center">0.0152876</td>
<td align="center">0.144</td>
<td align="center">0.885620</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLCETE28_{t-1}\)</span></td>
<td align="center">0.0009547</td>
<td align="center">0.0049115</td>
<td align="center">0.194</td>
<td align="center">0.846054</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIGAE_{t-1}\)</span></td>
<td align="center">-0.2351453</td>
<td align="center">0.0699797</td>
<td align="center">-3.360</td>
<td align="center">0.000917 ***</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIPI_{t-1}\)</span></td>
<td align="center">0.2442406</td>
<td align="center">0.0600502</td>
<td align="center">4.067</td>
<td align="center">6.62e-05 ***</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLINPC_{t-2}\)</span></td>
<td align="center">-0.0775039</td>
<td align="center">0.1694809</td>
<td align="center">-0.457</td>
<td align="center">0.647904</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLTC_{t-2}\)</span></td>
<td align="center">-0.0413316</td>
<td align="center">0.0144650</td>
<td align="center">-2.857</td>
<td align="center">0.004680 **</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLCETE28_{t-2}\)</span></td>
<td align="center">0.0005341</td>
<td align="center">0.0048058</td>
<td align="center">0.111</td>
<td align="center">0.911612</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIGAE_{t-2}\)</span></td>
<td align="center">-0.0646890</td>
<td align="center">0.0693711</td>
<td align="center">-0.933</td>
<td align="center">0.352092</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIPI_{t-2}\)</span></td>
<td align="center">0.1796286</td>
<td align="center">0.0620861</td>
<td align="center">2.893</td>
<td align="center">0.004195 **</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\delta_4\)</span></td>
<td align="center">0.0030377</td>
<td align="center">0.0008077</td>
<td align="center">3.761</td>
<td align="center">0.000217 ***</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center">Notas:</td>
<td align="center">***</td>
<td align="center">signif.</td>
<td align="center">al 0.1%</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center">**</td>
<td align="center">signif.</td>
<td align="center">al 1%</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center">*</td>
<td align="center">signif.</td>
<td align="center">al 5%</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:SigmaVARp">Table 5.6: </span> Matriz <span class="math inline">\(\mathbf{\Sigma}_{\hat{U}\hat{U}}\)</span> estimada
del VAR(2).</caption>
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="14%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(DLINPC_t\)</span></td>
<td align="center"><span class="math inline">\(DLTC_t\)</span></td>
<td align="center"><span class="math inline">\(DLCE28_t\)</span></td>
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLINPC_t\)</span></td>
<td align="center">3.95e-06</td>
<td align="center">3.19e-06</td>
<td align="center">-1.83e-06</td>
<td align="center">-5.29-07</td>
<td align="center">1.34e-06</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLTC_t\)</span></td>
<td align="center">3.19e-06</td>
<td align="center">5.04e-04</td>
<td align="center">4.27e-04</td>
<td align="center">9.81e-06</td>
<td align="center">1.61e-05</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLCE28_t\)</span></td>
<td align="center">-1.83e-06</td>
<td align="center">4.27e-04</td>
<td align="center">4.63e-03</td>
<td align="center">1.26e-05</td>
<td align="center">2.76e-05</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
<td align="center">-5.29e-07</td>
<td align="center">9.81e-06</td>
<td align="center">1.26e-05</td>
<td align="center">2.43e-05</td>
<td align="center">8.75e-06</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
<td align="center">1.34e-06</td>
<td align="center">1.61e-05</td>
<td align="center">2.76e-05</td>
<td align="center">8.75e-06</td>
<td align="center">3.13e-05</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb9-1" tabindex="-1"></a>VAR_p <span class="ot">&lt;-</span> <span class="fu">VAR</span>(Datos, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb9-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb9-3" tabindex="-1"></a><span class="fu">summary</span>(VAR_p)</span></code></pre></div>
<pre><code>## 
## VAR Estimation Results:
## ========================= 
## Endogenous variables: DLINPC, DLTC, DLCETE28, DLIGAE, DLIPI 
## Deterministic variables: const 
## Sample size: 279 
## Log Likelihood: 4142.895 
## Roots of the characteristic polynomial:
##  0.53  0.53 0.4501 0.4501 0.4425 0.4425 0.3251 0.3251 0.1677 0.1677
## Call:
## VAR(y = Datos, p = 2, type = &quot;const&quot;)
## 
## 
## Estimation results for equation DLINPC: 
## ======================================= 
## DLINPC = DLINPC.l1 + DLTC.l1 + DLCETE28.l1 + DLIGAE.l1 + DLIPI.l1 + DLINPC.l2 + DLTC.l2 + DLCETE28.l2 + DLIGAE.l2 + DLIPI.l2 + const 
## 
##              Estimate Std. Error t value Pr(&gt;|t|)    
## DLINPC.l1    0.387061   0.063100   6.134 3.06e-09 ***
## DLTC.l1     -0.004611   0.005286  -0.872   0.3839    
## DLCETE28.l1  0.001229   0.002078   0.592   0.5546    
## DLIGAE.l1   -0.022088   0.015077  -1.465   0.1441    
## DLIPI.l1     0.009878   0.019363   0.510   0.6104    
## DLINPC.l2   -0.006707   0.063621  -0.105   0.9161    
## DLTC.l2      0.009608   0.005496   1.748   0.0816 .  
## DLCETE28.l2  0.001827   0.002051   0.891   0.3737    
## DLIGAE.l2    0.006544   0.014289   0.458   0.6473    
## DLIPI.l2    -0.015245   0.019632  -0.777   0.4381    
## const        0.002325   0.000294   7.908 6.88e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.002176 on 268 degrees of freedom
## Multiple R-Squared: 0.1783,  Adjusted R-squared: 0.1476 
## F-statistic: 5.815 on 10 and 268 DF,  p-value: 6.289e-08 
## 
## 
## Estimation results for equation DLTC: 
## ===================================== 
## DLTC = DLINPC.l1 + DLTC.l1 + DLCETE28.l1 + DLIGAE.l1 + DLIPI.l1 + DLINPC.l2 + DLTC.l2 + DLCETE28.l2 + DLIGAE.l2 + DLIPI.l2 + const 
## 
##              Estimate Std. Error t value Pr(&gt;|t|)    
## DLINPC.l1   -1.344803   0.745382  -1.804  0.07233 .  
## DLTC.l1      0.315786   0.062442   5.057  7.9e-07 ***
## DLCETE28.l1 -0.039912   0.024542  -1.626  0.10506    
## DLIGAE.l1    0.379306   0.178102   2.130  0.03411 *  
## DLIPI.l1    -0.514827   0.228727  -2.251  0.02521 *  
## DLINPC.l2    0.071779   0.751538   0.096  0.92398    
## DLTC.l2     -0.183813   0.064926  -2.831  0.00499 ** 
## DLCETE28.l2  0.030125   0.024228   1.243  0.21481    
## DLIGAE.l2    0.070713   0.168797   0.419  0.67561    
## DLIPI.l2    -0.166610   0.231909  -0.718  0.47312    
## const        0.006463   0.003473   1.861  0.06388 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.0257 on 268 degrees of freedom
## Multiple R-Squared: 0.1425,  Adjusted R-squared: 0.1105 
## F-statistic: 4.454 on 10 and 268 DF,  p-value: 8.102e-06 
## 
## 
## Estimation results for equation DLCETE28: 
## ========================================= 
## DLCETE28 = DLINPC.l1 + DLTC.l1 + DLCETE28.l1 + DLIGAE.l1 + DLIPI.l1 + DLINPC.l2 + DLTC.l2 + DLCETE28.l2 + DLIGAE.l2 + DLIPI.l2 + const 
## 
##              Estimate Std. Error t value Pr(&gt;|t|)  
## DLINPC.l1    3.933798   1.861561   2.113   0.0355 *
## DLTC.l1      0.112997   0.155945   0.725   0.4693  
## DLCETE28.l1  0.113300   0.061292   1.849   0.0656 .
## DLIGAE.l1   -0.588758   0.444803  -1.324   0.1868  
## DLIPI.l1     1.174496   0.571237   2.056   0.0407 *
## DLINPC.l2   -2.213087   1.876936  -1.179   0.2394  
## DLTC.l2      0.117661   0.162151   0.726   0.4687  
## DLCETE28.l2  0.063398   0.060509   1.048   0.2957  
## DLIGAE.l2   -0.237974   0.421565  -0.565   0.5729  
## DLIPI.l2     1.110203   0.579183   1.917   0.0563 .
## const       -0.007514   0.008674  -0.866   0.3872  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.06419 on 268 degrees of freedom
## Multiple R-Squared: 0.08823, Adjusted R-squared: 0.05421 
## F-statistic: 2.593 on 10 and 268 DF,  p-value: 0.005122 
## 
## 
## Estimation results for equation DLIGAE: 
## ======================================= 
## DLIGAE = DLINPC.l1 + DLTC.l1 + DLCETE28.l1 + DLIGAE.l1 + DLIPI.l1 + DLINPC.l2 + DLTC.l2 + DLCETE28.l2 + DLIGAE.l2 + DLIPI.l2 + const 
## 
##              Estimate Std. Error t value Pr(&gt;|t|)    
## DLINPC.l1    0.719855   0.393617   1.829   0.0685 .  
## DLTC.l1     -0.218508   0.032974  -6.627 1.88e-10 ***
## DLCETE28.l1  0.007718   0.012960   0.596   0.5520    
## DLIGAE.l1    0.037559   0.094051   0.399   0.6900    
## DLIPI.l1     0.389894   0.120785   3.228   0.0014 ** 
## DLINPC.l2   -0.737653   0.396868  -1.859   0.0642 .  
## DLTC.l2      0.073830   0.034286   2.153   0.0322 *  
## DLCETE28.l2 -0.013542   0.012794  -1.058   0.2908    
## DLIGAE.l2   -0.142845   0.089138  -1.603   0.1102    
## DLIPI.l2    -0.154835   0.122465  -1.264   0.2072    
## const        0.001637   0.001834   0.893   0.3729    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.01357 on 268 degrees of freedom
## Multiple R-Squared: 0.3272,  Adjusted R-squared: 0.3021 
## F-statistic: 13.03 on 10 and 268 DF,  p-value: &lt; 2.2e-16 
## 
## 
## Estimation results for equation DLIPI: 
## ====================================== 
## DLIPI = DLINPC.l1 + DLTC.l1 + DLCETE28.l1 + DLIGAE.l1 + DLIPI.l1 + DLINPC.l2 + DLTC.l2 + DLCETE28.l2 + DLIGAE.l2 + DLIPI.l2 + const 
## 
##              Estimate Std. Error t value Pr(&gt;|t|)    
## DLINPC.l1    0.042383   0.326611   0.130   0.8968    
## DLTC.l1     -0.163742   0.027361  -5.985 6.93e-09 ***
## DLCETE28.l1  0.012143   0.010754   1.129   0.2598    
## DLIGAE.l1    0.098821   0.078041   1.266   0.2065    
## DLIPI.l1     0.067742   0.100224   0.676   0.4997    
## DLINPC.l2   -0.524835   0.329309  -1.594   0.1122    
## DLTC.l2      0.053353   0.028449   1.875   0.0618 .  
## DLCETE28.l2 -0.016237   0.010616  -1.529   0.1273    
## DLIGAE.l2   -0.088483   0.073964  -1.196   0.2326    
## DLIPI.l2    -0.082982   0.101618  -0.817   0.4149    
## const        0.002361   0.001522   1.551   0.1220    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Residual standard error: 0.01126 on 268 degrees of freedom
## Multiple R-Squared: 0.1978,  Adjusted R-squared: 0.1679 
## F-statistic:  6.61 on 10 and 268 DF,  p-value: 3.715e-09 
## 
## 
## 
## Covariance matrix of residuals:
##              DLINPC       DLTC  DLCETE28     DLIGAE      DLIPI
## DLINPC    4.735e-06 -1.939e-07 4.559e-06  6.652e-06  7.000e-06
## DLTC     -1.939e-07  6.607e-04 3.698e-04 -3.544e-05 -3.174e-05
## DLCETE28  4.559e-06  3.698e-04 4.121e-03  6.362e-05  8.525e-05
## DLIGAE    6.652e-06 -3.544e-05 6.362e-05  1.842e-04  1.164e-04
## DLIPI     7.000e-06 -3.174e-05 8.525e-05  1.164e-04  1.268e-04
## 
## Correlation matrix of residuals:
##             DLINPC      DLTC DLCETE28   DLIGAE   DLIPI
## DLINPC    1.000000 -0.003466  0.03264  0.22524  0.2856
## DLTC     -0.003466  1.000000  0.22409 -0.10159 -0.1097
## DLCETE28  0.032640  0.224095  1.00000  0.07301  0.1179
## DLIGAE    0.225240 -0.101585  0.07301  1.00000  0.7615
## DLIPI     0.285629 -0.109656  0.11792  0.76147  1.0000</code></pre>
<p>Finalmente, en el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:DiagnosVAR">5.7</a> reportamos las pruebas de
diagnóstico del VAR(2). Incluimos las pruebas de correlación serial (o
autocorrelación), normalidad y de heterocedasticidad. De acuerdo con esa
información, la correlación serial muestra que existe relación de la
matriz de covarianzas no contemporánea considerando pocos rezagos, pero
se elimina conforme los rezagos se incrementan. En cuanto a normalidad,
se observa que los residuales no lo son, por lo que se requeriría
mejorar la especificación del VAR. Finalmente, se observa que los
residuales no son homocedásticos.</p>
<table>
<caption><span id="tab:DiagnosVAR">Table 5.7: </span> Pruebas de diagnóstico sobre los residuales del
VAR(2).</caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estadística (rezagos)</th>
<th align="center">Coeficiente</th>
<th align="center">p-value</th>
<th align="center">Conclusión</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (2)\)</span>)</td>
<td align="center">59.436</td>
<td align="center">0.1696</td>
<td align="center">Existe autocorrelación serial</td>
</tr>
<tr class="even">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (4)\)</span>)</td>
<td align="center">127.17</td>
<td align="center">0.03461</td>
<td align="center">No existe autocorrelación serial</td>
</tr>
<tr class="odd">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (6)\)</span>)</td>
<td align="center">183.14</td>
<td align="center">0.03393</td>
<td align="center">No existe autocorrelación serial</td>
</tr>
<tr class="even">
<td align="center">Normalidad - JB (<span class="math inline">\(\chi^2\)</span>)</td>
<td align="center">2335</td>
<td align="center">0.0000</td>
<td align="center">Los residuales no son normales</td>
</tr>
<tr class="odd">
<td align="center">ARCH (<span class="math inline">\(\chi^2 (2)\)</span>)</td>
<td align="center">691.58</td>
<td align="center">0.0000</td>
<td align="center">Los residuales no son homocedásticos</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb11-1" tabindex="-1"></a><span class="do">### Diagnostic tests</span></span>
<span id="cb11-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb11-3" tabindex="-1"></a><span class="do">#### Normalidad:</span></span>
<span id="cb11-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb11-5" tabindex="-1"></a><span class="fu">normality.test</span>(VAR_p)</span></code></pre></div>
<pre><code>## $JB
## 
##  JB-Test (multivariate)
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 36186, df = 10, p-value &lt; 2.2e-16
## 
## 
## $Skewness
## 
##  Skewness only (multivariate)
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 1261, df = 5, p-value &lt; 2.2e-16
## 
## 
## $Kurtosis
## 
##  Kurtosis only (multivariate)
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 34925, df = 5, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb13-1" tabindex="-1"></a><span class="do">#### Autocorrelacion Serial:</span></span>
<span id="cb13-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb13-3" tabindex="-1"></a><span class="do">#### LAGS = 2:</span></span>
<span id="cb13-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb13-5" tabindex="-1"></a><span class="fu">serial.test</span>(VAR_p, <span class="at">lags.bg =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;BG&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Breusch-Godfrey LM test
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 74.839, df = 50, p-value = 0.013</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb15-1" tabindex="-1"></a><span class="do">#### LAGS = 4:</span></span>
<span id="cb15-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb15-3" tabindex="-1"></a><span class="fu">serial.test</span>(VAR_p, <span class="at">lags.bg =</span> <span class="dv">4</span>, <span class="at">type =</span> <span class="st">&quot;BG&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Breusch-Godfrey LM test
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 131.69, df = 100, p-value = 0.01849</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb17-1" tabindex="-1"></a><span class="do">#### LAGS = 6:</span></span>
<span id="cb17-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb17-3" tabindex="-1"></a><span class="fu">serial.test</span>(VAR_p, <span class="at">lags.bg =</span> <span class="dv">6</span>, <span class="at">type =</span> <span class="st">&quot;BG&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Breusch-Godfrey LM test
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 201.63, df = 150, p-value = 0.003147</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb19-1" tabindex="-1"></a><span class="do">#### Homocedasticidad:</span></span>
<span id="cb19-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb19-3" tabindex="-1"></a><span class="fu">arch.test</span>(VAR_p, <span class="at">lags.multi =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## 
##  ARCH (multivariate)
## 
## data:  Residuals of VAR object VAR_p
## Chi-squared = 2122.4, df = 1350, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="análisis-de-impulso-respuesta" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Análisis de Impulso-Respuesta<a href="#an%C3%A1lisis-de-impulso-respuesta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una de las grandes ventajas que aporta el análisis de los modelos VAR es
el análisis de Impulso-Respuesta. Dicho análisis busca cuantificar el
efecto que tiene en <span class="math inline">\(\mathbf{X}_t\)</span> una innovación o cambio en los
residuales de cualquiera de las variables en un momento definido.
Partamos de la ecuación <a href="#eq:VARMAq">(<strong>??</strong>)</a> de forma que tenemos:
<span class="math display">\[\begin{eqnarray}
    \mathbf{X}_t &amp; = &amp; \mathbf{A}^{-1}(L) \delta + \mathbf{A}^{-1}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \mu + \mathbf{B}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \mu + \Psi_0 \mathbf{U}_t + \Psi_1 \mathbf{U}_{t-1} + \Psi_2 \mathbf{U}_{t-2} + \Psi_3 \mathbf{U}_{t-3} + \ldots
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\Psi_0 = I\)</span> y cada una de las <span class="math inline">\(\Psi_i = - \mathbf{B}_i\)</span>,
<span class="math inline">\(i = 1, 2, \ldots\)</span>. De esta forma se verifica el efecto que tiene en
<span class="math inline">\(\mathbf{X}_t\)</span> cada una de las innovaciones pasadas. Por lo que el
análisis de Impulso-Respuesta cuantifica el efecto de cada una de esas
matrices en las que hemos descompuesto a <span class="math inline">\(\mathbf{B}(L)\)</span>.</p>
<p>. Retomando el modelo <span class="math inline">\(VAR(2)\)</span> anteriormente estimado,
en las siguientes figuras reportamos las gráficas de Impulso-Respuesta
de la serie <span class="math inline">\(DLTC_t\)</span> ante cambios en los residuales del resto de las
series y de la propia serie.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb21-1" tabindex="-1"></a>IR_DLINPC <span class="ot">&lt;-</span> <span class="fu">irf</span>(VAR_p, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb21-2" tabindex="-1"></a>                 <span class="at">ci =</span> <span class="fl">0.95</span>, <span class="at">response =</span> <span class="st">&quot;DLINPC&quot;</span>)</span>
<span id="cb21-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb21-4" tabindex="-1"></a>IR_DLINPC</span></code></pre></div>
<pre><code>## 
## Impulse response coefficients
## $DLINPC
##              DLINPC
##  [1,]  2.175900e-03
##  [2,]  8.094393e-04
##  [3,]  2.429936e-04
##  [4,]  1.049000e-04
##  [5,]  4.305193e-05
##  [6,]  2.571953e-05
##  [7,]  1.084055e-05
##  [8,]  1.147158e-06
##  [9,] -1.425663e-06
## [10,] -9.999499e-07
## [11,] -3.443770e-07
## [12,] -1.512886e-07
## [13,] -1.157354e-07
## 
## $DLTC
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -8.268371e-05
##  [3,]  3.117547e-04
##  [4,]  2.648975e-04
##  [5,]  5.871629e-05
##  [6,] -2.894914e-05
##  [7,] -1.054637e-05
##  [8,]  1.057859e-05
##  [9,]  7.621634e-06
## [10,] -4.038885e-07
## [11,] -2.113820e-06
## [12,] -4.691794e-07
## [13,]  3.771599e-07
## 
## $DLCETE28
##              DLINPC
##  [1,]  0.000000e+00
##  [2,]  6.486929e-05
##  [3,]  1.318264e-04
##  [4,]  3.487944e-05
##  [5,]  4.740702e-05
##  [6,]  3.336371e-05
##  [7,]  1.571610e-05
##  [8,]  3.770470e-06
##  [9,]  5.672766e-08
## [10,]  2.556950e-07
## [11,]  3.379406e-07
## [12,]  4.626880e-08
## [13,] -1.137662e-07
## 
## $DLIGAE
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -2.115678e-04
##  [3,] -1.790075e-04
##  [4,] -1.453804e-05
##  [5,]  4.387550e-05
##  [6,]  1.348413e-05
##  [7,] -6.605412e-06
##  [8,] -3.449275e-06
##  [9,]  2.238652e-06
## [10,]  2.066817e-06
## [11,]  8.258756e-08
## [12,] -4.659518e-07
## [13,] -9.698431e-08
## 
## $DLIPI
##              DLINPC
##  [1,]  0.000000e+00
##  [2,]  7.038188e-05
##  [3,] -1.107780e-04
##  [4,] -3.218008e-05
##  [5,] -1.697303e-05
##  [6,]  4.856595e-07
##  [7,]  1.045292e-05
##  [8,]  4.695418e-06
##  [9,]  3.599640e-07
## [10,] -5.104865e-07
## [11,]  5.294854e-08
## [12,]  2.664766e-07
## [13,]  9.015073e-08
## 
## 
## Lower Band, CI= 0.95 
## $DLINPC
##              DLINPC
##  [1,]  1.874780e-03
##  [2,]  5.119869e-04
##  [3,] -1.273623e-05
##  [4,] -1.023066e-04
##  [5,] -5.719623e-05
##  [6,] -4.354704e-05
##  [7,] -3.096252e-05
##  [8,] -1.891988e-05
##  [9,] -1.589936e-05
## [10,] -6.264654e-06
## [11,] -3.459539e-06
## [12,] -1.823935e-06
## [13,] -1.493424e-06
## 
## $DLTC
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -3.184991e-04
##  [3,]  2.799802e-05
##  [4,]  7.069258e-05
##  [5,] -5.127246e-05
##  [6,] -1.038798e-04
##  [7,] -5.581125e-05
##  [8,] -2.137390e-05
##  [9,] -8.368126e-06
## [10,] -1.403397e-05
## [11,] -9.131643e-06
## [12,] -4.509747e-06
## [13,] -2.161342e-06
## 
## $DLCETE28
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -1.229861e-04
##  [3,] -1.387017e-04
##  [4,] -9.217945e-05
##  [5,] -4.442457e-05
##  [6,] -1.983635e-05
##  [7,] -8.147625e-06
##  [8,] -1.023115e-05
##  [9,] -7.261060e-06
## [10,] -3.728893e-06
## [11,] -2.438368e-06
## [12,] -1.644585e-06
## [13,] -8.396596e-07
## 
## $DLIGAE
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -4.693895e-04
##  [3,] -3.666332e-04
##  [4,] -1.447178e-04
##  [5,] -4.175837e-05
##  [6,] -3.979387e-05
##  [7,] -3.578136e-05
##  [8,] -2.070173e-05
##  [9,] -9.398213e-06
## [10,] -4.823592e-06
## [11,] -3.946726e-06
## [12,] -2.925589e-06
## [13,] -1.865072e-06
## 
## $DLIPI
##              DLINPC
##  [1,]  0.000000e+00
##  [2,] -2.340112e-04
##  [3,] -3.927533e-04
##  [4,] -1.230237e-04
##  [5,] -1.102429e-04
##  [6,] -4.926746e-05
##  [7,] -1.502417e-05
##  [8,] -8.852270e-06
##  [9,] -7.141133e-06
## [10,] -5.644227e-06
## [11,] -3.120757e-06
## [12,] -9.400745e-07
## [13,] -7.550840e-07
## 
## 
## Upper Band, CI= 0.95 
## $DLINPC
##             DLINPC
##  [1,] 2.459772e-03
##  [2,] 1.057487e-03
##  [3,] 5.149739e-04
##  [4,] 2.786782e-04
##  [5,] 1.590765e-04
##  [6,] 9.365681e-05
##  [7,] 5.381097e-05
##  [8,] 3.219598e-05
##  [9,] 1.515279e-05
## [10,] 8.554628e-06
## [11,] 5.534185e-06
## [12,] 4.075245e-06
## [13,] 2.172634e-06
## 
## $DLTC
##             DLINPC
##  [1,] 0.000000e+00
##  [2,] 1.797631e-04
##  [3,] 5.726598e-04
##  [4,] 4.422391e-04
##  [5,] 1.962527e-04
##  [6,] 3.133331e-05
##  [7,] 3.126633e-05
##  [8,] 4.063941e-05
##  [9,] 2.807636e-05
## [10,] 1.377595e-05
## [11,] 3.563254e-06
## [12,] 3.417829e-06
## [13,] 3.744869e-06
## 
## $DLCETE28
##             DLINPC
##  [1,] 0.000000e+00
##  [2,] 3.033755e-04
##  [3,] 3.792127e-04
##  [4,] 1.889732e-04
##  [5,] 1.344161e-04
##  [6,] 9.835488e-05
##  [7,] 5.147923e-05
##  [8,] 2.400518e-05
##  [9,] 1.207506e-05
## [10,] 6.965539e-06
## [11,] 4.978967e-06
## [12,] 2.446267e-06
## [13,] 1.059083e-06
## 
## $DLIGAE
##              DLINPC
##  [1,]  0.000000e+00
##  [2,]  4.122710e-05
##  [3,] -3.349347e-06
##  [4,]  1.031917e-04
##  [5,]  1.296845e-04
##  [6,]  6.418440e-05
##  [7,]  1.814542e-05
##  [8,]  1.170092e-05
##  [9,]  1.361480e-05
## [10,]  7.585497e-06
## [11,]  5.233120e-06
## [12,]  1.886332e-06
## [13,]  1.268634e-06
## 
## $DLIPI
##             DLINPC
##  [1,] 0.000000e+00
##  [2,] 2.947969e-04
##  [3,] 1.356468e-04
##  [4,] 6.737649e-05
##  [5,] 7.449756e-05
##  [6,] 4.343753e-05
##  [7,] 3.479661e-05
##  [8,] 2.353626e-05
##  [9,] 7.698724e-06
## [10,] 3.237135e-06
## [11,] 2.356008e-06
## [12,] 1.778033e-06
## [13,] 1.128942e-06</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb23-1" tabindex="-1"></a><span class="co">#plot(IR_DLINPC)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb24-1" tabindex="-1"></a>IR_DLTC <span class="ot">&lt;-</span> <span class="fu">irf</span>(VAR_p, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb24-2" tabindex="-1"></a>               <span class="at">ci =</span> <span class="fl">0.95</span>, <span class="at">response =</span> <span class="st">&quot;DLTC&quot;</span>)</span>
<span id="cb24-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb24-4" tabindex="-1"></a><span class="fu">plot</span>(IR_DLTC)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig64-1"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig64-1.png" alt="Impulso - Respuesta en $DLTC_t$" width="672" />
<p class="caption">
Figure 5.4: Impulso - Respuesta en <span class="math inline">\(DLTC_t\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig64-2"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig64-2.png" alt="Impulso - Respuesta en $DLTC_t$" width="672" />
<p class="caption">
Figure 5.5: Impulso - Respuesta en <span class="math inline">\(DLTC_t\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig64-3"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig64-3.png" alt="Impulso - Respuesta en $DLTC_t$" width="672" />
<p class="caption">
Figure 5.6: Impulso - Respuesta en <span class="math inline">\(DLTC_t\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig64-4"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig64-4.png" alt="Impulso - Respuesta en $DLTC_t$" width="672" />
<p class="caption">
Figure 5.7: Impulso - Respuesta en <span class="math inline">\(DLTC_t\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig64-5"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig64-5.png" alt="Impulso - Respuesta en $DLTC_t$" width="672" />
<p class="caption">
Figure 5.8: Impulso - Respuesta en <span class="math inline">\(DLTC_t\)</span>
</p>
</div>
<p>Los resultados muestran que la respuesta de <span class="math inline">\(DLTC_t\)</span> ante impulsos en
los términos de error fue estadísticamente significativo sólo para
alguunos de los casos y en periodos cortos de tiempo. El resto de los
resultados de Impulso-Respuesta se encuentra en el Scrip llamado Clase
15 que se ubica en el repositorio de GitHub.</p>
</div>
<div id="identificación-de-los-choques-estructurales-en-los-modelos-var" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Identificación de los Choques Estructurales en los Modelos VAR<a href="#identificaci%C3%B3n-de-los-choques-estructurales-en-los-modelos-var" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En su trabajo seminal <em>“Macroeconomics and Reality”</em>, Sims (1980)
cuestionó los modelos macroeconométricos utilizados en ese momento.
Antes de la aparición de los modelos de referencia modernos, como los
Vectores Autorregresivos (VAR) y los modelos estocásticos dinámicos de
equilibrio general (DSGE), se estimaban modelos de ecuaciones
simultáneas derivados de la escuela keynesiana, especificados con <span class="math inline">\(n\)</span> cantidad de ecuaciones. Por lo tanto, para entender el surgimiento de los modelos
VAR en la macroeconometría, es necesario partir del contexto en el que
se escribió el trabajo seminal de Sims.</p>
<p>A finales de los años 70 e inicios de los 80, comenzó una crisis en
torno a los modelos estructurales tradicionales. Los modelos
macroeconómicos de gran escala –como los de la Cowles Commission–
utilizaban restricciones teóricas para identificar relaciones
estructurales que, en muchos casos, eran impuestas de manera arbitraria.
Estos modelos estaban altamente parametrizados y basados en supuestos
teóricos fuertes –como las expectativas adaptativas–, lo que los hacía
sensibles a errores específicos. De esta situación surge en parte la
<em>Crítica de Lucas</em>, en la cual Robert Lucas (1976) mostró que este tipo
de modelos fallaba al capturar cambios en el comportamiento cuando las
políticas cambiaban, debido a que no trataban adecuadamente las
expectativas racionales.</p>
<p>Ante este panorama, Sims propuso los modelos VAR, lo que eventualmente
le valió el Premio Nobel de Economía. El objetivo de estos modelos era
ofrecer una alternativa más flexible y empíricamente realista, sin
imponer supuestos estructurales fuertes a priori. De esta manera, los
VAR permiten modelar un conjunto de variables macroeconómicas como
funciones de sus propios rezagos, sin imponer una estructura teórica
rígida. Además, todos los choques y relaciones se tratan inicialmente de
forma simétrica y empírica. Así, los modelos VAR en su forma reducida
son modelos completamente ateóricos.</p>
<p>Sin embargo, aunque los modelos VAR permiten capturar la dinámica
conjunta entre variables sin imponer restricciones teóricas fuertes a
priori, tienen una limitación que no es menor: los choques estimados a
partir de la forma reducida -forma que hemos trabajado hasta
ahora- están correlacionados entre sí. Es decir, los errores <span class="math inline">\(u_t\)</span>
de la forma reducida reflejan combinaciones lineales de múltiples
choques estructurales y esto nos impide identificar la interacción contemporánea de las variables. Los choques <span class="math inline">\(u_t\)</span> no se pueden interpretar directamente porque no son ortogonales. En este sentido, para encontrar choques estructurales, debemos encontrar choques <span class="math inline">\(w_t\)</span> que sí sean ortogonales y tengan una interpretación económica.</p>
<p>Comencemos con la forma estructural del VAR para comprender sus parámetros:
<span class="math display">\[\begin{equation}
B_0 Y_t = B_1 Y_{t-1} + ... B_p Y_{t-p} + w_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(w_t\)</span> es un término de error con media cero y no correlacionado en el tiempo, también conocido como innovación estructural o shock estructural. Además, se asume que el término de error es incondicionalmente homocedástico a menos de que se indique lo contrario. La matriz <span class="math inline">\(B_0\)</span> es no singular y establece la interacción contemporánea entre las variables del modelo. De este modo, el modelo puede escribirse de manera compacta como:
<span class="math display">\[\begin{equation}
B(L) y_t = w_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(B(L) \equiv B_0 - B_1 L - B_2 L^2 - ...B_p L^p\)</span> es el polinomio autorregresivo en rezagos. La matriz de covarianza del término de error estructural es normalizada tal que:
<span class="math display">\[\begin{equation}
\mathbb{E}(w_t w_t&#39;) \equiv \Sigma_w = I_K.
\end{equation}\]</span></p>
<p>Con esto, sabemos que existen tantos shocks estructurales como variables en el modelo. Asimismo, los shocks estructurales, por definición, son mutuamente no correlacionados lo que implica que <span class="math inline">\(\Sigma_w\)</span> es diagonal. Por último, también sabemos que si normalizamos la varianza de todos los shocks estructurales a uno, no implica una pérdida de generalidad siempre y cuando los elementos diagonales <span class="math inline">\(B_0\)</span> permanezcan sin restricciones.</p>
<p>Sin embargo, para que el modelo <span class="math inline">\(B_0 Y_t = B_1 Y_{t-1} + ... B_p Y_{t-p} + w_t\)</span> sea considerado como un VAR estructural no es suficiente con que los elementos de <span class="math inline">\(w_t\)</span> no se encuentren correlacionados, si no que los choques también deben ser económicamente interpretables. Para esto, derivamos la forma reducida de este modelo VAR estructural de tal modo que <span class="math inline">\(y_t\)</span> es una función de los rezagos de <span class="math inline">\(y_t\)</span> únicamente. Si multiplicamos ambos lados de la representación estructural del VAR por <span class="math inline">\(B_0^{-1}\)</span>
<span class="math display">\[\begin{equation}
B_0^{-1} B_0 y_t = B_0^{-1} B_1 y_{t-1} + ... + B_0^{-1} B_p y_{t-p} + B_0^{-1} w_t
\end{equation}\]</span></p>
<p>de tal modo que puede ser representado como
<span class="math display">\[\begin{equation}
y_t = A_1 y_{t-1} + ... + A_p y_{t-p} + u_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(A_i = B_0^{-1} B_i\)</span>, <span class="math inline">\(i = 1,...,p\)</span>, y <span class="math inline">\(u_t = B_0^{-1} w_t\)</span>. Asi, las innovaciones en forma reducida de <span class="math inline">\(u_t\)</span> son un promedio ponderado de los shocks estructurales <span class="math inline">\(w_t\)</span>. De manera compacta, el modelo puede ser expresado como:
<span class="math display">\[\begin{equation}
A(L) y_t = u_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(A(L) = I_K - A_1L - A_2 L^2 - ... A_p L^p\)</span> es el polinomio autorregresivo en rezagos. Los métodos de estimación estándar permiten obtener estimaciones de los parámetros de la forma reducida <span class="math inline">\(A_i\)</span>, para <span class="math inline">\(i=1,...p\)</span>, de las innovaciones reducidas <span class="math inline">\(u_t\)</span> y de su matriz de covarianza <span class="math inline">\(\mathbb{E}(u_t u_t&#39;) \equiv \Sigma_u\)</span>.</p>
<p>Sin embargo, el debate que se ha generado desde entonces es, una vez estimada la forma reducida, de qué manera se puede recuperar la representación estructural del modelo VAR. Es decir, queremos recuperar la matriz <span class="math inline">\(B_0\)</span> -o bien, su inversa- que contiene las relaciones estructurales contemporáneas de las variables, recordando que <span class="math inline">\(u_t = B_0^{-1}w_t\)</span>.</p>
<p>El método para recuperar dicha matriz ha generado gran debate en el análisis macroeconométrico, dando pie incluso a tesis doctorales al respecto. Con esto en mente, ahora veremos algunos de los métodos clásicos para recuperar las relaciones estructurales de las variables. Nos concentraremos en los siguientes:</p>
<p><em>1. Identificación Recursiva</em></p>
<p><em>2. Restricción de largo plazo</em></p>
<p><em>3. Imposición de restricciones de signo</em></p>
<p><strong><em>Nota: RStudio es un poco limitado en cuanto a los métodos de identificación de las innovaciones estructurales relacionados con la teoría económica. En realidad, en los trabajos actuales de macroeconometría suele ocuparse, mayoritariamente, el método de Identificación Recursiva. Sin embargo, para ver los métodos de Restricción de largo plazo e Imposición de restricciones de signo, ver el Script de MatLab de estos.</em></strong></p>
<div id="var-recursivo---identificación-recursiva" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> VAR Recursivo - Identificación Recursiva<a href="#var-recursivo---identificaci%C3%B3n-recursiva" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una de las formas más populares para recuperar las innovaciones estructurales es mediante la <em>identificación recursiva</em>, un caso particular de las restricciones de corto plazo que se implementa utilizando la <strong>descomposición de Cholesky</strong>.</p>
<p>La idea detrás de este método es simple e intuitivo: queremos recuperar las innovaciones estructurales <span class="math inline">\(w_t\)</span> a partir de las innovaciones de forma reducida <span class="math inline">\(u_t\)</span>. Para lograr esto, buscamos <em>ortogonalizar</em> los errores de forma reducida, lo que en este contexto significa transformarlos en un conjunto de choques no correlacionados contemporáneamente. Es decir, deseamos que <span class="math inline">\(\mathbb{E}[w_t w_t&#39;] = I\)</span>.</p>
<p>Para lograr esto, definimos una matriz <span class="math inline">\(P\)</span> de tamaño <span class="math inline">\(K \times K\)</span>, triangular inferior y con diagonal principal positiva, de tal modo que:</p>
<p><span class="math display">\[\begin{equation}
\Sigma_u = \mathbb{E}[u_t u_t&#39;] = P P&#39;
\end{equation}\]</span></p>
<p>La matriz <span class="math inline">\(P\)</span> es conocida como la <strong>descomposción de Cholesky inferior de <span class="math inline">\(\Sigma_u\)</span></strong>. Por ejemplo, en un VAR con tres variables, <span class="math inline">\(P\)</span> tendría la forma:</p>
<p><span class="math display">\[
P =
\begin{bmatrix}
p_{11} &amp; 0      &amp; 0 \\
p_{21} &amp; p_{22} &amp; 0 \\
p_{31} &amp; p_{32} &amp; p_{33}
\end{bmatrix}
\]</span></p>
<p>Ahora, si recordamos que en el modelo estructural los errores están relacionados por <span class="math inline">\(u_t = B_0^{-1}w_t\)</span> y que</p>
<p><span class="math display">\[\begin{equation}
\Sigma_u = B_0^{-1} \mathbb{E}[w_t w_t&#39;] B_0^{-1&#39;} = B_0^{-1} B_0^{-1&#39;}
\end{equation}\]</span></p>
<p>entonces una solución válida al problema de identificación estructural es asumir que <span class="math inline">\(B_0^{-1} = P\)</span>. Dado que <span class="math inline">\(P\)</span> es triangular inferior, contiene exactamente <span class="math inline">\(\frac{K(K-1)}{2}\)</span> ceros impuestos, lo que cumple la condición de orden para identificar todos los elementos libres de la matriz <span class="math inline">\(B_0^{-1}\)</span>. Por simetría. si <span class="math inline">\(B_0^{-1}\)</span> es triangular inferior, entonces <span class="math inline">\(B_0\)</span> también lo es -aunque triangular superior-.</p>
<p>Sin embargo, es importante destacar que esta ortogonalización de los errores solo es válida si la estructura recursiva impuesta por la matriz <span class="math inline">\(P\)</span> se puede justificar con fundamentos económicos. El método impone que la primera variable del sistema responde solo a su propio shock contemporáneo, la segunda puede responder al shock de la primera, la tercera a los dos primeros, y así sucesivamente. Por eso se dice que el modelo estructural resultante es recursivo: se impone una estructura jerárquica de causalidad contemporánea, en lugar de inferirla directamente de los datos.</p>
<p>En este sentido, la <strong>descomposición de Cholesky</strong> no descubre las relaciones estructurales sino que las impone. Por lo tanto, el orden de las variables en el VAR <strong>si importa</strong>, ya que determina la interpretación de los shocks estructurales. Por esta razón, se recomienda justificar el orden mediante teoría económica. Por ejemplo, en aplicaciones del Banco de México, el orden se suele establecer de acuerdo con la hipótesis de una economía pequeña y abierta, ordenando las variables de la más exógena a la más endógena.</p>
<p>Veamos un ejemplo rápido de la <em>identificación recursiva</em> mediante la <strong>descomposición de Cholesky</strong>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-1" tabindex="-1"></a><span class="co"># install.packages(&quot;svars&quot;)</span></span>
<span id="cb25-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-2" tabindex="-1"></a><span class="co"># install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb25-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-3" tabindex="-1"></a><span class="co"># install.packages(&quot;ggfortify&quot;)</span></span>
<span id="cb25-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-4" tabindex="-1"></a><span class="fu">library</span>(svars)</span>
<span id="cb25-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-6" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb25-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-8" tabindex="-1"></a>var.reducido <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(USA, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">ic =</span> <span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb25-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-9" tabindex="-1"></a>var.estructural <span class="ot">&lt;-</span> <span class="fu">id.chol</span>(var.reducido)</span>
<span id="cb25-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb25-10" tabindex="-1"></a><span class="fu">summary</span>(var.estructural)</span></code></pre></div>
<pre><code>## 
## Identification Results
## ---------------------- 
## 
## Method: Cholesky
## Sample size: 169
## 
## Estimated B Matrix (unique decomposition of the covariance matrix): 
##           [,1]      [,2]      [,3]
## x   0.68338360 0.0000000 0.0000000
## pi -0.03642697 1.0726563 0.0000000
## i   0.22450359 0.1818031 0.7672318</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-1" tabindex="-1"></a><span class="co"># x  = Porcentaje de desviación logarítmica del PIB real con respecto a la </span></span>
<span id="cb27-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-2" tabindex="-1"></a><span class="co">#      estimación del producto potencial</span></span>
<span id="cb27-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-3" tabindex="-1"></a><span class="co"># pi = Crecimiento anualizado trimestre a trimestre del deflactor del PIB</span></span>
<span id="cb27-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-4" tabindex="-1"></a><span class="co"># i  = Tasa de interés de los fondos federales</span></span>
<span id="cb27-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-6" tabindex="-1"></a>cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb27-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-7" tabindex="-1"></a>boot.svar <span class="ot">&lt;-</span> <span class="fu">wild.boot</span>(var.estructural, <span class="at">n.ahead =</span> <span class="dv">24</span>, <span class="at">nboot =</span> <span class="dv">1000</span>, <span class="at">nc =</span> cores)</span>
<span id="cb27-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb27-9" tabindex="-1"></a><span class="fu">plot</span>(boot.svar)</span></code></pre></div>
<p><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="var-estructural---restricción-de-largo-plazo" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> VAR Estructural - Restricción de largo plazo<a href="#var-estructural---restricci%C3%B3n-de-largo-plazo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Otra manera de identificar las innovaciones estructurales de un modelo VAR, es mediante el método propuesto por Blanchard y Quah (1989) en <em>“The Dynamic Effects of Aggregate Demand and Supply Disturbances”</em>.</p>
<p>La intuición de este método es simple: Blanchard y Quah querían medir el efecto de choques de oferta agregada <span class="math inline">\(w_t^{AS}\)</span> y demanda agregada <span class="math inline">\(w_t^{AD}\)</span> sobre el Producto y el Desempleo, imponiendo restricciones en la respuesta acumulada, es decir, en el efecto acumulado permanente (horizonte <span class="math inline">\(h \rightarrow \infty\)</span>). La lógica económica detrás de este método es, básicamente, que el choque de demanda agregada no tiene efectos de largo plazo sobre el nivel del PIB real.</p>
<p>Ahora bien, sean:</p>
<ul>
<li><span class="math inline">\(ur_t\)</span>: tasa de desempleo en EE.UU.</li>
<li><span class="math inline">\(gdp_t\)</span>: logaritmo del PIB real de EE.UU.</li>
</ul>
<p>Y definimos el vector <span class="math inline">\(z_t\)</span></p>
<p><span class="math display">\[\begin{equation}
z_t = \begin{bmatrix} \Delta gdp_t \\ ur_t \end{bmatrix} \sim I(0)
\end{equation}\]</span></p>
<p>Aunque <span class="math inline">\(gdp_t \sim I(1)\)</span>, su primera diferencia es estacionaria (<span class="math inline">\(I(0)\)</span>), lo cual justifica que <span class="math inline">\(z_t \sim I(0)\)</span>. Por otro lado, podemos suponer que este vector es generado por un VAR reducido:</p>
<p><span class="math display">\[\begin{equation}
A(L) z_t = u_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(A(L)=I_2-A_1L-...A_pL^p\)</span>, y <span class="math inline">\(u_t \sim (0, \Sigma_u)\)</span> es ruido blanco. Si lo representamos como su forma estructural, tenemos que:</p>
<p><span class="math display">\[\begin{equation}
B(L) z_t = w_t
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(B(L) = B_0-B_1L-...B_pL^p = B_0A(L)\)</span>, y si recordamos a qué es igual <span class="math inline">\(w_t\)</span>, tenemos que:</p>
<p><span class="math display">\[\begin{equation}
w_t = B_0 u_t \rightarrow u_t = B_0^{-1} w_t \rightarrow \Sigma_u = B_0^{-1} (B_0^{-1})&#39;
\end{equation}\]</span></p>
<p>Ahora, pasemos a la representación MA estructural para entender dónde se impone la restricción. Desde el modelo MA, tenemos que:</p>
<p><span class="math display">\[\begin{equation}
z_t = B(L)^{-1} w_t = \Theta (L) w_t
\end{equation}\]</span></p>
<p>Esto implica que, dado que <span class="math inline">\(z_t \sim I(0)\)</span>, el efecto de un choque estructural sobre <span class="math inline">\(z_t\)</span> se desvanece con el tiempo y, por tanto, tanto <span class="math inline">\(\Delta gdp_t\)</span> como <span class="math inline">\(ur_t\)</span> eventualmente vuelven a su nivel original tras un choque. Sin embargo, el nivel del PIB real -y no su crecimiento- no necesariamente vuelve a su nivel inicial, por lo que la suma acumulada de las respuestas al choque nos da su efecto permanente. Ahora, pasemos a la matriz de efectos acumulados de largo plazo, definida como:</p>
<p><span class="math display">\[\begin{equation}
\Theta (1) = \sum_{i=0}^{\infty} \Theta_i = B(1)^{-1}
\end{equation}\]</span></p>
<p>Dado que queremos que el PIB real vuelva a su tendencia tras un choque de demanda -recordemos que no tiene efectos de largo plazo- implica imponer un cero en la posición <span class="math inline">\(\theta_{12}\)</span> de la matriz <span class="math inline">\(\Theta(1)\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\Theta (1) = \begin{bmatrix}
                    \theta_{11} (1) &amp; 0               \\
                    \theta_{21} (1) &amp; \theta_{22} (1)
             \end{bmatrix}
\end{equation}\]</span></p>
<p>el hecho de que <span class="math inline">\(\theta_{12}(1) = 0\)</span> implica que el choque de demanda no afecta permanentemente al PIB real y, por otro lado, que <span class="math inline">\(\theta_{11}(1)\)</span> permanezca libre, implica que los choques de oferta sí pueden tener efectos de largo plazo.</p>
<p>Para la identificación, recordemos que:</p>
<p><span class="math display">\[\begin{equation}
\Theta (1) = B(1)^{-1} = A(1)^{-1} B_0^{-1} \rightarrow B_0^{-1} = A(1) \Theta(1)
\end{equation}\]</span></p>
<p>De este modo, una vez que conocemos <span class="math inline">\(A(1)\)</span> y <span class="math inline">\(\Theta(1)\)</span> podemos recuperar <span class="math inline">\(B_0^{-1}\)</span>, recordando que la restricción en <span class="math inline">\(\Theta(1)\)</span> es equivalente a imponer una restricción sobre <span class="math inline">\(B_0\)</span>.</p>
<p>Para estimar <span class="math inline">\(\Theta(1)\)</span>, sabemos que:</p>
<p><span class="math display">\[\begin{equation}
\Sigma_u = B_0^{-1} (B_0^{-1})&#39; = \Theta(1) \Theta(1)&#39;
\end{equation}\]</span></p>
<p>y, entonces, si usamos <span class="math inline">\(A(1)\)</span>:</p>
<p><span class="math display">\[\begin{equation}
A(1)^{-1} \Sigma_u A(1)^{-1&#39;} = \Theta(1) \Theta(1)&#39;
\end{equation}\]</span></p>
<p>lo cual implica que podemos calcular el lado izquierdo usando solo parámetros estimados del VAR reducido y luego identificar <span class="math inline">\(\Theta(1)\)</span> imponiendo que tenga forma triangular inferior, y aplicar la <strong>descomposición de Cholesky</strong> para tener finalmente que:</p>
<p><span class="math display">\[\begin{equation}
B_0^{-1} = A(1) \Theta (1)
\end{equation}\]</span></p>
</div>
<div id="var-estructural---imposición-de-restricciones-de-signo" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> VAR Estructural - Imposición de restricciones de signo<a href="#var-estructural---imposici%C3%B3n-de-restricciones-de-signo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una alternativa a la identificación de las innovaciones estructurales además de la <em>Identificación recursiva</em> es la <strong>Imposición de restricciones de signo</strong>. Sigue un poco la misma lógica: queremos imponer restricciones de signo en vez de proponer una matriz triangular inferior en la matriz <span class="math inline">\(B_0^{-1}\)</span>. Este método ofrece una alternativa menos restrictiva que imponer ceros exactos. Para explicar este método, tomemos el siguiente modelo ejemplo.</p>
<p>Consideremos un modelo bivariado de un mercado de bienes con:</p>
<ul>
<li>Un choque de demanda <span class="math inline">\(w_t^{demanda}\)</span></li>
<li>Un choque de oferta <span class="math inline">\(w_t^{oferta}\)</span></li>
</ul>
<p>en donde nuestras variables observables son:</p>
<ul>
<li>Precio <span class="math inline">\(p_t\)</span></li>
<li>Cantidad <span class="math inline">\(q_t\)</span></li>
</ul>
<p>Y los errores en forma reducida están dados por:</p>
<p><span class="math display">\[\begin{equation}
u_t = \begin{bmatrix} u_t^q \\ u_t^p \end{bmatrix} = B_0^{-1} w_t
      \quad \text{donde} \quad
w_t = \begin{bmatrix} w_t^{oferta} \\ w_t^{demanda} \end{bmatrix}
\end{equation}\]</span></p>
<p>Es sencillo: la interpretación económica es que los efectos de los choques <span class="math inline">\(u_t\)</span> dependen de la pendiente de las curvas de demanda y oferta.</p>
<p>En un método tradicional -restricción de exclusión-, se asume que la oferta es vertical en el corto plazo, lo cual implica que los choques de demanda no afectan la cantidad contemporáneamente:</p>
<p><span class="math display">\[\begin{equation}
\begin{bmatrix} u_t^q \\ u_t^p \end{bmatrix} =
\begin{bmatrix} \ast &amp; 0 \\
                \ast &amp; \ast
                \end{bmatrix}
\begin{bmatrix} w_t^{oferta} \\ w_t^{demanda} \end{bmatrix}
\end{equation}\]</span></p>
<p>En donde los asteriscos representan <em>coeficientes libres</em> y el cero es una <em>restricción de exclusión</em>.</p>
<p>En cambio, si tomamos la teoría económica básica en el enfoque alternativo de <strong>Imposición de restricción de signo</strong> esperaríamos que, ante un choque de oferta positivo -la curva de oferta se desplaza a la derecha-, la cantidad aumente y el precio caiga, mientras que, ante un choque de demanda positiva -la curva de demanda se desplaza a la derecha-, la cantidad aumenta y el precio aumenta. De este modo, tenemos que:</p>
<p><span class="math display">\[\begin{equation}
  \begin{bmatrix} u_t^q \\ u_t^p \end{bmatrix} =
    \underbrace{
  \begin{bmatrix} + &amp; + \\ - &amp; + \end{bmatrix}
    }_{B_0^{-1}}
  \begin{bmatrix} w_t^{\text{oferta}} \\ w_t^{\text{demanda}} \end{bmatrix}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(+\)</span> indica signo positivo estricto y <span class="math inline">\(-\)</span> negativo estricto.</p>
<p>La diferencia clave con el método de <em>Identificación recursiva mediante la descomposición de Cholesky</em> es que, en estos últimos modelos, los parámetros están puntualmente identificados mientras que con <strong>restricciones de signo</strong> los parámetros no se identifican exactamente, sino que quedan dentro de un conjunto compatible con las restricciones. De este modo, no hay una única solución, pues hay muchas matrices <span class="math inline">\(B_0^{-1}\)</span> que cumplen con los signos impuestos. También, se pueden imponer <strong>restricciones de signo</strong> de la siguiente forma:</p>
<p><span class="math display">\[\begin{equation}
  \begin{bmatrix} + &amp; + \\ 0 &amp; + \end{bmatrix}
      \quad \text{o} \quad
  \begin{bmatrix} + &amp; + \\ - &amp; 0 \end{bmatrix}
\end{equation}\]</span></p>
<p>Estas formas también pueden ser admisibles pero algunas podrían llegar a ser problemáticas si llevan a choques no identificables entre sí.</p>
<p>Se dice que los modelos identificados por signos son más generales que los recursivos pero no son modelos “anidados”, o sea, uno no puede validar o rechazar el otro con datos. Así, las <strong>restricciones de signo</strong> permiten más flexibilidad, pero imponen otras limitaciones como perder identificación puntual.</p>
<p>Ahora, de manera más puntual, para imponer las <strong>restricciones de signo estáticas</strong> consideremos un modelo VAR en su forma estructural:</p>
<p><span class="math display">\[\begin{equation}
B_0 y_t = B_1 y_{t-1} + ... + B_p y_{t-p} + w_t
\end{equation}\]</span></p>
<p>y normalizamos la matriz de varianzas-covarianzas del término de error estructural <span class="math inline">\(w_t\)</span> tal que:</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}(w_t w_t&#39;) \equiv \Sigma_w = I_K.
\end{equation}\]</span></p>
<p>Ahora, sea <span class="math inline">\(u_t = P \eta_t\)</span>, donde <span class="math inline">\(u_t\)</span> es la innovación del VAR en forma reducida y <span class="math inline">\(P\)</span> es la descomposición de Cholesky de <span class="math inline">\(\Sigma_u\)</span>. Por construcción, los choques <span class="math inline">\(\eta_t\)</span> son mutuamente no correlacionados y tienen varianza unitaria. Por supuesto, no hay razón para que estos choques correspondan a choques estructurales económicamente interpretables, como los choques de oferta y demanda en el modelo bivariado mencionado anteriormente. Sin embargo, podemos buscar soluciones candidatas <span class="math inline">\(w_t^*\)</span> para los choques estructurales desconocidos <span class="math inline">\(w_t\)</span> construyendo un gran número de combinaciones de los choques <span class="math inline">\(\eta_t\)</span> de la forma:</p>
<p><span class="math display">\[\begin{equation}
w_t^* = Q&#39; \eta_t,
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(Q&#39;\)</span> es una matriz ortogonal cuadrada tal que <span class="math inline">\(Q&#39;Q = QQ&#39; = I_K\)</span> y <span class="math inline">\(u_t = PQ \eta_t = PQw_t^*\)</span>. Por lo tanto, cada solución candidata <span class="math inline">\(w_t^*\)</span> consiste en choques no correlacionados con varianza unitaria. Que una de estas soluciones candidatas <span class="math inline">\(w_t^*\)</span> sea una solución admisible para el choque estructural desconocido <span class="math inline">\(w_t\)</span>, dado el vector de parámetros en forma reducida, depende de si la matriz de impacto estructural implicado <span class="math inline">\(PQ\)</span> satisface las restricciones de signo mantenidas sobre <span class="math inline">\(B_0^{-1}\)</span>. De este modo, solo conservamos las soluciones que satisfagan las restricciones de signo y se descartan las demás. El hecho de repetir este procedimiento nos permite caracterizar el conjunto de todos los modelos estructurales que son consistentes con las restricciones de signo mantenidas y los parámetros en forma reducida. Conocer <span class="math inline">\(PQ\)</span> permite construir todos los coeficientes estructurales de respuesta al impulso que se derivan de las estimaciones de los parámetros en forma reducida.</p>
<p>Los dos enfoques comunes para construir las matrices ortogonales <span class="math inline">\(Q\)</span> están basados en:</p>
<ol style="list-style-type: decimal">
<li><p>Matrices de rotación de Givens.</p></li>
<li><p>Transformación de Householder.</p></li>
</ol>
<p>La paquetería del código de MatLab, VAR Toolbox, ocupa el enfoque de <strong>Matrices de rotación de Givens</strong>.</p>
</div>
</div>
<div id="cointegración" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Cointegración<a href="#cointegraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta ahora en el curso hemos usado el supuesto de que las series son
estacionarias para el conjunto de técnicas <span class="math inline">\(ARMA(p,q)\)</span> y <span class="math inline">\(VAR(p)\)</span>. No
obstante, dado que relajamos el supuesto de estacionariedad (incluyendo
la estacionariedad en varianza) y que establecimos una serie de pruebas
para determinar cuándo una serie es estadísticamente estacionaria, ahora
podemos plantear una técnica llamada Cointegración. Para esta técnica
consideraremos sólo series que son <span class="math inline">\(I(1)\)</span> y reconoceremos que se originó
con los trabajos de Engle y Granger (1987), Stock (1987) y Johansen
(1988).</p>
<div id="definición-y-propiedades-del-proceso-de-cointegración" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Definición y propiedades del proceso de cointegración<a href="#definici%C3%B3n-y-propiedades-del-proceso-de-cointegraci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cointegración puede ser caracterizada o definida en palabras sencillas
como que dos o más variables tienen una relación común estable en el
largo plazo. Es decir, estas no suelen tomar caminos o trayectorias
diferentes, excepto por períodos de tiempo transitorios y eventuales. A
continuación, utilizaremos la definición de Engle y Granger (1984) de
cointegración.</p>
<p>Sea <span class="math inline">\(\mathbf{Y}\)</span> un vector de k-series de tiempo, decimos que los
elementos en <span class="math inline">\(\mathbf{Y}\)</span> están cointegrados en un orden (d, c), es
decir, <span class="math inline">\(\mathbf{Y} \sim CI(d, c)\)</span>, si todos los elementos de
<span class="math inline">\(\mathbf{Y}\)</span> son series integradas de orden d, I(d), y si existe al
menos una combinación lineal no trivial <span class="math inline">\(\mathbf{Z}\)</span> de esas variables
que es de orden I(d - c), donde <span class="math inline">\(d \geq c &gt; 0\)</span>, si y sólo si:
<span class="math display">\[\begin{equation}
    \boldsymbol{\beta}_i&#39; \mathbf{Y}_t = \mathbf{Y}_{it} \sim I(d-c)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(i = 1, 2, \ldots, r\)</span> y <span class="math inline">\(r &lt; k\)</span>.</p>
<p>A los diferentes vectores <span class="math inline">\(\boldsymbol{\beta}_i\)</span> se les denomina como
vectores de cointegración. El rango de la matriz de vectores de
cointegración <span class="math inline">\(r\)</span> es el número de vectores de cointegración linealmente
independientes. En general diremos que los vectores de la matriz de
cointegración <span class="math inline">\(\boldsymbol{\beta}\)</span> tendrán la forma de: <span class="math display">\[\begin{equation}
    \boldsymbol{\beta}&#39; \mathbf{Y}_t = \mathbf{Z}_t
\end{equation}\]</span></p>
<p>Antes de continuar hagamos algunas observaciones. Si todas las variables
de <span class="math inline">\(\mathbf{Y}\)</span> son I(1) y <span class="math inline">\(0 \leq r &lt; k\)</span>, diremos que las series no
cointegran si <span class="math inline">\(r = 0\)</span>. Si esto pasa, entonces, como demostraremos más
adelante, la mejor opción será estimar un modelo VAR(p) en diferencias.
Adicionalmente, asumiremos que <span class="math inline">\(c = d = 1\)</span>, por lo que la relación de
cointegración, en su caso, generará combinaciones lineales <span class="math inline">\(\mathbf{Z}\)</span>
estacionarias.</p>
</div>
<div id="cointegración-para-modelos-de-más-de-una-ecuación-o-para-modelos-basados-en-vectores-autoregresivos" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Cointegración para modelos de más de una ecuación o para modelos basados en Vectores Autoregresivos<a href="#cointegraci%C3%B3n-para-modelos-de-m%C3%A1s-de-una-ecuaci%C3%B3n-o-para-modelos-basados-en-vectores-autoregresivos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sean <span class="math inline">\(Y_1, Y_2, \ldots, Y_k\)</span> son series que forman <span class="math inline">\(\mathbf{Y}\)</span> y que
todas son I(1), entonces los siguientes casos son posibles:</p>
<ol style="list-style-type: decimal">
<li><p>Si <span class="math inline">\(r = 1\)</span> entonces se trata de un caso de cointegración de Granger.</p></li>
<li><p>Si <span class="math inline">\(r \geq 1\)</span> entonces se trata de un caso de cointegración múltiple
de Johansen.</p></li>
</ol>
<p>Por lo anterior, en este curso analizaremos el caso de Cointegración de
Johansen. Ahora plantearemos la forma de estimar el proceso de
cointegración. El primer paso para ello es determinar un modelo VAR(p)
con las k-series no estacionarias (series en niveles)–en este punto se
vuelve fundamental caracterizar las series a través de pruebas de raíces
unitarias–. Elegimos el valor de <span class="math inline">\(p\)</span> mediante el uso de los criterios
de información. De esta forma tendremos una especificación similar a:
<span class="math display" id="eq:VARCI">\[\begin{equation}
    \mathbf{Y}_t = \sum_{j=1}^p \mathbf{A}_j \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
    \tag{5.2}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{U}_t\)</span> es un término de error k-dimensional puramente
aleatorio; <span class="math inline">\(\mathbf{D}_t\)</span> contiene los componentes determinísticos de
constante y tendencia, y <span class="math inline">\(\mathbf{A}_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, son
matrices de <span class="math inline">\(k \times k\)</span> coeficientes. Notemos que el VAR(p) involucrado
en este caso, a diferencia del VAR anteriormente estudiado, puede
incluir un término de tendencia. Esto en razón de que hemos relajado el
concepto de estacionariedad.</p>
<p>Si reescribimos la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:VARCI">(5.2)</a> en su forma de Vector
Corrector de Errores (VEC, por sus siglas en inglés) tenemos:
<span class="math display" id="eq:VARVEC">\[\begin{eqnarray}
    \mathbf{Y}_t - \mathbf{Y}_{t-1} &amp; = &amp; \Delta \mathbf{Y}_t \nonumber \\
    &amp; = &amp; \sum_{j=1}^p \mathbf{A}_j \mathbf{Y}_{t-j} + \mathbf{D}_t - \mathbf{Y}_{t-1} + \mathbf{U}_t \nonumber \\
    &amp; = &amp; (\mathbf{A}_1 - \mathbf{I}) \mathbf{Y}_{t-1} + \mathbf{A}_2 \mathbf{Y}_{t-2} + \ldots + \mathbf{A}_p \mathbf{Y}_{t-p} + \mathbf{D}_t + \mathbf{U}_t \nonumber \\
    &amp; = &amp; \left( \sum_{j=1}^{p} \mathbf{A}_j - \mathbf{I} \right) \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t \mathbf{U}_t \nonumber \\
    &amp; = &amp; - \left( \mathbf{I} - \sum_{j=1}^{p} \mathbf{A}_j \right) \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t \mathbf{U}_t \nonumber \\
    \Delta \mathbf{Y}_t &amp; = &amp; - \Pi \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
    \tag{5.3}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{A}_j^* = - \sum_{i=j+1}^p \mathbf{A}_i\)</span>,
<span class="math inline">\(i = 1, 2, \ldots, p-1\)</span>, y la matriz <span class="math inline">\(\Pi\)</span> representa todas las
relaciones de largo plazo entre las variables, por lo que la matriz es
de rango completo <span class="math inline">\(k \times k\)</span>. Por lo tanto, tenemos que dicha matriz
en la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:VARVEC">(5.3)</a> se puede factorizar como:
<span class="math display">\[\begin{equation}
    \Pi_{(k \times k)} = \Gamma_{(k \times r)} \boldsymbol{\beta}_{(r \times k)}&#39;
    (\#eq:Pi_Matrix)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\boldsymbol{\beta}_{(r \times k)}&#39; \mathbf{Y}_{t-1}\)</span> son <span class="math inline">\(r\)</span>
combinaciones linealmente independientes que son estacionarias.</p>
<p>Dada la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:VARVEC">(5.3)</a> podemos establecer la aproximación de
Johansen (1988) que se realiza mediante una estimación por Máxima
Verosimilitud de la ecuación: <span class="math display">\[\begin{equation}
    \Delta \mathbf{Y}_t + \Gamma \boldsymbol{\beta}&#39; \mathbf{Y}_{t-1} = \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
\end{equation}\]</span></p>
<p>Donde una vez estimado el sistema: <span class="math display">\[\begin{equation}
    \boldsymbol{\beta} = [v_1, v_2, \ldots, v_r]
\end{equation}\]</span></p>
<p>Cada <span class="math inline">\(v_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, r\)</span> es un vector propio que está asociado
con los <span class="math inline">\(r\)</span> valores propios positivos, mismos que están asociados con la
prueba de hipótesis de cointegración. Dicha hipótesis está basada en dos
estadísticas con las que se determina el rango <span class="math inline">\(r\)</span> de <span class="math inline">\(\Pi\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Prueba de Traza: <span class="math inline">\(H_0 :\)</span> Existen al menos <span class="math inline">\(r\)</span> valores propios
positivos o Existen al menos <span class="math inline">\(r\)</span> relaciones de largo plazo
estacionarias.</p></li>
<li><p>Prueba del valor propio máximo o <span class="math inline">\(\lambda_{max}\)</span>: <span class="math inline">\(H_0 :\)</span> Existen
<span class="math inline">\(r\)</span> valores propios positivos o Existen <span class="math inline">\(r\)</span> relaciones de largo
plazo estacionarias.</p></li>
</ol>
<p>. Para ejemplificar el procedimiento de cointegración
utilizaremos las series de INPC, Tipo de Cambio, rendimiento de los
Cetes a 28 días, IGAE e Índice de Producción Industrial de Estados
Unidos. Quizá el marco teórico de la relación entre las variables no sea
del todo correcto, pero dejando de lado ese problema, estimaremos si las
5 series cointegran.</p>
<p>Por principio, probaremos que todas las series son I(1), lo cual es
cierto (ver Scrip para mayores detalles). En las Figuras
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig81">5.9</a>, <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig82">5.10</a> y <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig83">5.11</a> se muestran las
series en niveles y en diferencias, con lo cual ilustramos como es
viable que las series sean I(1).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb28-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb28-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-4" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb28-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-5" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb28-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-6" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb28-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-7" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb28-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-8" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb28-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-9" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb28-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-10" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb28-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-11" tabindex="-1"></a></span>
<span id="cb28-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-12" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-13"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-13" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Datos_Ad.RData&quot;</span>)</span>
<span id="cb28-14"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-14" tabindex="-1"></a></span>
<span id="cb28-15"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-15" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-16"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-16" tabindex="-1"></a><span class="do">## Conversion a series de tiempo:</span></span>
<span id="cb28-17"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-17" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad[<span class="dv">7</span><span class="sc">:</span> <span class="dv">11</span>], </span>
<span id="cb28-18"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-18" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb28-19"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-19" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb28-20"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-20" tabindex="-1"></a></span>
<span id="cb28-21"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-21" tabindex="-1"></a>LDatos <span class="ot">&lt;-</span> <span class="fu">log</span>(Datos)</span>
<span id="cb28-22"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-22" tabindex="-1"></a></span>
<span id="cb28-23"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-23" tabindex="-1"></a>DLDatos <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(Datos, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">1</span>)), </span>
<span id="cb28-24"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-24" tabindex="-1"></a>                <span class="at">lag =</span> <span class="dv">1</span>, </span>
<span id="cb28-25"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb28-25" tabindex="-1"></a>                <span class="at">differences =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(LDatos, </span>
<span id="cb29-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb29-2" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;m&quot;</span>, <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb29-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb29-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb29-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb29-4" tabindex="-1"></a>     <span class="co">#main = &quot;Series en Logaritmos&quot;, </span></span>
<span id="cb29-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb29-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig81"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig81-1.png" alt="Series en niveles (logaritmos) para la prueba de Cointegración" width="672" />
<p class="caption">
Figure 5.9: Series en niveles (logaritmos) para la prueba de Cointegración
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(DLDatos, </span>
<span id="cb30-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb30-2" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;m&quot;</span>, <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb30-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb30-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb30-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb30-4" tabindex="-1"></a>     <span class="co">#main = &quot;Series en Diferencias Logaritmicas&quot;, </span></span>
<span id="cb30-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb30-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig82"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig82-1.png" alt="Series en Diferencias Logarítmicas para la prueba de Cointegración" width="672" />
<p class="caption">
Figure 5.10: Series en Diferencias Logarítmicas para la prueba de Cointegración
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb31-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(LDatos, DLDatos), </span>
<span id="cb31-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb31-2" tabindex="-1"></a>     <span class="at">plot.type =</span> <span class="st">&quot;m&quot;</span>, <span class="at">nc =</span> <span class="dv">2</span>,</span>
<span id="cb31-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb31-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb31-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb31-4" tabindex="-1"></a>     <span class="co">#main = &quot;Comparacion de Series en Diferencias&quot;, </span></span>
<span id="cb31-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb31-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig83"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig83-1.png" alt="Comparacion de Series en Diferencias para la prueba de Cointegración" width="672" />
<p class="caption">
Figure 5.11: Comparacion de Series en Diferencias para la prueba de Cointegración
</p>
</div>
<p>Posteriormente, determinamos cuál es el orden adecuado de un VAR(p) en
niveles. En el Cuadro <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#tab:SelectVARVEC">5.8</a> mostramos los resultados
de los criterios de información para determinar el número de rezagos
óptimos, el cual resultó en <span class="math inline">\(p = 3\)</span> para los criterios AIC y FPE,
<span class="math inline">\(p = 2\)</span> para el criterio HQ y <span class="math inline">\(p = 1\)</span> para el criterio SC. Por lo tanto,
decidiremos utilizar un VAR(3) con tendencia y constante. Note que es
posible elegir otros modelos de VAR que incluyan: solo tendencia, solo
constante o ninguno de estos elementos.</p>
<table>
<caption><span id="tab:SelectVARVEC">Table 5.8: </span> Criterios de información para diferentes
especificaciones de modelos VAR(p) con término constante y tendencia de
las series <span class="math inline">\(LINPC_t\)</span>, <span class="math inline">\(LTC_t\)</span>, <span class="math inline">\(LCETE28_t\)</span>, <span class="math inline">\(LIGAE_t\)</span> y <span class="math inline">\(LIPI_t\)</span>.</caption>
<colgroup>
<col width="13%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">AIC</th>
<th align="center">HQ</th>
<th align="center">SC</th>
<th align="center">FPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-4.606707e+01</td>
<td align="center">-4.585260e+01</td>
<td align="center">-4.553568e+01</td>
<td align="center">9.848467e-21</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-4.643287e+01</td>
<td align="center">-4.606521e+01</td>
<td align="center">-4.552191e+01</td>
<td align="center">6.834064e-21</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">-4.647783e+01</td>
<td align="center">-4.595697e+01</td>
<td align="center">-4.518730e+01</td>
<td align="center">6.539757e-21</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">-4.645834e+01</td>
<td align="center">-4.578428e+01</td>
<td align="center">-4.478824e+01</td>
<td align="center">6.679778e-21</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb32-1" tabindex="-1"></a><span class="do">## VAR(p) Seleccion:</span></span>
<span id="cb32-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb32-3" tabindex="-1"></a><span class="fu">VARselect</span>(LDatos, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      2      2      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -4.313083e+01 -4.356687e+01 -4.357973e+01 -4.350356e+01 -4.346656e+01
## HQ(n)  -4.294456e+01 -4.324754e+01 -4.312735e+01 -4.291813e+01 -4.274808e+01
## SC(n)  -4.266685e+01 -4.277147e+01 -4.245291e+01 -4.204533e+01 -4.167692e+01
## FPE(n)  1.855848e-19  1.200259e-19  1.185548e-19  1.280605e-19  1.330869e-19
##                    6             7             8             9            10
## AIC(n) -4.336621e+01 -4.335767e+01 -4.344758e+01 -4.337426e+01 -4.336604e+01
## HQ(n)  -4.251468e+01 -4.237309e+01 -4.232994e+01 -4.212358e+01 -4.198230e+01
## SC(n)  -4.124515e+01 -4.090520e+01 -4.066369e+01 -4.025896e+01 -3.991931e+01
## FPE(n)  1.474594e-19  1.491718e-19  1.368875e-19  1.480478e-19  1.502148e-19</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb34-1" tabindex="-1"></a><span class="fu">VARselect</span>(LDatos, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;trend&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      2      2      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -4.302183e+01 -4.347336e+01 -4.349266e+01 -4.344039e+01 -4.340559e+01
## HQ(n)  -4.286217e+01 -4.318065e+01 -4.306689e+01 -4.288157e+01 -4.271372e+01
## SC(n)  -4.262413e+01 -4.274425e+01 -4.243213e+01 -4.204844e+01 -4.168223e+01
## FPE(n)  2.069525e-19  1.317817e-19  1.293226e-19  1.363788e-19  1.414042e-19
##                    6             7             8             9            10
## AIC(n) -4.332101e+01 -4.330189e+01 -4.336318e+01 -4.331231e+01 -4.328931e+01
## HQ(n)  -4.249609e+01 -4.234392e+01 -4.227216e+01 -4.208823e+01 -4.193218e+01
## SC(n)  -4.126624e+01 -4.091570e+01 -4.064558e+01 -4.026328e+01 -3.990887e+01
## FPE(n)  1.541996e-19  1.576227e-19  1.488111e-19  1.573361e-19  1.619720e-19</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb36-1" tabindex="-1"></a><span class="fu">VARselect</span>(LDatos, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      2      2      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -4.305293e+01 -4.349519e+01 -4.350862e+01 -4.345110e+01 -4.341448e+01
## HQ(n)  -4.289327e+01 -4.320248e+01 -4.308286e+01 -4.289228e+01 -4.272261e+01
## SC(n)  -4.265523e+01 -4.276608e+01 -4.244809e+01 -4.205915e+01 -4.169111e+01
## FPE(n)  2.006156e-19  1.289360e-19  1.272744e-19  1.349265e-19  1.401536e-19
##                    6             7             8             9            10
## AIC(n) -4.332555e+01 -4.330697e+01 -4.337250e+01 -4.331647e+01 -4.329111e+01
## HQ(n)  -4.250063e+01 -4.234899e+01 -4.228147e+01 -4.209239e+01 -4.193398e+01
## SC(n)  -4.127078e+01 -4.092077e+01 -4.065489e+01 -4.026744e+01 -3.991067e+01
## FPE(n)  1.535010e-19  1.568252e-19  1.474313e-19  1.566830e-19  1.616817e-19</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb38-1" tabindex="-1"></a><span class="fu">VARselect</span>(LDatos, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## $selection
## AIC(n)  HQ(n)  SC(n) FPE(n) 
##      3      2      2      3 
## 
## $criteria
##                    1             2             3             4             5
## AIC(n) -4.300965e+01 -4.346535e+01 -4.349616e+01 -4.344160e+01 -4.339782e+01
## HQ(n)  -4.287660e+01 -4.319924e+01 -4.309701e+01 -4.290939e+01 -4.273256e+01
## SC(n)  -4.267824e+01 -4.280252e+01 -4.250191e+01 -4.211594e+01 -4.174075e+01
## FPE(n)  2.094860e-19  1.328347e-19  1.288547e-19  1.361851e-19  1.424605e-19
##                    6             7             8             9            10
## AIC(n) -4.331937e+01 -4.328561e+01 -4.334269e+01 -4.329813e+01 -4.326892e+01
## HQ(n)  -4.252106e+01 -4.235424e+01 -4.227828e+01 -4.210066e+01 -4.193840e+01
## SC(n)  -4.133088e+01 -4.096570e+01 -4.069137e+01 -4.031539e+01 -3.995476e+01
## FPE(n)  1.543800e-19  1.601088e-19  1.517650e-19  1.594144e-19  1.650919e-19</code></pre>
<p>El mismo número de rezagos los utilizaremos para probar la
Cointegración, ya sea por una estadística de la Traza o por una del
máximo valor propio. Dado que los resultados se sostienen, sólo
mostraremos uno de los casos en que las series cointegran y únicamente
para el caso de la prueba de la traza (el otro caso está disponible en
el código de R disponible abajo). En el Cuadro <a href="#tab:TrazaTest">5.9</a>
reportamos los resultados del Test de Cointegración para un modelo con 3
rezagos.</p>
<p>Cuadro: (#tab:TrazaTest) Prueba de la traza para cointegración
considerando un VAR(p) con término constante y tendencia de las series
<span class="math inline">\(LINPC_t\)</span>, <span class="math inline">\(LTC_t\)</span>, <span class="math inline">\(LCETE28_t\)</span>, <span class="math inline">\(LIGAE_t\)</span> y <span class="math inline">\(LIPI_t\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="center">r <span class="math inline">\(\leq\)</span></th>
<th align="center">Estadística</th>
<th align="center">10%</th>
<th align="center">5%</th>
<th align="center">1%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">4.79</td>
<td align="center">10.49</td>
<td align="center">12.25</td>
<td align="center">16.26</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">13.97</td>
<td align="center">22.76</td>
<td align="center">25.32</td>
<td align="center">30.45</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">27.45</td>
<td align="center">39.06</td>
<td align="center">42.44</td>
<td align="center">48.45</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">48.14</td>
<td align="center">59.14</td>
<td align="center">62.99</td>
<td align="center">70.05</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">118.98</td>
<td align="center">83.20</td>
<td align="center">87.31</td>
<td align="center">96.58</td>
</tr>
</tbody>
</table>
<p>Los resultados del Cuadro <a href="#tab:TrazaTest">5.9</a> indican que aceptamos la
hipótesis nula para el caso de <span class="math inline">\(r \leq 1\)</span> al <span class="math inline">\(5\%\)</span>, por lo que podemos
concluir que existe evidencia estadística para probar que existe al
menos 1 vector de cointegración. Por lo que dicho vector normalizado a
la primera entrada es: <span class="math display">\[\begin{equation}
    \boldsymbol{\beta} = \left[
    \begin{matrix}
    1.00000000 \\
    0.2100057 \\
    0.4812626 \\
    -2.8386112 \\
    -1.2576912 \\
    14.2887887 \\
    \end{matrix} \right]
\end{equation}\]</span></p>
<p>Donde el vector esta normalizado para la serie <span class="math inline">\(LINPC_t\)</span>, por lo que
concluímos que la relación de largo plazo que encontramos cointegra
estará dada por: <span class="math display">\[\begin{eqnarray*}
    LINPC_t &amp; = &amp; -0.2100057 LTC_t - 0.4812626 LCETE28_t \\
    &amp;  &amp; + 2.8386112 LIGAE_t + 1.2576912 LIPI_t \\
    &amp;  &amp; - 14.2887887
\end{eqnarray*}\]</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-1" tabindex="-1"></a><span class="do">## VAR Estimacion:</span></span>
<span id="cb40-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-3" tabindex="-1"></a>VAR_1 <span class="ot">&lt;-</span> <span class="fu">VAR</span>(LDatos, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">type =</span> <span class="st">&quot;both&quot;</span>)</span>
<span id="cb40-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-5" tabindex="-1"></a><span class="co">#summary(VAR_1)</span></span>
<span id="cb40-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-7" tabindex="-1"></a><span class="co">#plot(VAR_1, names = &quot;INPC_Ad&quot;)</span></span>
<span id="cb40-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-8" tabindex="-1"></a><span class="co">#plot(VAR_1, names = &quot;TC_Ad&quot;)</span></span>
<span id="cb40-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-9" tabindex="-1"></a><span class="co">#plot(VAR_1, names = &quot;CETE28_Ad&quot;)</span></span>
<span id="cb40-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-10" tabindex="-1"></a><span class="co">#plot(VAR_1, names = &quot;IGAE_Ad&quot;)</span></span>
<span id="cb40-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-11" tabindex="-1"></a><span class="co">#plot(VAR_1, names = &quot;IPI_Ad&quot;)</span></span>
<span id="cb40-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-13" tabindex="-1"></a><span class="co"># Cointegration Test:</span></span>
<span id="cb40-14"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-14" tabindex="-1"></a><span class="co">#ca.jo = function (x, type = c(&quot;eigen&quot;, &quot;trace&quot;), ecdet = c(&quot;none&quot;, &quot;const&quot;, </span></span>
<span id="cb40-15"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-15" tabindex="-1"></a><span class="co">#&quot;trend&quot;), K = 2, spec = c(&quot;longrun&quot;, &quot;transitory&quot;), season = NULL, </span></span>
<span id="cb40-16"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-16" tabindex="-1"></a><span class="co">#dumvar = NULL) </span></span>
<span id="cb40-17"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-17" tabindex="-1"></a></span>
<span id="cb40-18"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-18" tabindex="-1"></a><span class="co">#summary(ca.jo(LDatos, type = &quot;trace&quot;, ecdet = &quot;trend&quot;, K = 3, spec = &quot;longrun&quot;))</span></span>
<span id="cb40-19"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-20" tabindex="-1"></a><span class="co">#summary(ca.jo(LDatos, type = &quot;trace&quot;, ecdet = &quot;const&quot;, K = 3, spec = &quot;longrun&quot;))</span></span>
<span id="cb40-21"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-21" tabindex="-1"></a></span>
<span id="cb40-22"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-22" tabindex="-1"></a><span class="co">#summary(ca.jo(LDatos, type = &quot;trace&quot;, ecdet = &quot;none&quot;, K = 3, spec = &quot;longrun&quot;))</span></span>
<span id="cb40-23"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-23" tabindex="-1"></a></span>
<span id="cb40-24"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-24" tabindex="-1"></a>CA_1 <span class="ot">&lt;-</span> <span class="fu">ca.jo</span>(LDatos, <span class="at">type =</span> <span class="st">&quot;trace&quot;</span>, <span class="at">ecdet =</span> <span class="st">&quot;const&quot;</span>, <span class="at">K =</span> <span class="dv">3</span>, <span class="at">spec =</span> <span class="st">&quot;longrun&quot;</span>)</span>
<span id="cb40-25"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-25" tabindex="-1"></a></span>
<span id="cb40-26"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb40-26" tabindex="-1"></a><span class="fu">summary</span>(CA_1)</span></code></pre></div>
<pre><code>## 
## ###################### 
## # Johansen-Procedure # 
## ###################### 
## 
## Test type: trace statistic , without linear trend and constant in cointegration 
## 
## Eigenvalues (lambda):
## [1] 2.242278e-01 7.148297e-02 4.716974e-02 3.235583e-02 1.703739e-02
## [6] 3.730682e-17
## 
## Values of teststatistic and critical values of test:
## 
##            test 10pct  5pct  1pct
## r &lt;= 4 |   4.79  7.52  9.24 12.97
## r &lt;= 3 |  13.97 17.85 19.96 24.60
## r &lt;= 2 |  27.45 32.00 34.91 41.07
## r &lt;= 1 |  48.14 49.65 53.12 60.16
## r = 0  | 118.98 71.86 76.07 84.45
## 
## Eigenvectors, normalised to first column:
## (These are the cointegration relations)
## 
##              INPC_Ad.l3   TC_Ad.l3 CETE28_Ad.l3 IGAE_Ad.l3   IPI_Ad.l3
## INPC_Ad.l3    1.0000000  1.0000000    1.0000000   1.000000  1.00000000
## TC_Ad.l3      0.2100057  0.3958412    0.6038714  -3.946863 -0.66160415
## CETE28_Ad.l3  0.4812626 -0.3505729    0.2932620   1.025381  0.02134859
## IGAE_Ad.l3   -2.8386112 -4.9448228   -4.1431506  10.685831 -1.62038123
## IPI_Ad.l3    -1.2576912  0.8682351    2.2789480 -19.080015  1.60589077
## constant     14.2887887 13.2882018    1.6072247  43.673551 -2.75645487
##                 constant
## INPC_Ad.l3    1.00000000
## TC_Ad.l3     -0.84381863
## CETE28_Ad.l3  0.06866727
## IGAE_Ad.l3    1.32792512
## IPI_Ad.l3    -3.05544132
## constant      5.81151022
## 
## Weights W:
## (This is the loading matrix)
## 
##               INPC_Ad.l3      TC_Ad.l3  CETE28_Ad.l3    IGAE_Ad.l3
## INPC_Ad.d    0.001551917  4.896886e-05  0.0002254138 -0.0001685412
## TC_Ad.d      0.002200808 -5.756379e-03 -0.0293306746 -0.0003866727
## CETE28_Ad.d -0.009399815 -2.250446e-02 -0.0166361225 -0.0160384399
## IGAE_Ad.d    0.001105776  1.441007e-02  0.0023574644 -0.0015712694
## IPI_Ad.d     0.001442047  1.286402e-02 -0.0014986278 -0.0011379265
##                 IPI_Ad.l3      constant
## INPC_Ad.d   -0.0002093347 -4.428021e-15
## TC_Ad.d      0.0139760105  8.528589e-14
## CETE28_Ad.d -0.0111636433  8.242767e-14
## IGAE_Ad.d    0.0077903982 -9.344221e-14
## IPI_Ad.d    -0.0046051140 -6.463393e-14</code></pre>
<p>Considerando lo anterior, podemos determinar <span class="math inline">\(\hat{U}_t\)</span> para esta
ecuación de cointegración. En la Figura <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig84">5.12</a> mostramos los
residuales estimados. Derivado de la inspección visual, parecería que
estos no son estacionarios, condición que debería ser cierta. De esta
forma, una prueba deseable es aplicar todas las pruebas de raíces
unitarias a esta serie para mostrar que es I(0). En el Scrip llamado
Clase 18 en la carpeta de GoogleDrive se muestran algunas pruebas sobre
esta serie y se encuentra que es posible que no sea estacionaria.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-1" tabindex="-1"></a>TT <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">282</span>), </span>
<span id="cb42-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-2" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb42-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-3" tabindex="-1"></a>         <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-5" tabindex="-1"></a>U <span class="ot">&lt;-</span> LDatos[ , <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.2100057</span> <span class="sc">*</span>LDatos[ , <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.4812626</span><span class="sc">*</span>LDatos[ , <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">2.8386112</span><span class="sc">*</span>LDatos[ , <span class="dv">4</span>] <span class="sc">-</span> <span class="fl">1.2576912</span><span class="sc">*</span>LDatos[ , <span class="dv">5</span>] <span class="sc">+</span> <span class="fl">14.2887887</span></span>
<span id="cb42-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-8" tabindex="-1"></a></span>
<span id="cb42-9"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-9" tabindex="-1"></a><span class="fu">plot</span>(U, </span>
<span id="cb42-10"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-10" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Residuales de la Ecuación de Cointegración&quot;</span>,</span>
<span id="cb42-11"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-11" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb42-12"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb42-12" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig84"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig84-1.png" alt="Residuales estimados de la ecuación de cointegración" width="672" />
<p class="caption">
Figure 5.12: Residuales estimados de la ecuación de cointegración
</p>
</div>
</div>
</div>
<div id="modelos-adrl" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Modelos ADRL<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#modelos-adrl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="teoría" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Teoría<a href="#teor%C3%ADa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una vez que hemos analizado diversas técnicas de series de tiempo, el
problema consiste en seleccionar el modelo correcto. La Figura
<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#fig:fig91">5.13</a> muestra un esquema o diagrama de cómo podríamos
proceder para seleccionar el modelo correcto.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb43-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;Plots/TimeSeries_Models.png&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig91"></span>
<img src="Plots/TimeSeries_Models.png" alt="Method selection for time series data. OLS: Ordinary least squares; VAR: Vector autoregressive; ARDL: Autoregressive distributed lags; ECM: Error correction models, retomado de: Shrestha y Bhatta (2018)" width="95%" />
<p class="caption">
Figure 5.13: Method selection for time series data. OLS: Ordinary least squares; VAR: Vector autoregressive; ARDL: Autoregressive distributed lags; ECM: Error correction models, retomado de: Shrestha y Bhatta (2018)
</p>
</div>
<p>En este caso incorporaremos a los modelos autogregressive distributed
lag models (ARDL, por sus siglas en inglés). En estos casos el
procedimiento de Johansen no podría aplicarse directamennte cuando las
variables incluidas son de un orden mixto o cuando simplemente todas no
son estacionarias. Un modelo ARDL está basado en procedimientos de MCO.</p>
<p>Este tipo de modelos toma suficientes rezagos para capturar el mecanismo
generador de datos. También es posible llegar a una especificación del
mecanismo corrector de errores a partir de una trasformación lineal del
ARDL.</p>
<p>Consideremos la siguiente ecuación: <span class="math display">\[\begin{equation}
    Y_t = \alpha + \delta X_t + \gamma Z_t + U_t
    (\#eq:EqARDL)
\end{equation}\]</span></p>
<p>Dada la ecuación <a href="#eq:EqARDL">(<strong>??</strong>)</a> podemos establecer su forma de
mecanismo corrector de errores en forma ARDL dada por: <span class="math display">\[\begin{eqnarray*}
    \Delta Y_t &amp; = &amp; \alpha + \sum_{i = 1}^p \beta_i \Delta Y_{t-i} + \sum_{i = 1}^p \delta_i \Delta X_{t-i} + \sum_{i = 1}^p \gamma_i \Delta Z_{t-i} \\
    &amp;  &amp; + \lambda_1 Y_{t-1} + \lambda_2 X_{t-1} + \lambda_3 Z_{t-1} + U_t
\end{eqnarray*}\]</span></p>
<p>Donde los coeficientes <span class="math inline">\(\beta_i\)</span>, <span class="math inline">\(\delta_i\)</span>, <span class="math inline">\(\gamma_i\)</span> representan la
dinámica de corto plazo y las <span class="math inline">\(\lambda\)</span>’s la dinámica de largo plazo.</p>
<p>La hipótesis nula (<span class="math inline">\(H_0\)</span>) es que las
<span class="math inline">\(\lambda_1 + \lambda_2 + \lambda_3 = 0\)</span>, es decir, que no existe
relación de largo plazo.</p>
<p>En la práctica estimamos una especificación con rezafos distribuidos:
<span class="math display">\[\begin{equation}
    Y_t = \alpha + \sum_{i = 1}^p \beta_i Y_{t-i} + \sum_{i = 1}^p \delta_i X_{t-i} + \sum_{i = 1}^p \gamma_i Z_{t-i} + U_t
\end{equation}\]</span></p>
<p>Además de verificar si las series involucradas son estacionarias y
decidir el número de reagos <span class="math inline">\(p\)</span> mediante criterios de información.</p>
</div>
<div id="ejemplo" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Ejemplo<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#ejemplo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="descripción-del-problema" class="section level4 hasAnchor" number="5.6.2.1">
<h4><span class="header-section-number">5.6.2.1</span> DESCRIPCIÓN DEL PROBLEMA<a href="#descripci%C3%B3n-del-problema" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Supongamos que queremos modelar el logaritmo de dinero (M2) como una
función de LRY (logarithm of real income), IBO (bond rate) e IDE (bank
deposit rate).</p>
<ul>
<li><p>El problema es que la aplicación de una regresión de MCO en datos no
estacionarios daría lugar a una regresión espúria.</p></li>
<li><p>Los parámetros estimados serían consistentes solo si las series
estuvieran cointegradas.</p></li>
</ul>
</div>
<div id="importamos-datos-desde-un-dataset-de-r" class="section level4 hasAnchor" number="5.6.2.2">
<h4><span class="header-section-number">5.6.2.2</span> Importamos Datos desde un dataset de R:<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#importamos-datos-desde-un-dataset-de-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Utilizaremos un dataset integrado en la biblioteca ARDL de R. Se trata
de un dataframe con 55 renglones y 5 variables en el período de 1974:Q1
a 1987:Q3 de las siguientes variables:</p>
<p>LRM: logarithm of real money, M2</p>
<p>LRY: logarithm of real income</p>
<p>LPY: logarithm of price deflator</p>
<p>IBO: bond rate</p>
<p>IDE: bank deposit rate</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(zoo) </span>
<span id="cb44-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-2" tabindex="-1"></a><span class="fu">library</span>(xts) </span>
<span id="cb44-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-3" tabindex="-1"></a><span class="fu">library</span>(ARDL)</span>
<span id="cb44-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-4" tabindex="-1"></a></span>
<span id="cb44-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-6"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-6" tabindex="-1"></a><span class="fu">data</span>(denmark)</span>
<span id="cb44-7"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-7" tabindex="-1"></a></span>
<span id="cb44-8"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb44-8" tabindex="-1"></a><span class="fu">names</span>(denmark)</span></code></pre></div>
<pre><code>## [1] &quot;LRM&quot; &quot;LRY&quot; &quot;LPY&quot; &quot;IBO&quot; &quot;IDE&quot;</code></pre>
</div>
<div id="procedimiento" class="section level4 hasAnchor" number="5.6.2.3">
<h4><span class="header-section-number">5.6.2.3</span> Procedimiento:<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#procedimiento" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Calculamos un auto ADRL para determinar la combinación óptima de
rezagos.</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb46-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">auto_ardl</span>(LRM <span class="sc">~</span> LRY <span class="sc">+</span> IBO <span class="sc">+</span> IDE, <span class="at">data =</span> denmark, <span class="at">max_order =</span> <span class="dv">5</span>)</span>
<span id="cb46-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb46-2" tabindex="-1"></a></span>
<span id="cb46-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb46-3" tabindex="-1"></a><span class="fu">names</span>(models)</span></code></pre></div>
<pre><code>## [1] &quot;best_model&quot; &quot;best_order&quot; &quot;top_orders&quot;</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb48-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb48-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb48-2" tabindex="-1"></a>models<span class="sc">$</span>top_orders</span></code></pre></div>
<pre><code>##    LRM LRY IBO IDE       AIC
## 1    3   1   3   2 -251.0259
## 2    3   1   3   3 -250.1144
## 3    2   2   0   0 -249.6266
## 4    3   2   3   2 -249.1087
## 5    3   2   3   3 -248.1858
## 6    2   2   0   1 -247.7786
## 7    2   1   0   0 -247.5643
## 8    2   2   1   1 -246.6885
## 9    3   3   3   3 -246.3061
## 10   2   2   1   2 -246.2709
## 11   2   1   1   1 -245.8736
## 12   2   2   2   2 -245.7722
## 13   1   1   0   0 -245.6620
## 14   2   1   2   2 -245.1712
## 15   3   1   2   2 -245.0996
## 16   1   0   0   0 -244.4317
## 17   1   1   0   1 -243.7702
## 18   5   5   5   5 -243.3120
## 19   4   1   3   2 -243.0728
## 20   4   1   3   3 -242.4378</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb50-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb50-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb50-2" tabindex="-1"></a>models<span class="sc">$</span>best_order</span></code></pre></div>
<pre><code>## LRM LRY IBO IDE 
##   3   1   3   2</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb52-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb52-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb52-2" tabindex="-1"></a>models<span class="sc">$</span>best_model</span></code></pre></div>
<pre><code>## 
## Time series regression with &quot;zooreg&quot; data:
## Start = 1974 Q4, End = 1987 Q3
## 
## Call:
## dynlm::dynlm(formula = full_formula, data = data, start = start, 
##     end = end)
## 
## Coefficients:
## (Intercept)    L(LRM, 1)    L(LRM, 2)    L(LRM, 3)          LRY    L(LRY, 1)  
##      2.6202       0.3192       0.5326      -0.2687       0.6728      -0.2574  
##         IBO    L(IBO, 1)    L(IBO, 2)    L(IBO, 3)          IDE    L(IDE, 1)  
##     -1.0785      -0.1062       0.2877      -0.9947       0.1255      -0.3280  
##   L(IDE, 2)  
##      1.4079</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb54-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb54-2" tabindex="-1"></a>BestMod <span class="ot">&lt;-</span> models<span class="sc">$</span>best_model</span>
<span id="cb54-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb54-4" tabindex="-1"></a><span class="fu">summary</span>(BestMod)</span></code></pre></div>
<pre><code>## 
## Time series regression with &quot;zooreg&quot; data:
## Start = 1974 Q4, End = 1987 Q3
## 
## Call:
## dynlm::dynlm(formula = full_formula, data = data, start = start, 
##     end = end)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.029939 -0.008856 -0.002562  0.008190  0.072577 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.6202     0.5678   4.615 4.19e-05 ***
## L(LRM, 1)     0.3192     0.1367   2.336 0.024735 *  
## L(LRM, 2)     0.5326     0.1324   4.024 0.000255 ***
## L(LRM, 3)    -0.2687     0.1021  -2.631 0.012143 *  
## LRY           0.6728     0.1312   5.129 8.32e-06 ***
## L(LRY, 1)    -0.2574     0.1472  -1.749 0.088146 .  
## IBO          -1.0785     0.3217  -3.353 0.001790 ** 
## L(IBO, 1)    -0.1062     0.5858  -0.181 0.857081    
## L(IBO, 2)     0.2877     0.5691   0.505 0.616067    
## L(IBO, 3)    -0.9947     0.3925  -2.534 0.015401 *  
## IDE           0.1255     0.5545   0.226 0.822161    
## L(IDE, 1)    -0.3280     0.7213  -0.455 0.651847    
## L(IDE, 2)     1.4079     0.5520   2.550 0.014803 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0191 on 39 degrees of freedom
## Multiple R-squared:  0.988,  Adjusted R-squared:  0.9843 
## F-statistic: 266.8 on 12 and 39 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>UECM (Unrestricted Error Correction Model) of the underlying ARDL.</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb56-1" tabindex="-1"></a>UECM_BestMod <span class="ot">&lt;-</span> <span class="fu">uecm</span>(BestMod)</span>
<span id="cb56-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb56-3" tabindex="-1"></a><span class="fu">summary</span>(UECM_BestMod)</span></code></pre></div>
<pre><code>## 
## Time series regression with &quot;zooreg&quot; data:
## Start = 1974 Q4, End = 1987 Q3
## 
## Call:
## dynlm::dynlm(formula = full_formula, data = data, start = start, 
##     end = end)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.029939 -0.008856 -0.002562  0.008190  0.072577 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.62019    0.56777   4.615 4.19e-05 ***
## L(LRM, 1)    -0.41685    0.09166  -4.548 5.15e-05 ***
## L(LRY, 1)     0.41538    0.11761   3.532  0.00108 ** 
## L(IBO, 1)    -1.89172    0.39111  -4.837 2.09e-05 ***
## L(IDE, 1)     1.20534    0.44690   2.697  0.01028 *  
## d(L(LRM, 1)) -0.26394    0.10192  -2.590  0.01343 *  
## d(L(LRM, 2))  0.26867    0.10213   2.631  0.01214 *  
## d(LRY)        0.67280    0.13116   5.129 8.32e-06 ***
## d(IBO)       -1.07852    0.32170  -3.353  0.00179 ** 
## d(L(IBO, 1))  0.70701    0.46874   1.508  0.13953    
## d(L(IBO, 2))  0.99468    0.39251   2.534  0.01540 *  
## d(IDE)        0.12546    0.55445   0.226  0.82216    
## d(L(IDE, 1)) -1.40786    0.55204  -2.550  0.01480 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0191 on 39 degrees of freedom
## Multiple R-squared:  0.7458, Adjusted R-squared:  0.6676 
## F-statistic: 9.537 on 12 and 39 DF,  p-value: 3.001e-08</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>RECM (Restricted Error Correction Model) of the underlying ARDL Obs:
allowing the constant to join the short-run relationship (case 2),
instead of the long-run (case 3)</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb58-1" tabindex="-1"></a>RECM_BestMod <span class="ot">&lt;-</span> <span class="fu">recm</span>(UECM_BestMod, <span class="at">case =</span> <span class="dv">2</span>)</span>
<span id="cb58-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb58-3" tabindex="-1"></a><span class="fu">summary</span>(RECM_BestMod)</span></code></pre></div>
<pre><code>## 
## Time series regression with &quot;zooreg&quot; data:
## Start = 1974 Q4, End = 1987 Q3
## 
## Call:
## dynlm::dynlm(formula = full_formula, data = data, start = start, 
##     end = end)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.029939 -0.008856 -0.002562  0.008190  0.072577 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## d(L(LRM, 1)) -0.26394    0.09008  -2.930 0.005405 ** 
## d(L(LRM, 2))  0.26867    0.09127   2.944 0.005214 ** 
## d(LRY)        0.67280    0.11591   5.805 7.03e-07 ***
## d(IBO)       -1.07852    0.30025  -3.592 0.000837 ***
## d(L(IBO, 1))  0.70701    0.44359   1.594 0.118300    
## d(L(IBO, 2))  0.99468    0.36491   2.726 0.009242 ** 
## d(IDE)        0.12546    0.48290   0.260 0.796248    
## d(L(IDE, 1)) -1.40786    0.48867  -2.881 0.006160 ** 
## ect          -0.41685    0.07849  -5.311 3.63e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01819 on 43 degrees of freedom
##   (0 observations deleted due to missingness)
## Multiple R-squared:  0.7613, Adjusted R-squared:  0.7113 
## F-statistic: 15.24 on 9 and 43 DF,  p-value: 9.545e-11</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>long-run levels relationship (cointegration)</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb60-1" tabindex="-1"></a><span class="fu">bounds_f_test</span>(BestMod, <span class="at">case =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
##  Bounds F-test (Wald) for no cointegration
## 
## data:  d(LRM) ~ L(LRM, 1) + L(LRY, 1) + L(IBO, 1) + L(IDE, 1) + d(L(LRM,     1)) + d(L(LRM, 2)) + d(LRY) + d(IBO) + d(L(IBO, 1)) + d(L(IBO,     2)) + d(IDE) + d(L(IDE, 1))
## F = 5.1168, p-value = 0.004418
## alternative hypothesis: Possible cointegration
## null values:
##    k    T 
##    3 1000</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Long-run multipliers (with standard errors, t-statistics and
p-values)</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb62-1" tabindex="-1"></a><span class="fu">multipliers</span>(BestMod)</span></code></pre></div>
<pre><code>##          Term   Estimate Std. Error   t value     Pr(&gt;|t|)
## 1 (Intercept)  6.2856579  0.7719160  8.142930 6.107445e-10
## 2         LRY  0.9964676  0.1239310  8.040503 8.358472e-10
## 3         IBO -4.5381160  0.5202961 -8.722180 1.058619e-10
## 4         IDE  2.8915201  0.9950853  2.905801 6.009239e-03</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb64-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb64-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb64-2" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="fu">coint_eq</span>(BestMod, <span class="at">case =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="make-the-plot" class="section level4 hasAnchor" number="5.6.2.4">
<h4><span class="header-section-number">5.6.2.4</span> Make the plot<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#make-the-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb65-1" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">cbind.zoo</span>(<span class="at">LRM =</span> denmark[,<span class="st">&quot;LRM&quot;</span>], Result)</span>
<span id="cb65-2"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb65-2" tabindex="-1"></a></span>
<span id="cb65-3"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb65-3" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">xts</span>(Datos)</span>
<span id="cb65-4"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#cb65-5" tabindex="-1"></a><span class="fu">plot</span>(Datos, <span class="at">legend.loc =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig92"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig92-1.png" alt="Gráfica de la ecuación de cointegración" width="95%" />
<p class="caption">
Figure 5.14: Gráfica de la ecuación de cointegración
</p>
</div>
</div>
</div>
</div>
<div id="filtro-kalman" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Filtro Kalman<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#filtro-kalman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En secciones pasadas, entendimos la naturaleza del filtrado univariado como, por ejemplo, el <em>Filtro Hodrick-Prescott</em>. Este ha sido utilizado ampliamente en la literatura macroeconométrica, sobre todo para la estimación del Producto Potencial y, de este modo, la Brecha del Producto. Sin embargo, este método presenta dos limitaciones importantes: 1) es univariado, es decir, únicamente se explica por sí mismo y, 2) el llamado “problema de colas”, que sí bien entendimos que se puede solucionar aplicando la metodología de “colas pesadas”, la estimación del <span class="math inline">\(\lambda\)</span> es un tanto ambigua.</p>
<p>De este modo, el <strong>Filtro Kalman</strong> puede ser una alternativa viable y metodológicamente robusta, sobre todo si queremos trabajar con variables no observables como el <em>Producto Potencial</em> o, incluso, la <em>Tasa de interés neutral</em>, variable clave en la decisión de Política Monetaria de los Bancos Centrales.</p>
<p>En este sentido, el <strong>Filtro Kalman</strong> nació a partir del artículo seminal de Rudolf E. Kálmán (1960) <em>A New Approach to Linear Filtering and Prediction Problems</em>. La idea principal de Kálmán era describir los procesos estocásticos con un modelo de “estado” y resolver, de alguna manera, el problema de estimación con un ciclo <em>predicción-corrección</em> ejecutado en tiempo real. Así, el <strong>Filtro Kalman</strong> es un algoritmo de estimación recursivo a partir de mediciones ruidosas. De este modo, también podemos entender al <strong>Filtro Kalman</strong> como una especie de filtro multivariado. Sus aplicaciones no se han limitado únicamente a la Economía, pues ha sido utilizado para trabajos de la <em>NASA</em> como el pronóstico de la posición y velocidad del <em>Apollo 11</em> en 1969.</p>
<div id="modelos-estado-espacio-y-teoría-económica" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Modelos Estado-Espacio y Teoría Económica<a href="#modelos-estado-espacio-y-teor%C3%ADa-econ%C3%B3mica" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para hacer uso del <strong>Filtro Kalman</strong>, necesitamos de un modelo estructural que vincule a nuestras variables (observables y no observables), representado en la <em>Forma Estado-Espacio</em>. En general, casi todos los modelos de series de tiempo pueden ser representados como <em>Modelos Estado-Espacio</em>. El modelo estructural puede basarse en la teoría económica como, por ejemplo, un modelo DSGE. Para efectos prácticos, tomaremos como ejemplo el <em>Modelo de Proyección Trimestral (QPM)</em> del IMF (2020). No nos enfocaremos en el por qué y cómo del <em>Modelo QPM</em>, pues el objetivo principal es entender el <strong>Filtro Kalman</strong> y su aplicación.</p>
<div id="modelo-de-proyección-trimestral-qpm-del-imf-2020" class="section level4 hasAnchor" number="5.7.1.1">
<h4><span class="header-section-number">5.7.1.1</span> Modelo de Proyección Trimestral (QPM) del IMF (2020)<a href="#modelo-de-proyecci%C3%B3n-trimestral-qpm-del-imf-2020" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Supongamos una economía pequeña y abierta, en donde:</p>
<ul>
<li><p><strong>Demanda Agregada (Curva IS)</strong>
<span class="math display">\[\begin{equation}
\hat{y}_t = b_1 \hat{y}_{t-1} - b_2 mci_t + b_3 \hat{y}_t^* + \varepsilon_t^y
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
mci_t = b_4 \hat{r}_t + (1-b_4)(-\hat{z}_t)
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\hat{y}_t =\)</span> Brecha del Producto Doméstico,</p></li>
<li><p><span class="math inline">\(\hat{y}_{t-1} =\)</span> Brecha del Producto Doméstico rezagada,</p></li>
<li><p><span class="math inline">\(mci_t =\)</span> Índice de Condiciones Monetarias Real,</p></li>
<li><p><span class="math inline">\(\hat{y}_t^* =\)</span> Brecha del Producto Foráneo,</p></li>
<li><p><span class="math inline">\(\varepsilon_t^y =\)</span> Choque de Demanda,</p></li>
<li><p><span class="math inline">\(\hat{r}_t =\)</span> Brecha de la tasa de interés real y</p></li>
<li><p><span class="math inline">\(\hat{z}_t =\)</span> Brecha del tipo de cambio real.</p></li>
</ul></li>
<li><p><strong>Inflación (Curva de Phillips)</strong>
<span class="math display">\[\begin{equation}
\pi_t = a_1 \pi_{t-1} + (1-a_1) E\{\pi_{t+1}\} + a_2 rmc_t + \varepsilon_t^\pi
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
rmc_t = a_3 \hat{y}_t + (1-a_3) \hat{z}_t
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\pi_t =\)</span> Inflación,</p></li>
<li><p><span class="math inline">\(\pi_{t-1} =\)</span> Inflación rezagada,</p></li>
<li><p><span class="math inline">\(E\{\pi_{t+1}\} =\)</span> Expectativa de inflación,</p></li>
<li><p><span class="math inline">\(rmc_t =\)</span> Costo Marginal Real,</p></li>
<li><p><span class="math inline">\(\epsilon_t^\pi =\)</span> Choque de Oferta (cost-push shock),</p></li>
<li><p><span class="math inline">\(\hat{y}_t =\)</span> Brecha del Producto Doméstica y</p></li>
<li><p><span class="math inline">\(\hat{z}_t =\)</span> Brecha del tipo de cambio real.</p></li>
</ul></li>
<li><p><strong>Paridad Descubierta de Tasas de Interés (UIP)</strong>
<span class="math display">\[\begin{equation}
S_t = (1 - e_1) \mathbb{E}_t \{ S_{t+1} \} + e_1 \left[ S_{t-1} + \frac{2(\pi_t - \pi_t^{*} + \Delta \bar{z}_t)}{4} + \frac{i_t^{*} - i_t + prem_t}{4} \right] + \varepsilon_s
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(\mathbb{E}_t \{ S_{t+1}\} =\)</span> Expectativas sobre el tipo de cambio nominal futuro,</p></li>
<li><p><span class="math inline">\(S_{t-1} =\)</span> Tipo de cambio nominal rezagado,</p></li>
<li><p><span class="math inline">\(\pi_t =\)</span> Inflación,</p></li>
<li><p><span class="math inline">\(\pi_t^* =\)</span> Inflación foránea,</p></li>
<li><p><span class="math inline">\(\Delta \bar{z}_t =\)</span> Depreciación del tipo de cambio tendencial,</p></li>
<li><p><span class="math inline">\(i_t^* =\)</span> Tasa de interés real foránea,</p></li>
<li><p><span class="math inline">\(i_t =\)</span> Tasa de interés real doméstica,</p></li>
<li><p><span class="math inline">\(prem_t =\)</span> Premio Riesgo-País y</p></li>
<li><p><span class="math inline">\(\varepsilon_t =\)</span> Choque del Tipo de cambio.</p></li>
</ul></li>
<li><p><strong>Función de Reacción de Política Monetaria (Regla de Taylor)</strong>
<span class="math display">\[\begin{equation}
i_t = g_1 i_{t-1} + (1 - g_1) \left\{ i_t^n + g_2 \left( \mathbb{E}_t [\pi_{t+N}^4] - \pi_{t+N}^T \right) + g_3 \hat{y}_t \right\} + \varepsilon_t
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><p><span class="math inline">\(i_t =\)</span> Tasa de interés (o política),</p></li>
<li><p><span class="math inline">\(i_{t-1} =\)</span> Tasa de interés rezagada,</p></li>
<li><p><span class="math inline">\(i_t^n =\)</span> Tasa de interés natural o neutral,</p></li>
<li><p><span class="math inline">\(\mathbb{E}_t [\pi_{t+N}^4] =\)</span> Inflación esperada (YoY) en el periodo <span class="math inline">\(_{t+N}\)</span>,</p></li>
<li><p><span class="math inline">\(\pi_{t+N}^T =\)</span> Meta de inflación,</p></li>
<li><p><span class="math inline">\(\hat{y}_t =\)</span> Brecha del Producto Doméstica y</p></li>
<li><p><span class="math inline">\(\varepsilon_t =\)</span> Choque de política monetaria no sistémico.</p></li>
</ul></li>
<li><p><strong>Bloque externo</strong></p></li>
</ul>
<p>En este caso, todas las variables siguen procesos autorregresivos simples</p>
<span class="math display">\[\begin{array}{ll}
\textbf{Brecha del Producto Foránea} &amp; \textbf{Tasa natural (tendencia) de intéres real foránea} \\
\hat{y}^*_t = \rho_y \hat{y}^*_{t-1} + \varepsilon^{\hat{y}^*}_t
&amp; \tilde{r}^*_t = \rho_{\tilde{r}} \tilde{r}^*_{t-1} + (1 - \rho_{\tilde{r}}) \tilde{r}^{*SS} + \varepsilon^{\tilde{r}^*}_t \\[1.5ex]

\textbf{Tasa de interés nominal foránea} &amp; \textbf{Brecha de la Tasa de interés real foránea} \\
i^*_t = \rho_i i^*_{t-1} + (1 - \rho_i)(r^*_t + \pi^*_t) + \varepsilon^{i^*}_t
&amp; \hat{r}^*_t = r^*_t - \tilde{r}^*_t \\[1.5ex]

\textbf{Tasa de interés real foránea} &amp; \textbf{Inflación foránea} \\
r^*_t = i^*_t - \pi^*_t
&amp; \pi^*_t = \rho_\pi \pi^*_{t-1} + (1 - \rho_\pi)\pi^{*SS} + \varepsilon^{\pi^*}_t
\end{array}\]</span>
</div>
<div id="modelos-estado-espacio" class="section level4 hasAnchor" number="5.7.1.2">
<h4><span class="header-section-number">5.7.1.2</span> Modelos Estado-Espacio<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#modelos-estado-espacio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La idea general detrás de los <em>Modelos Estado-Espacio</em> es que una (múltiples) variable observable <span class="math inline">\(Y_1,...Y_T\)</span> depende de un posible estado no observable <span class="math inline">\(X_t\)</span> que sigue un proceso estocástico. La relación entre <span class="math inline">\(Y_t\)</span> y <span class="math inline">\(X_t\)</span> es descrita por la <strong>Ecuación de Observación</strong></p>
<p><span class="math display" id="eq:Obs">\[\begin{equation}
Y_t = C X_T + v_t
\tag{5.4}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(C\)</span> es una matriz de parámetros conocidos y <span class="math inline">\(v_t\)</span> es un vector de errores observados (si los hay), los cuales son independientes e idénticamente distribuidos con media cero y matriz de covarianza <span class="math inline">\(R\)</span>, es decir, <span class="math inline">\(v_t \sim iid(0, R)\)</span>. De este modo, la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Obs">(5.4)</a> describe la relación estática entre las variables observables y no observables.</p>
<p>La ecuación que describe la dinámica de las variables de estado, también conocida como <strong>Ecuación de Transición</strong>, es definida como</p>
<p><span class="math display" id="eq:Tra">\[\begin{equation}
X_t = A X_{t-1} + \varepsilon_t,
\tag{5.5}
\end{equation}\]</span></p>
<p>en donde <span class="math inline">\(A\)</span> es una matriz de parámetros conocidos, <span class="math inline">\(\varepsilon_t\)</span> es un vector de errores, los cuales son independientes e idénticamente distribuidos con media cero y matriz de covarianza <span class="math inline">\(Q\)</span>, es decir, <span class="math inline">\(\varepsilon_t \sim iid(0,Q)\)</span>. Adicionalmente, se asume que <span class="math inline">\(v_t\)</span> y <span class="math inline">\(\varepsilon_t\)</span> son independientes entre sí, es decir, <span class="math inline">\(Cov(v_t,\varepsilon_t) = 0\)</span>.</p>
<p>En la <em>Figura 5.15</em> se puede observar un ejemplo de la relación de las variables en los <em>Modelos Estado-Espacio</em> en el <em>QPM</em> básico del IMF (2020).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="Plots/StateSpace.png" alt="State-space models. Recuperado de IMF (2020)." width="60%" />
<p class="caption">
Figure 5.15: State-space models. Recuperado de IMF (2020).
</p>
</div>
<p>Afortunadamente, nuestro <em>Modelo QPM</em> está construido de tal manera que tenemos <strong>ecuaciones de transición</strong> y <strong>observación</strong> que vinculan las variables observables con las no observables:</p>
<pre><code>% ======================================
% Basic Quarterly Projection Model (QPM)
% ======================================

!transition_variables
&#39;Real GDP (100*log)&#39;                                               L_GDP
&#39;Trend in Real GDP (100*log)&#39;                                      L_GDP_BAR
&#39;Output Gap (in %)&#39;                                                L_GDP_GAP
&#39;Quarterly Growth in Real GDP(in % pa)&#39;                            DLA_GDP
&#39;Real GDP Growth YoY (in % pa)&#39;                                    D4L_GDP
&#39;Real GDP Trend Growth QoQ annualized (in % pa)&#39;                   DLA_GDP_BAR

&#39;Real Monetary Condition Index (in % pa)&#39;                          MCI

&#39;CPI (level, 100*log)&#39;                                             L_CPI
&#39;CPI Inflation QoQ annualized (in % pa)&#39;                           DLA_CPI
&#39;Expected CPI Inflation QoQ annualized (in % pa)&#39;                  E_DLA_CPI
&#39;CPI Inflation YoY (in % pa)&#39;                                      D4L_CPI
&#39;Inflation Target (in % pa)&#39;                                       D4L_CPI_TAR

&#39;Real Marginal Cost  (in %)&#39;                                       RMC

&#39;Nominal Exchange Rate (LCY/FCY, 100*log)&#39;                         L_S
&#39;Nominal Exch. Rate Depreciation QoQ annualized (in % pa)&#39;         DLA_S
&#39;Nominal Exch. Rate Depreciation YoY (in % pa)&#39;                    D4L_S
&#39;Country Risk Premium (in % pa)&#39;                                   PREM

&#39;Nominal Policy Interest Rate (in % pa)&#39;                           RS
&#39;Real Interest Rate (in % pa)&#39;                                     RR
&#39;Trend Real Interest Rate (in % pa)&#39;                               RR_BAR
&#39;Real Interest Rate Gap (in %)&#39;                                    RR_GAP
&#39;Nominal Policy Neutral Interest Rate (in % pa)&#39;                   RSNEUTRAL

&#39;Real Exchange Rate (level, 100*log)&#39;                              L_Z
&#39;Trend Real Exchange Rate (level, 100*log)&#39;                        L_Z_BAR
&#39;Real Exchange Rate Gap (in %)&#39;                                    L_Z_GAP
&#39;Real Exchange Rate Depreciation QoQ annualized (in % pa)&#39;         DLA_Z
&#39;Trend Real Exchange Rate Depreciation QoQ annualized(in % pa)&#39;    DLA_Z_BAR

&#39;Foreign Output Gap (in %)&#39;                                        L_GDP_RW_GAP
&#39;Foreign Nominal Interest Rate (in % pa)&#39;                          RS_RW
&#39;Foreign Real Interest Rate (in % pa)&#39;                             RR_RW 
&#39;Foreign Real Interest Rate Trend (in % pa)&#39;                       RR_RW_BAR
&#39;Foreign Real Interest Rate Gap (in %)&#39;                            RR_RW_GAP
&#39;Foreign CPI (level, 100*log)&#39;                                     L_CPI_RW
&#39;Foreign Inflation QoQ annualized (in % pa)&#39;                       DLA_CPI_RW

% ------------------------------------------------------------------------------- %
!transition_shocks
&#39;Shock: Output gap (demand)&#39;                                       SHK_L_GDP_GAP
&#39;Shock: CPI inflation (cost-push)&#39;                                 SHK_DLA_CPI 
&#39;Shock: Exchange rate (UIP)&#39;                                       SHK_L_S 
&#39;Shock: Interest rate (monetary policy)&#39;                           SHK_RS 
&#39;Shock: Inflation target&#39;                                          SHK_D4L_CPI_TAR

&#39;Shock: Real interest rate&#39;                                        SHK_RR_BAR 
&#39;Shock: Real exchange rate depreciation&#39;                           SHK_DLA_Z_BAR 
&#39;Shock: Potential GDP growth&#39;                                      SHK_DLA_GDP_BAR

&#39;Shock: Foreign output gap&#39;                                        SHK_L_GDP_RW_GAP 
&#39;Shock: Foreign nominal interest rate&#39;                             SHK_RS_RW 
&#39;Shock: Foreign inflation&#39;                                         SHK_DLA_CPI_RW 
&#39;Shock: Foreign real interest rate&#39;                                SHK_RR_RW_BAR

% ------------------------------------------------------------------------------- %
!parameters
b1 b2 b3 b4
a1 a2 a3
e1
g1 g2 g3

rho_D4L_CPI_TAR
rho_DLA_Z_BAR 
rho_RR_BAR
rho_DLA_GDP_BAR
 
rho_L_GDP_RW_GAP
rho_RS_RW 
rho_DLA_CPI_RW
rho_RR_RW_BAR

ss_D4L_CPI_TAR
ss_DLA_Z_BAR
ss_RR_BAR 
ss_DLA_GDP_BAR

ss_DLA_CPI_RW 
ss_RR_RW_BAR

%% ------------------------------------------------------------------------------- %
!transition_equations
%% === Aggregate demand (the IS curve) ===
L_GDP_GAP = b1*L_GDP_GAP{-1} - b2*MCI + b3*L_GDP_RW_GAP + SHK_L_GDP_GAP;

%-- Real monetary conditions index
MCI = b4*RR_GAP + (1-b4)*(- L_Z_GAP);

%% === Inflation (the Phillips curve) ===
DLA_CPI =  a1*DLA_CPI{-1} + (1-a1)*DLA_CPI{+1} + a2*RMC + SHK_DLA_CPI;

%-- Real marginal cost
RMC = a3*L_GDP_GAP + (1-a3)*L_Z_GAP;

%- expected inflation
E_DLA_CPI = DLA_CPI{+1};

%% === Monetary policy reaction function (a forward-looking Taylor-type Rule) ===
RS = g1*RS{-1} + (1-g1)*(RSNEUTRAL + g2*(D4L_CPI{+4} - D4L_CPI_TAR{+4}) + g3*L_GDP_GAP) + SHK_RS;

%- Neutral nominal policy interest rate
RSNEUTRAL = RR_BAR + D4L_CPI{+1};

%% === Modified Uncovered Interest Rate Parity (UIP) condition ===
L_S = (1-e1)*L_S{+1} + e1*(L_S{-1} + 2/4*(D4L_CPI_TAR - ss_DLA_CPI_RW + DLA_Z_BAR)) + (- RS + RS_RW + PREM)/4 + SHK_L_S;

%% === Definitions ===

%- Fisher equation (RIR)
RR = RS - D4L_CPI{+1};

%- Real exchange rate (RER)
L_Z = L_S + L_CPI_RW - L_CPI;

%- Long-term version of UIP (consistency of trends)
DLA_Z_BAR{+1} = RR_BAR - RR_RW_BAR - PREM;

%% === Identities ===
DLA_GDP_BAR = 4*(L_GDP_BAR - L_GDP_BAR{-1});
DLA_Z_BAR   = 4*(L_Z_BAR - L_Z_BAR{-1});
DLA_Z       = 4*(L_Z - L_Z{-1});
DLA_GDP     = 4*(L_GDP - L_GDP{-1});
DLA_CPI     = 4*(L_CPI - L_CPI{-1});
DLA_S       = 4*(L_S - L_S{-1});

D4L_GDP     = L_GDP - L_GDP{-4};
D4L_CPI     = L_CPI - L_CPI{-4};
D4L_S       = L_S - L_S{-4};

%% === Gaps ===
RR_GAP    = RR - RR_BAR;
L_Z_GAP   = L_Z - L_Z_BAR;
L_GDP_GAP = L_GDP - L_GDP_BAR;

%% === Trends ===
D4L_CPI_TAR = rho_D4L_CPI_TAR*D4L_CPI_TAR{-1} + (1-rho_D4L_CPI_TAR)*ss_D4L_CPI_TAR + SHK_D4L_CPI_TAR;
DLA_Z_BAR   = rho_DLA_Z_BAR*DLA_Z_BAR{-1} + (1-rho_DLA_Z_BAR)*ss_DLA_Z_BAR + SHK_DLA_Z_BAR;
RR_BAR      = rho_RR_BAR*RR_BAR{-1} + (1-rho_RR_BAR)*ss_RR_BAR + SHK_RR_BAR;
DLA_GDP_BAR = rho_DLA_GDP_BAR*DLA_GDP_BAR{-1} + (1-rho_DLA_GDP_BAR)*ss_DLA_GDP_BAR + SHK_DLA_GDP_BAR;

%% === Foreign Sector Equations ===
L_GDP_RW_GAP = rho_L_GDP_RW_GAP*L_GDP_RW_GAP{-1} + SHK_L_GDP_RW_GAP;
DLA_CPI_RW   = rho_DLA_CPI_RW*DLA_CPI_RW{-1} + (1-rho_DLA_CPI_RW)*ss_DLA_CPI_RW + SHK_DLA_CPI_RW;
RS_RW        = rho_RS_RW*RS_RW{-1} + (1-rho_RS_RW)*(RR_RW_BAR + DLA_CPI_RW) + SHK_RS_RW;
RR_RW_BAR    = rho_RR_RW_BAR*RR_RW_BAR{-1} + (1-rho_RR_RW_BAR)*ss_RR_RW_BAR + SHK_RR_RW_BAR;
RR_RW        = RS_RW - DLA_CPI_RW;
RR_RW_GAP    = RR_RW - RR_RW_BAR;

DLA_CPI_RW   = 4*(L_CPI_RW - L_CPI_RW{-1});

%% ------------------------------------------------------------------------------- %
!measurement_variables
OBS_L_GDP
OBS_L_CPI
OBS_RS
OBS_L_S
OBS_D4L_CPI_TAR

OBS_L_GDP_RW_GAP
OBS_DLA_CPI_RW 
OBS_RS_RW

!measurement_equations
OBS_L_GDP = L_GDP;
OBS_L_CPI = L_CPI;
OBS_RS    = RS;
OBS_L_S   = L_S;
OBS_D4L_CPI_TAR = D4L_CPI_TAR;

OBS_L_GDP_RW_GAP = L_GDP_RW_GAP;
OBS_DLA_CPI_RW   = DLA_CPI_RW;
OBS_RS_RW        = RS_RW;

%% ------------------------------------------------------------------------------- %
Legend
_GAP        cyclical deviation from a trend
_BAR        trend (equilibrium)
ss_         steady-state value  
DLA_        q-o-q change
D4L_        y-o-y change  
_RW         foreign variable
SHK_        equation residual
</code></pre>
<p>Sin embargo, la <strong>Ecuación de Transición</strong> de los estados presentes dependen de los estados pasados, mientras que el <em>Modelo QPM</em> es prospectivo, es decir, las variables dependen de sus expectativas así que la ecuación toma la forma de</p>
<p><span class="math display" id="eq:Pros">\[\begin{equation}
F \mathbb{E}_t[X_{t+1}] + G X_t + H X_{t-1} + M \eta_t = 0
\tag{5.6}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(F\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(H\)</span>, <span class="math inline">\(M\)</span> son matrices de parámetros estructurales conocidos, <span class="math inline">\(\mathbb{E}_t\)</span> es el operador de expectativas y <span class="math inline">\(\eta_t\)</span> es un vector de choques estructurales. Para pasar de este modelo a la <em>Forma Estado-Espacio</em>, tenemos que resolver para <em>Expectativas Racionales</em>. Para esto, proponemos una <em>hipótesis de solución</em></p>
<p><span class="math display" id="eq:Hip">\[\begin{equation}
X_t = A X_{t-1} + P \eta_t
\quad \text{con} \quad
\varepsilon_t \equiv P \eta_t
\tag{5.7}
\end{equation}\]</span></p>
<p>Ahora, suponemos que <span class="math inline">\(\eta_t\)</span> sigue un proceso autorregresivo, es decir, tiene su propia dinámica:</p>
<p><span class="math display">\[\begin{equation}
\eta_{t+1} = S \eta_t + \gamma_{t+1}
\quad \text{donde} \quad
\gamma_{t+1} \sim iid(0,W)
\end{equation}\]</span></p>
<p>Así, sabemos que</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}_t[X_{t+1}] = A X_t + P \mathbb{E}_t[\eta_{t+1}] = A (A X_{t-1} + P \eta_t) + P S \eta_t
\end{equation}\]</span></p>
<p>De este modo, si sustituimos la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Hip">(5.7)</a> en la <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Pros">(5.6)</a>, tenemos que las matrices deben de satisfacer la identidad</p>
<p><span class="math display" id="eq:Iden">\[\begin{equation}
F [A (A X_{t-1} + P \eta_t) + P (S \eta_t)] + G [A X_{t-1} + P \eta_t] + H X_{t-1} + M \eta_t = 0
\tag{5.8}
\end{equation}\]</span></p>
<p>para todos los valores <span class="math inline">\(X_{t-1}\)</span> y <span class="math inline">\(\eta_t\)</span>, de tal modo que <span class="math inline">\(A\)</span> y <span class="math inline">\(P\)</span> son las soluciones de ecuaciones</p>
<p><span class="math display" id="eq:Sol">\[\begin{equation}
F A^2 + G A + H = 0,
\quad \quad
F A P + F P S + G P + M = 0
\tag{5.9}
\end{equation}\]</span></p>
<p>De esta forma, obtenemos nuestro modelo en la <em>Forma Estado-Espacio</em>.</p>
</div>
</div>
<div id="recursión-del-filtro-kalman" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Recursión del Filtro Kalman<a href="#recursi%C3%B3n-del-filtro-kalman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ya que tenemos nuestro modelo en la <em>Forma Estado-Espacio</em> como se muestra en las ecuaciones <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Obs">(5.4)</a> y <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Tra">(5.5)</a>, podemos hacer uso del <strong>Filtro Kalman</strong>.</p>
<p>Para comenzar, definamos <span class="math inline">\(Y_{t/t-1}\)</span> y <span class="math inline">\(X_{t/t-1}\)</span> como los valores predichos de <span class="math inline">\(Y_t\)</span> y <span class="math inline">\(X_t\)</span>, respectivamente, condicionado a la información del periodo <span class="math inline">\(_{t-1}\)</span>. Además, definamos <span class="math inline">\(X_{t/t}\)</span> como la estimación de <span class="math inline">\(X_t\)</span> condicionada a la información del periodo <span class="math inline">\(_t\)</span>.</p>
<p>Como se mencionó en un inicio, el <strong>Filtro Kalman</strong> utiliza un algoritmo recursivo para cada periodo <span class="math inline">\(1,2,...,T\)</span>. Cada recursión está compuesta de dos pasos. Supongamos que tenemos los datos observados y las estimaciones del estado para el periodo <span class="math inline">\(_{t-1}\)</span>, es decir, conocemos <span class="math inline">\(Y_{t-1}\)</span> y <span class="math inline">\(X_{t-1/t-1}\)</span>. De este modo, para el periodo <span class="math inline">\(_t\)</span>:</p>
<ul>
<li><strong>Paso 1.</strong> Predicción del estado y observación de las variables en el periodo <span class="math inline">\(_t\)</span> dada la información de <span class="math inline">\(_{t-1}\)</span>. Como no tenemos nueva información, el promedio de la predicción se basa en el <em>Modelo Estado-Espacio</em> <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Obs">(5.4)</a> - <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Tra">(5.5)</a>:</li>
</ul>
<p><span class="math display" id="eq:Xt">\[\begin{equation}
X_{t/t-1} = A X_{t-1/t-1}
\tag{5.10}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Yt">\[\begin{equation}
Y_{t/t-1} = C X_{t/t-1}
\tag{5.11}
\end{equation}\]</span></p>
<ul>
<li><strong>Paso 2.</strong> Actualización de la estimación del estado dada la información en el periodo <span class="math inline">\(_t\)</span>. Una vez que conocemos la nueva información del periodo <span class="math inline">\(_t\)</span>, existirá una discrepancia entre la información actual (<span class="math inline">\(Y_t\)</span>) y la predicción del modelo (<span class="math inline">\(Y_{t/t-1}\)</span>). El <strong>Filtro Kalman</strong> utiliza dicha discrepancia para actualizar la estimación de los estados no observables utilizando la matriz <span class="math inline">\(K_t\)</span>, que se llama <strong>Ganancia de Kalman</strong>:</li>
</ul>
<p><span class="math display" id="eq:Xt1">\[\begin{equation}
X_{t/t} = X_{t/t-1} + K_t (Y_t - Y_{t/t-1})
\tag{5.12}
\end{equation}\]</span></p>
</div>
<div id="ganancia-de-kalman" class="section level3 hasAnchor" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Ganancia de Kalman<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#ganancia-de-kalman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Supongamos que los errores siguen una distribución normal, es decir, <span class="math inline">\(v_t \sim N(0,R), \varepsilon_t \sim N(0,Q)\)</span>.</p>
<p>Para la primera estimación (Paso 1) de la <em>Recursión de Kalman</em>, <span class="math inline">\(P_{t/t-1}\)</span> denota la varianza del error de predicción de las variables de estado (<span class="math inline">\(X_t\)</span>) dada la información del periodo <span class="math inline">\(_{t-1}\)</span>, o sea, <span class="math inline">\(P_{t/t-1} = Var_{t-1}[(X_t - X_{t/t-1})]\)</span>. De manera similar, <span class="math inline">\(F_{t/t-1}\)</span> es la varianza del error de predicción de las variables observables (<span class="math inline">\(Y_t\)</span>) dada la información del periodo <span class="math inline">\(_{t-1}\)</span>, o bien, <span class="math inline">\(F_{t/t-1} = Var_{t-1}[(Y_t - Y_{t/t-1})]\)</span>.</p>
<p>Para la actualización (Paso 2) de la <em>Recursión de Kalman</em>, <span class="math inline">\(P_{t/t}\)</span> denota la varianza del error de las variables de estado (<span class="math inline">\(X_t\)</span>) dada la información del periodo <span class="math inline">\(_t\)</span>, es decir, <span class="math inline">\(P_{t/t} = Var_t[(X_t - X_{t/t})]\)</span>.</p>
<p>Así, la distribución multivariada del vector <span class="math inline">\((Y_t,X_t)\)</span> toma la forma</p>
<p><span class="math display" id="eq:Mat">\[\begin{equation}
\begin{pmatrix}
Y_t \\ X_t
\end{pmatrix}
\Bigg|
Y_t,...,Y_{t-1} \sim N
\Bigg(\begin{pmatrix}
Y_{t/t-1} \\ X_{t/t-1}
\end{pmatrix},
\begin{pmatrix}
F_{t/t-1} &amp; C P_{t/t-1} \\
P_{t/t-1} C&#39; &amp; P_{t/t-1}
\end{pmatrix}\Bigg).
\tag{5.13}
\end{equation}\]</span></p>
<p>De <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Mat">(5.13)</a>, la distribución condicional de <span class="math inline">\(X_t\)</span> dado <span class="math inline">\(Y_t\)</span> toma la forma de</p>
<p><span class="math display" id="eq:Xt2">\[\begin{equation}
X_t \mid Y_t, Y_1, ... , Y_{t-1} \sim N
\begin{aligned}
( &amp; X_{t|t-1} + P_{t|t-1} C&#39; F_{t|t-1} {}^{-1} [Y_t - Y_{t|t-1}], \\
&amp; P_{t|t-1} - P_{t|t-1} C&#39; F_{t|t-1} {}^{-1} C P_{t|t-1} )
\end{aligned}
\tag{5.14}
\end{equation}\]</span></p>
<p>Y de la ecuación <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Xt2">(5.14)</a> obtenemos directamente que</p>
<p><span class="math display" id="eq:Xt3">\[\begin{equation}
X_{t|t} = X_{t|t-1} + P_{t|t-1} C&#39; F_{t|t-1} {}^{-1} \left[ Y_t - Y_{t|t-1} \right] = X_{t|t-1} + K_t \left[ Y_t - Y_{t|t-1} \right],
\tag{5.15}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Pt">\[\begin{equation}
P_{t|t} = P_{t|t-1} - P_{t|t-1} C&#39; F_{t|t-1} {}^{-1} C P_{t|t-1} = (I - K_t C) P_{t|t-1},
\tag{5.16}
\end{equation}\]</span></p>
<p>en donde la <strong>Ganancia de Kalman</strong> es</p>
<p><span class="math display" id="eq:Kt">\[\begin{equation}
K_t = P_{t/t-1} C&#39; F_{t/t-1} {}^{-1}.
\tag{5.17}
\end{equation}\]</span></p>
<p>Notese que <span class="math inline">\(F_{t/t-1}\)</span> sigue:</p>
<p><span class="math display">\[\begin{equation}
F_{t|t-1} = Var_{t-1} \left[( Y_t - Y_{t|t-1} \right)] = Var_{t-1} \left[( C X_t + v_t - C X_{t|t-1} \right)] = C P_{t|t-1} C&#39; + R
\end{equation}\]</span></p>
<p>Por el contrario, <span class="math inline">\(P_{t/t-1}\)</span> sigue:</p>
<p><span class="math display">\[\begin{align}
P_{t|t-1} &amp;= Var_{t-1} \left[( X_t - X_{t|t-1} \right)]
\\ &amp;= Var_{t-1} \left[( A X_{t-1} + \varepsilon_t - A X_{t-1|t-1} \right)]
\\ &amp;= A P_{t-1|t-1} A&#39; + Q
\\ &amp;= A (I - K_{t-1} C) P_{t-1|t-2} A&#39; + Q
\end{align}\]</span></p>
<p>Y si sustituimos <span class="math inline">\(F_{t/t-1}\)</span> y <span class="math inline">\(P_{t/t-1}\)</span> en las ecuaciones <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Xt3">(5.15)</a> - <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Kt">(5.17)</a>, obtenemos las siguientes ecuaciones para el algoritmo del <strong>Filtro Kalman</strong></p>
<p><span class="math display" id="eq:Kt1">\[\begin{equation}
K_t = P_{t/t-1} C&#39; (C P_{t/t-1} C&#39; + R)^{-1}
\tag{5.18}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Xt4">\[\begin{equation}
X_{t/t} = X_{t/t-1} + K_t [Y_t - Y_{t/t-1}]
\tag{5.19}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Pt1">\[\begin{equation}
P_{t+1|t} = A (I - K_t C) P_{t/t-1} A&#39; + Q
\tag{5.20}
\end{equation}\]</span></p>
<p>De este modo, la <strong>Ganancia de Kalman</strong> en <a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#eq:Kt1">(5.18)</a> depende de manera positiva de la varianza del error de predicción del estado (<span class="math inline">\(P_{t/t-1}\)</span>) y de manera negativa de la varianza de la ecuación de observación <span class="math inline">\(R\)</span>. Esto es bastante intuitivo:</p>
<ul>
<li><p>Si existen grandes errores en las predicciones del estado <span class="math inline">\(X_{t/t-1}\)</span> en el Paso 1 de la <em>Recursión de Kalman</em>, es decir, <span class="math inline">\(P_{t/t-1}\)</span> es grande, se le da más peso a la nueva información observada <span class="math inline">\(Y_t\)</span>, lo cual significa que la <strong>Ganancia de Kalman</strong> es grande. En particular, esto es cierto para las ecuaciones de transición que no se cumplen de manera estricta, es decir, <span class="math inline">\(Q\)</span> es grande;</p></li>
<li><p>Si la información es ruidosa, o sea, <span class="math inline">\(R\)</span> es grande, se le da menos peso a la información nueva por lo que <span class="math inline">\(K_t\)</span> es pequeño.</p></li>
</ul>
</div>
<div id="algoritmo-del-filtro-kalman-y-del-suavizador-de-kalman" class="section level3 hasAnchor" number="5.7.4">
<h3><span class="header-section-number">5.7.4</span> Algoritmo del Filtro Kalman y del Suavizador de Kalman<a href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegración-modelos-ardl-y-filtro-multivariado.html#algoritmo-del-filtro-kalman-y-del-suavizador-de-kalman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ya que encontramos las expresiones más relevantes, podemos combinar todas para entender cómo funciona el <strong>Filtro Kalman</strong>.</p>
<p>Sabemos que el filtro es recursivo. De este modo, para poder correrlo necesitamos <em>condiciones iniciales</em> para todos los estados al principio de la muestra (<span class="math inline">\(X_{0|0}\)</span>), al igual que para la varianza del error de predicción del estado (<span class="math inline">\(P_{0|0}\)</span>). Para muestras pequeñas, las <em>condiciones iniciales</em> pueden afectar significativamente los resultados del filtro. Si no tenemos información previa, una opción es asumir que las <em>condiciones iniciales</em> de los estados y de la varianza del error de predicción no están lejos de sus valores en estado estacionario. En particular, para modelos estacionarios, se puede establecer que las <em>condiciones iniciales</em> son iguales a los valores en estado estacionario.</p>
<p>Ahora, ya que hemos asignado las <em>condiciones iniciales</em>, el <strong>Filtro Kalman</strong> corre el algortimo recursivo para cada periodo de tiempo <span class="math inline">\(1,2,...,T\)</span>. Cada recursión está compuesta de dos pasos:</p>
<ul>
<li><strong>Paso 1.</strong> Predicción utilizando el <em>Modelo Estado-Espacio</em>:</li>
</ul>
<p><span class="math display" id="eq:P1">\[\begin{equation}
X_{t/t-1} = A X_{t-1/t-1},
\tag{5.21}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:P2">\[\begin{equation}
Y_{t/t-1} = C X_{t/t-1}.
\tag{5.22}
\end{equation}\]</span></p>
<ul>
<li><strong>Paso 2.</strong> Actualización utilzando la información:</li>
</ul>
<p><span class="math display" id="eq:A1">\[\begin{equation}
K_t = P_{t/t-1} C&#39; (C P_{t/t-1} C&#39; + R)^{-1},
\tag{5.23}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:A2">\[\begin{equation}
X_{t/t} = X_{t/t-1} + K_t [Y_t - Y_{t/t-1}],
\tag{5.24}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:A3">\[\begin{equation}
P_{t+1/t} = A (I - K_t C) P_{t/t-1} A&#39; + Q.
\tag{5.25}
\end{equation}\]</span></p>
<p>El <strong>Filtro Kalman</strong> nos proporciona el estimador lineal óptimo de mínimos cuadrados del estado, dada la información hasta el periodo <span class="math inline">\(_t\)</span>. Si los errores están distribuidos normalmente, es óptimo entre todos los estimadores de <span class="math inline">\(X_t\)</span> condicionados a la información disponible hasta ese periodo.</p>
<p>Para cada periodo <span class="math inline">\(_t\)</span>, el <strong>Filtro Kalman</strong> utiliza únicamente la información disponible hasta ese periodo para estimar <span class="math inline">\(X_t\)</span>. Dichas estimaciones se encuentran en <span class="math inline">\(X_{t/t-1}\)</span> (del Paso 1) y en <span class="math inline">\(X_{t/t}\)</span> (del Paso 2). Sin embargo, para estimar <span class="math inline">\(X_t\)</span>, comúnmente es deseable utilizar toda la información disponible, hasta el último periodo <span class="math inline">\(T\)</span>. Es decir, podría ser deseable obtener estimaciones <span class="math inline">\(X_{t/T}\)</span>, que se conocen como <strong>estimaciones suavizadas</strong> de los estados. Precisamente eso es lo que hace el <strong>Suavizador de Kalman (Kalman smoother)</strong>.</p>
<p>Para correr el <strong>Suavizador de Kalman</strong>, necesitamos primero correr el <strong>Filtro Kalman</strong> y obtener todas las estimaciones de los estados: <span class="math inline">\(X_{1/1}, X_{2/2},...,X_{T/T}\)</span>.</p>
<p>Después, el algortimo del <strong>Suavizador de Kalman</strong> funciona recursivamente hacia atrás, desde <span class="math inline">\(T-1, T-2,...,1\)</span>. Para cada periodo <span class="math inline">\(_{t+1}\)</span>, observamos la diferencia entre las estimaciones suavizadas y las estimaciones filtradas de los estados: <span class="math inline">\(X_{t+1/T}-X_{t+1/t}\)</span>. El <strong>Suavizador de Kalman</strong> utiliza la diferencia para actualizar las estimaciones filtradas de los estados en el periodo <span class="math inline">\(_t\)</span>, con el fin de obtener las estimaciones suavizadas:</p>
<p><span class="math display" id="eq:Sua">\[\begin{equation}
X_{t/T} = X_{t/t} + J_t [X_{t+1/T} - X_{t+1/t}].
\tag{5.26}
\end{equation}\]</span></p>
<p>En la <em>Figura 5.16</em>, podemos observar los resultados del código de Matlab. Otra de las virtudes del <strong>Filtro Kalman</strong> es que podemos hacer una especie de descomposición de la varianza para, así, observar de donde vinieron los choques:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="Plots/Filtration.png" alt="Simulación de la Descomposición de la Brecha del Producto. Elaboración propia con datos de IMF (2020)." width="80%" />
<p class="caption">
Figure 5.16: Simulación de la Descomposición de la Brecha del Producto. Elaboración propia con datos de IMF (2020).
</p>
</div>
<p><strong><em>Nota: Para este ejemplo, se ocupa el QPM básico presentado por IMF (2020) en su curso “Monetary Policy Analysis and Forecasting” que se puede tomar en la plataforma edX. Asimismo, el código de Matlab fue realizado por el IMF.</em></strong></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="procesos-no-estacionarios-univariados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-univariados-y-multivariados-de-volatilidad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-VAR.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Notas-Series-Tiempo.pdf", "Notas-Series-Tiempo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
