<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales | Notas de Clase: Series de Tiempo</title>
<meta name="author" content="Benjamín Oliva, Omar Alfaro Rivera &amp; Emiliano Pérez Caullieres">
<meta name="description" content="7.1 Modelos de Datos Panel y Panel VAR  7.1.1 Motivación Los datos panel son una extensión natural del análisis de series de tiempo en el que observamos una misma variable a lo largo del tiempo,...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 7 Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales | Notas de Clase: Series de Tiempo">
<meta property="og:type" content="book">
<meta property="og:description" content="7.1 Modelos de Datos Panel y Panel VAR  7.1.1 Motivación Los datos panel son una extensión natural del análisis de series de tiempo en el que observamos una misma variable a lo largo del tiempo,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales | Notas de Clase: Series de Tiempo">
<meta name="twitter:description" content="7.1 Modelos de Datos Panel y Panel VAR  7.1.1 Motivación Los datos panel son una extensión natural del análisis de series de tiempo en el que observamos una misma variable a lo largo del tiempo,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notas de Clase: Series de Tiempo</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Análisis de Series de Tiempo</a></li>
<li><a class="" href="introducci%C3%B3n.html"><span class="header-section-number">1</span> Introducción</a></li>
<li><a class="" href="introducci%C3%B3n-al-an%C3%A1lisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><span class="header-section-number">2</span> Introducción al Análisis de Series de Tiempo y Elementos de Ecuaciones en Diferencia</a></li>
<li><a class="" href="procesos-estacionarios-y-modelos-univariados.html"><span class="header-section-number">3</span> Procesos Estacionarios y Modelos Univariados</a></li>
<li><a class="" href="procesos-no-estacionarios-univariados.html"><span class="header-section-number">4</span> Procesos No Estacionarios Univariados</a></li>
<li><a class="" href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegraci%C3%B3n-modelos-ardl-y-filtro-multivariado.html"><span class="header-section-number">5</span> Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado</a></li>
<li><a class="" href="modelos-univariados-y-multivariados-de-volatilidad.html"><span class="header-section-number">6</span> Modelos Univariados y Multivariados de Volatilidad</a></li>
<li><a class="active" href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><span class="header-section-number">7</span> Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales<a class="anchor" aria-label="anchor" href="#modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales"><i class="fas fa-link"></i></a>
</h1>
<div id="modelos-de-datos-panel-y-panel-var" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Modelos de Datos Panel y Panel VAR<a class="anchor" aria-label="anchor" href="#modelos-de-datos-panel-y-panel-var"><i class="fas fa-link"></i></a>
</h2>
<div id="motivación-2" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Motivación<a class="anchor" aria-label="anchor" href="#motivaci%C3%B3n-2"><i class="fas fa-link"></i></a>
</h3>
<p>Los datos panel son una extensión natural del análisis de series de tiempo en el que observamos una misma variable a lo largo del tiempo, pero para múltiples individuos. Denotemos con <span class="math inline">\(Y_{it}\)</span> el componente o individuo <span class="math inline">\(i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, N\)</span> en el tiempo <span class="math inline">\(t\)</span>, <span class="math inline">\(t = 1, 2, \ldots, T\)</span>. Típicamente, las series de tiempo en forma de panel se caracterizan por ser de dimensión de individuos corta y de dimensión temporal larga.</p>
<p>En general, escribiremos:
<span class="math display">\[\begin{equation}
    Y_{it} = \alpha_i + \beta_i X_{it} + U_{it}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\alpha_i\)</span> es un efecto fijo especificado como:
<span class="math display">\[\begin{equation}
    \alpha_i = \beta_0 + \gamma_i Z_i
\end{equation}\]</span></p>
</div>
<div id="pruebas-de-raíces-unitarias-en-panel" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Pruebas de Raíces Unitarias en Panel<a class="anchor" aria-label="anchor" href="#pruebas-de-ra%C3%ADces-unitarias-en-panel"><i class="fas fa-link"></i></a>
</h3>
<p>Las pruebas de raíces unitarias para panel suelen ser usadas principalmente en casos macroeconómicos. De forma similar al caso de series univariadas, asumiremos una forma de AR(1) para una serie en panel:
<span class="math display">\[\begin{equation}
    \Delta Y_{it} = \mu_i + \rho_i Y_{i t-1} + \sum_{i = 1}^{k_i} \varphi_{ij} \Delta Y_{i t-j} + \varepsilon_{it}
    (\#eq:eq_AR_Panel)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(i = 1, \ldots, N\)</span>, <span class="math inline">\(t = 1, \ldots, T\)</span> y <span class="math inline">\(\varepsilon_{it}\)</span> es una v.a. iid que cumple con:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[\varepsilon_{it}] &amp; = &amp; 0 \\
    \mathbb{E}[\varepsilon_{it}^2] &amp; = &amp; \sigma^2_i &lt; \infty \\
    \mathbb{E}[\varepsilon_{it}^4] &amp; &lt; &amp; \infty
\end{eqnarray*}\]</span></p>
<p>Al igual que en el caso univariado, en este tipo de pruebas buscamos identificar cuándo las series son I(1) y cuándo I(0). Para tal efecto, la prueba de raíz unitaria que utilizaremos está basada en una prueba Dickey-Fuller Aumentada en la cual la hipótesis nula (<span class="math inline">\(H_0\)</span>) es que todas las series en el panel son no estacionarias, es decir, son I(1). Es decir,
<span class="math display">\[\begin{equation}
    H_0 : \rho_i = 0
\end{equation}\]</span></p>
Por su parte, en el caso de la hipótesis nula tendremos dos:
</div>
<div id="ejemplo-pruebas-de-raíces-unitarias-en-panel" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Ejemplo: Pruebas de Raíces Unitarias en Panel<a class="anchor" aria-label="anchor" href="#ejemplo-pruebas-de-ra%C3%ADces-unitarias-en-panel"><i class="fas fa-link"></i></a>
</h3>
<p>Dependencies and Setup</p>
<p>Download data from library PLM</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"EmplUK"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Produc"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Grunfeld"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Wages"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span></code></pre></div>
<p>Describe data: Grunfeld data (Grunfeld 1958) comprising 20 annual observations on the three variables real gross investment (invest), real value of the firm (value), and real value of the capital stock (capital) for 10 large US firms for the years 1935–1954</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Grunfeld</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "firm"    "year"    "inv"     "value"   "capital"</code></pre>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Grunfeld</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   firm year   inv  value capital
## 1    1 1935 317.6 3078.5     2.8
## 2    1 1936 391.8 4661.7    52.6
## 3    1 1937 410.6 5387.1   156.9
## 4    1 1938 257.7 2792.2   209.2
## 5    1 1939 330.8 4313.2   203.4
## 6    1 1940 461.2 4643.9   207.2</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Invest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span> <span class="va">Grunfeld</span><span class="op">$</span><span class="va">inv</span>, <span class="va">Grunfeld</span><span class="op">$</span><span class="va">firm</span> <span class="op">)</span><span class="op">)</span> <span class="co"># individuals in columns</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "X1"  "X2"  "X3"  "X4"  "X5"  "X6"  "X7"  "X8"  "X9"  "X10"</code></pre>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"Firm_1"</span>, <span class="st">"Firm_2"</span>, <span class="st">"Firm_3"</span>, <span class="st">"Firm_4"</span>, </span>
<span>                    <span class="st">"Firm_5"</span>, <span class="st">"Firm_6"</span>, <span class="st">"Firm_7"</span>, <span class="st">"Firm_8"</span>, </span>
<span>                    <span class="st">"Firm_9"</span>, <span class="st">"Firm_10"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "Firm_1"  "Firm_2"  "Firm_3"  "Firm_4"  "Firm_5"  "Firm_6"  "Firm_7" 
##  [8] "Firm_8"  "Firm_9"  "Firm_10"</code></pre>
<p>Plot:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_1</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1500</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"Real gross investment"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_2</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_3</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_4</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_5</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">5</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_6</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">6</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_7</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">7</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_8</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">8</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_9</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">9</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">$</span><span class="va">Firm_10</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">10</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Firm_1"</span>, <span class="st">"Firm_2"</span>, <span class="st">"Firm_3"</span>, <span class="st">"Firm_4"</span>, <span class="st">"Firm_5"</span>,</span>
<span>                           <span class="st">"Firm_6"</span>, <span class="st">"Firm_7"</span>, <span class="st">"Firm_8"</span>, <span class="st">"Firm_9"</span>, <span class="st">"Firm_10"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig111"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig111-1.png" alt="Evolución de la inversión por empresa" width="672"><p class="caption">
Figure 7.1: Evolución de la inversión por empresa
</p>
</div>
<p>Unit Root Test: Test specifies the type of test to be performed among Levin et al. (2002), Im et al. (2003), Maddala and Wu (1999) and Hadri (2000)</p>
<p>Consider Levin et al. (2002)</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in selectT(l, theTs): the time series is short</code></pre>
<pre><code>## 
##  Levin-Lin-Chu Unit-Root Test (ex. var.: Individual Intercepts)
## 
## data:  log(Invest)
## z = -0.63214, p-value = 0.2636
## alternative hypothesis: stationarity</code></pre>
<p>Same via:</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_LInvest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1935</span>, end <span class="op">=</span> <span class="fl">1954</span>, freq <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ts_DLInvest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Invest</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1935</span>, end <span class="op">=</span> <span class="fl">1954</span>, freq <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>                     lag <span class="op">=</span> <span class="fl">1</span>, differences <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LInvest</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in selectT(l, theTs): the time series is short</code></pre>
<pre><code>## 
##  Levin-Lin-Chu Unit-Root Test (ex. var.: Individual Intercepts)
## 
## data:  ts_LInvest
## z = -0.63214, p-value = 0.2636
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LInvest</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in selectT(l, theTs): the time series is short</code></pre>
<pre><code>## Levin-Lin-Chu Unit-Root Test 
## Exogenous variables: Individual Intercepts 
## Automatic selection of lags using AIC: 0 - 3 lags (max: 4)
## statistic: -0.632 
## p-value: 0.264 
## 
##         lags obs          rho        trho     p.trho   sigma2ST    sigma2LT
## Firm_1     0  19  0.006034802  0.05068864 0.96193110 0.03592530 0.014769876
## Firm_2     1  18 -0.597193025 -2.95851997 0.03895745 0.05020448 0.014565004
## Firm_3     3  16 -0.257291999 -1.97135237 0.29979349 0.03073205 0.019141095
## Firm_4     0  19 -0.172070863 -1.21388533 0.67084314 0.06196079 0.018454390
## Firm_5     1  18 -0.444726602 -1.69693864 0.43286539 0.04165516 0.006949122
## Firm_6     2  17  0.062922587  0.72626225 0.99275186 0.02442139 0.009212851
## Firm_7     2  17 -0.013830411 -0.08442715 0.94937802 0.03230724 0.007274365
## Firm_8     1  18 -0.365024064 -2.26588313 0.18328720 0.06270208 0.026960667
## Firm_9     0  19 -0.247940802 -1.72877417 0.41668489 0.05073398 0.013291332
## Firm_10    1  18 -0.197003144 -1.52323519 0.52199891 0.07672404 0.062496477</code></pre>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLInvest</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in selectT(l, theTs): the time series is short</code></pre>
<pre><code>## 
##  Levin-Lin-Chu Unit-Root Test (ex. var.: Individual Intercepts)
## 
## data:  ts_DLInvest
## z = -8.5076, p-value &lt; 0.00000000000000022
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLInvest</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in selectT(l, theTs): the time series is short</code></pre>
<pre><code>## Levin-Lin-Chu Unit-Root Test 
## Exogenous variables: Individual Intercepts 
## Automatic selection of lags using AIC: 0 - 3 lags (max: 4)
## statistic: -8.508 
## p-value: 0 
## 
##         lags obs        rho      trho            p.trho   sigma2ST    sigma2LT
## Firm_1     0  18 -0.9778879 -4.196070 0.000665206460867 0.03693616 0.007853674
## Firm_2     3  15 -2.7288380 -4.327510 0.000392850467043 0.02832436 0.031954702
## Firm_3     2  16 -1.7848678 -5.650917 0.000000790572465 0.03819653 0.022971185
## Firm_4     1  17 -1.5737470 -5.320458 0.000004309793729 0.04231849 0.030313940
## Firm_5     2  16 -2.8118586 -5.181259 0.000008564306919 0.02737020 0.015226407
## Firm_6     1  17 -1.4850311 -4.776618 0.000057171776145 0.02517911 0.008588652
## Firm_7     1  17 -2.1076263 -6.541451 0.000000005364403 0.03232079 0.012780800
## Firm_8     2  16 -1.7790739 -4.976338 0.000022818242011 0.03277746 0.034905699
## Firm_9     0  18 -1.2600946 -5.304469 0.000004667479100 0.05666016 0.019502840
## Firm_10    0  18 -0.7889550 -3.421651 0.010275559745253 0.08661396 0.030216984</code></pre>
<p>Consider Im-Pesaran-Shin Unit-Root Test (2003)</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LInvest</span>, test <span class="op">=</span> <span class="st">"ips"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Im-Pesaran-Shin Unit-Root Test (ex. var.: Individual Intercepts)
## 
## data:  ts_LInvest
## Wtbar = 0.6833, p-value = 0.7528
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LInvest</span>, test <span class="op">=</span> <span class="st">"ips"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>                lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Im-Pesaran-Shin Unit-Root Test 
## Exogenous variables: Individual Intercepts 
## Automatic selection of lags using AIC: 0 - 3 lags (max: 4)
## statistic (Wtbar): 0.683 
## p-value: 0.753 
## 
##         lags obs          rho        trho     p.trho    mean    var
## Firm_1     0  19  0.006034802  0.05068864 0.96193110 -1.5204 0.8654
## Firm_2     1  18 -0.597193025 -2.95851997 0.03895745 -1.5108 0.9534
## Firm_3     3  16 -0.257291999 -1.97135237 0.29979349 -1.3754 1.1522
## Firm_4     0  19 -0.172070863 -1.21388533 0.67084314 -1.5204 0.8654
## Firm_5     1  18 -0.444726602 -1.69693864 0.43286539 -1.5108 0.9534
## Firm_6     2  17  0.062922587  0.72626225 0.99275186 -1.4034 1.0344
## Firm_7     2  17 -0.013830411 -0.08442715 0.94937802 -1.4034 1.0344
## Firm_8     1  18 -0.365024064 -2.26588313 0.18328720 -1.5108 0.9534
## Firm_9     0  19 -0.247940802 -1.72877417 0.41668489 -1.5204 0.8654
## Firm_10    1  18 -0.197003144 -1.52323519 0.52199891 -1.5108 0.9534</code></pre>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLInvest</span>, test <span class="op">=</span> <span class="st">"ips"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Im-Pesaran-Shin Unit-Root Test (ex. var.: Individual Intercepts)
## 
## data:  ts_DLInvest
## Wtbar = -11.14, p-value &lt; 0.00000000000000022
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLInvest</span>, test <span class="op">=</span> <span class="st">"ips"</span>, exo <span class="op">=</span> <span class="st">"intercept"</span>, </span>
<span>                lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Im-Pesaran-Shin Unit-Root Test 
## Exogenous variables: Individual Intercepts 
## Automatic selection of lags using AIC: 0 - 3 lags (max: 4)
## statistic (Wtbar): -11.14 
## p-value: 0 
## 
##         lags obs        rho      trho            p.trho    mean    var
## Firm_1     0  18 -0.9778879 -4.196070 0.000665206460867 -1.5188 0.8798
## Firm_2     3  15 -2.7288380 -4.327510 0.000392850467043 -1.3660 1.1810
## Firm_3     2  16 -1.7848678 -5.650917 0.000000790572465 -1.3952 1.0562
## Firm_4     1  17 -1.5737470 -5.320458 0.000004309793729 -1.5082 0.9726
## Firm_5     2  16 -2.8118586 -5.181259 0.000008564306919 -1.3952 1.0562
## Firm_6     1  17 -1.4850311 -4.776618 0.000057171776145 -1.5082 0.9726
## Firm_7     1  17 -2.1076263 -6.541451 0.000000005364403 -1.5082 0.9726
## Firm_8     2  16 -1.7790739 -4.976338 0.000022818242011 -1.3952 1.0562
## Firm_9     0  18 -1.2600946 -5.304469 0.000004667479100 -1.5188 0.8798
## Firm_10    0  18 -0.7889550 -3.421651 0.010275559745253 -1.5188 0.8798</code></pre>
</div>
<div id="ejemplo-modelo-dif-in-dif-para-el-inpc-de-análisis-clínicos-update-nov-2022" class="section level3" number="7.1.4">
<h3>
<span class="header-section-number">7.1.4</span> Ejemplo: Modelo Dif-in-Dif para el INPC de análisis clínicos (update nov-2022)<a class="anchor" aria-label="anchor" href="#ejemplo-modelo-dif-in-dif-para-el-inpc-de-an%C3%A1lisis-cl%C3%ADnicos-update-nov-2022"><i class="fas fa-link"></i></a>
</h3>
<p>Este ejemplo modela el efecto que tiene que una empresa de laboratorios de análisis clínicos compre a sus competidores en diferentes ciudades del país. Para lo cual usaremos información del Índice Nacional de Precios al Consumidor de los servicios de análisis clínicos.</p>
<p>Dependencies and Setup</p>
Importamos Datos desde un archivo de Excel. Los datos están en formato panel e incluyen:
<p>Partamos de la siguiente ecuación:
<span class="math display">\[\begin{equation}
    y_{it} = \beta_1 + \beta_2 T_t + \beta_3 D_t + \theta T_t \times D_t + \boldsymbol{\gamma} \mathbf{X}_{it} + \varepsilon_{it}
    (\#eq:eq_DiD)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(y_{it}\)</span> es la variable sobre la cual queremos evaluar el efecto de un tratamiento, <span class="math inline">\(\mathbf{X}_{it}\)</span> es un conjunto de variables de control, que incluye a las variables de efectos fijos (temporales, de individuos o del tipo que se decida) y, en su caso, una tendencia, entre otras. Finalmente, las variables <span class="math inline">\(T_t\)</span> y <span class="math inline">\(D_i\)</span> son variables dicotómicas que identifican con el valor de 1 el momento a partir del cual se observa el tratamiento y con 0 en cualquier otro caso, y con 1 los individuos que fueron tratados y con 0 en cualquier otro caso, respectivamente.</p>
<p>De esta forma, el producto <span class="math inline">\(T_t \times D_t\)</span> sería una variable dicotómica que indicaría con un 1 a aquellos individuos que fueron tratados a partir del momento en que se implementó el tratamiento y con 0 en cualquier otro caso. Bajo este escenario, <span class="math inline">\(\theta\)</span> es un coeficiente que captura el efecto del tratamiento, condicional a que se ha controlado por una serie de factores.</p>
<p>Otra forma de ver lo que se indica en la ecuación @ref(eq:eq_DiD) es como la comparación de la diferencia en diferencia descrita por:
<span class="math display">\[\begin{eqnarray}
    E &amp; = &amp; [ (\overline{y}_{exit} | treatment) - (\overline{y}_{baseline} | treatment) ] \nonumber \\  
    &amp;  &amp; - [ (\overline{y}_{exit} | placebo) - (\overline{y}_{baseline} | placebo) ]
    (\#eq:eq_DiD_E)
\end{eqnarray}\]</span></p>
<p>La expresión @ref(eq:eq_DiD_E) cuantifica el efecto que tiene el tratamiento como la diferencia de medias de dos grupos: un grupo tratado y otro no tratado. Dentro de los cuales se han comparado las medias respecto de una línea base. Podemos plantear esto desde esta otra perspectiva. Pensemos que solo tenemos dos periodos <span class="math inline">\(t = {1, 2}\)</span>, en el cual en 1 no ha ocurrido el tratamiento y en 2 ya ha ocurrido. Así, el cambio en la variable de respuesta para los individuos tratados será (suponiendo que omitimos la matriz <span class="math inline">\(\mathbf{X}_{it}\)</span> en la ecuación @ref(eq:eq_DiD)):
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[ y_{i2} | D_i = 1 ] - \mathbb{E}[ y_{i1} | D_i = 1 ] &amp; = &amp; ( \beta_1 + \beta_2 + \beta_3 + \theta ) - ( \beta_1 + \beta_3 + \theta ) \nonumber \\  
    &amp; = &amp; \beta_2 + \theta
    (\#eq:eq_DiD_Treat)
\end{eqnarray}\]</span></p>
<p>Ahora, sobre los no tratados:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[ y_{i2} | D_i = 0 ] - \mathbb{E}[ y_{i1} | D_i = 0 ] &amp; = &amp; ( \beta_1 + \beta_2 ) - ( \beta_1 ) \nonumber \\  
    &amp; = &amp; \beta_2
    (\#eq:eq_DiD_NoTreat)
\end{eqnarray}\]</span></p>
<p>Así, la diferencia en diferencia resulta de restar la ecuación @ref(eq:eq_DiD_NoTreat) a la ecuación @ref(eq:eq_DiD_Treat):
<span class="math display">\[\begin{eqnarray}
    &amp; &amp; ( \mathbb{E}[ y_{i2} | D_i = 1 ] - \mathbb{E}[ y_{i1} | D_i = 1 ] ) - ( \mathbb{E}[ y_{i2} | D_i = 0 ] - \mathbb{E}[ y_{i1} | D_i = 0 ] ) \nonumber \\
    &amp; &amp; = \theta
    (\#eq:eq_Aplicada)
\end{eqnarray}\]</span></p>
<p>En nuestro caso, utilizaremos como tratamiento la entrada al mercado de un laboratorio de análisis clínicos en una ciudad determinada.</p>
<pre><code>## [1] 13420    17</code></pre>
<pre><code>## # A tibble: 6 × 17
##   Fecha   Mes  Anio Ciudad INPC  Dummy_FIRMA Marca_01 Marca_02 Marca_03 Marca_04
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 Jul …     7  2002 Área … 68.3…           0        0        0        0        0
## 2 Ago …     8  2002 Área … 68.3…           0        0        0        0        0
## 3 Sep …     9  2002 Área … 68.3…           0        0        0        0        0
## 4 Oct …    10  2002 Área … 68.3…           0        0        0        0        0
## 5 Nov …    11  2002 Área … 68.3…           0        0        0        0        0
## 6 Dic …    12  2002 Área … 68.3…           0        0        0        0        0
## # ℹ 7 more variables: Marca_05 &lt;dbl&gt;, Marca_06 &lt;dbl&gt;, Marca_07 &lt;dbl&gt;,
## #   Marca_08 &lt;dbl&gt;, Marca_09 &lt;dbl&gt;, Marca_10 &lt;dbl&gt;, Marca_11 &lt;dbl&gt;</code></pre>
<p>Selección de ciudades:</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Atlacomulco, Edo. de Méx.'</span> <span class="op">&amp;</span> </span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Cancún, Q.R.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Coatzacoalcos, Ver.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Esperanza, Son.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Izúcar de Matamoros, Pue.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Pachuca, Hgo.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Tuxtla Gutiérrez, Chis.'</span> <span class="op">&amp;</span></span>
<span>                     <span class="va">Data</span><span class="op">$</span><span class="va">Ciudad</span> <span class="op">!=</span> <span class="st">'Zacatecas, Zac.'</span> <span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Tranformaciones:</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Log de INPC</span></span>
<span><span class="va">Data</span><span class="op">$</span><span class="va">LINPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">INPC</span><span class="op">)</span> , base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Volvemos factor a la fecha</span></span>
<span><span class="va">Data</span><span class="op">$</span><span class="va">Periodo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Fecha</span>, order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"Jul 2002"</span>, <span class="st">"Ago 2002"</span>, <span class="st">"Sep 2002"</span>, </span>
<span>                                   <span class="st">"Oct 2002"</span>, <span class="st">"Nov 2002"</span>, <span class="st">"Dic 2002"</span>,</span>
<span>                                   <span class="st">"Ene 2003"</span>, <span class="st">"Feb 2003"</span>, <span class="st">"Mar 2003"</span>, </span>
<span>                                   <span class="st">"Abr 2003"</span>, <span class="st">"May 2003"</span>, <span class="st">"Jun 2003"</span>,</span>
<span>                                   <span class="st">"Jul 2003"</span>, <span class="st">"Ago 2003"</span>, <span class="st">"Sep 2003"</span>, </span>
<span>                                   <span class="st">"Oct 2003"</span>, <span class="st">"Nov 2003"</span>, <span class="st">"Dic 2003"</span>,</span>
<span>                                   <span class="st">"Ene 2004"</span>, <span class="st">"Feb 2004"</span>, <span class="st">"Mar 2004"</span>, </span>
<span>                                   <span class="st">"Abr 2004"</span>, <span class="st">"May 2004"</span>, <span class="st">"Jun 2004"</span>,</span>
<span>                                   <span class="st">"Jul 2004"</span>, <span class="st">"Ago 2004"</span>, <span class="st">"Sep 2004"</span>, </span>
<span>                                   <span class="st">"Oct 2004"</span>, <span class="st">"Nov 2004"</span>, <span class="st">"Dic 2004"</span>,</span>
<span>                                   <span class="st">"Ene 2005"</span>, <span class="st">"Feb 2005"</span>, <span class="st">"Mar 2005"</span>, </span>
<span>                                   <span class="st">"Abr 2005"</span>, <span class="st">"May 2005"</span>, <span class="st">"Jun 2005"</span>,</span>
<span>                                   <span class="st">"Jul 2005"</span>, <span class="st">"Ago 2005"</span>, <span class="st">"Sep 2005"</span>, </span>
<span>                                   <span class="st">"Oct 2005"</span>, <span class="st">"Nov 2005"</span>, <span class="st">"Dic 2005"</span>,</span>
<span>                                   <span class="st">"Ene 2006"</span>, <span class="st">"Feb 2006"</span>, <span class="st">"Mar 2006"</span>, </span>
<span>                                   <span class="st">"Abr 2006"</span>, <span class="st">"May 2006"</span>, <span class="st">"Jun 2006"</span>,</span>
<span>                                   <span class="st">"Jul 2006"</span>, <span class="st">"Ago 2006"</span>, <span class="st">"Sep 2006"</span>, </span>
<span>                                   <span class="st">"Oct 2006"</span>, <span class="st">"Nov 2006"</span>, <span class="st">"Dic 2006"</span>,</span>
<span>                                   <span class="st">"Ene 2007"</span>, <span class="st">"Feb 2007"</span>, <span class="st">"Mar 2007"</span>, </span>
<span>                                   <span class="st">"Abr 2007"</span>, <span class="st">"May 2007"</span>, <span class="st">"Jun 2007"</span>,</span>
<span>                                   <span class="st">"Jul 2007"</span>, <span class="st">"Ago 2007"</span>, <span class="st">"Sep 2007"</span>, </span>
<span>                                   <span class="st">"Oct 2007"</span>, <span class="st">"Nov 2007"</span>, <span class="st">"Dic 2007"</span>,</span>
<span>                                   <span class="st">"Ene 2008"</span>, <span class="st">"Feb 2008"</span>, <span class="st">"Mar 2008"</span>, </span>
<span>                                   <span class="st">"Abr 2008"</span>, <span class="st">"May 2008"</span>, <span class="st">"Jun 2008"</span>,</span>
<span>                                   <span class="st">"Jul 2008"</span>, <span class="st">"Ago 2008"</span>, <span class="st">"Sep 2008"</span>, </span>
<span>                                   <span class="st">"Oct 2008"</span>, <span class="st">"Nov 2008"</span>, <span class="st">"Dic 2008"</span>,</span>
<span>                                   <span class="st">"Ene 2009"</span>, <span class="st">"Feb 2009"</span>, <span class="st">"Mar 2009"</span>, </span>
<span>                                   <span class="st">"Abr 2009"</span>, <span class="st">"May 2009"</span>, <span class="st">"Jun 2009"</span>,</span>
<span>                                   <span class="st">"Jul 2009"</span>, <span class="st">"Ago 2009"</span>, <span class="st">"Sep 2009"</span>, </span>
<span>                                   <span class="st">"Oct 2009"</span>, <span class="st">"Nov 2009"</span>, <span class="st">"Dic 2009"</span>,</span>
<span>                                   <span class="st">"Ene 2010"</span>, <span class="st">"Feb 2010"</span>, <span class="st">"Mar 2010"</span>, </span>
<span>                                   <span class="st">"Abr 2010"</span>, <span class="st">"May 2010"</span>, <span class="st">"Jun 2010"</span>,</span>
<span>                                   <span class="st">"Jul 2010"</span>, <span class="st">"Ago 2010"</span>, <span class="st">"Sep 2010"</span>, </span>
<span>                                   <span class="st">"Oct 2010"</span>, <span class="st">"Nov 2010"</span>, <span class="st">"Dic 2010"</span>,</span>
<span>                                   <span class="st">"Ene 2011"</span>, <span class="st">"Feb 2011"</span>, <span class="st">"Mar 2011"</span>, </span>
<span>                                   <span class="st">"Abr 2011"</span>, <span class="st">"May 2011"</span>, <span class="st">"Jun 2011"</span>,</span>
<span>                                   <span class="st">"Jul 2011"</span>, <span class="st">"Ago 2011"</span>, <span class="st">"Sep 2011"</span>, </span>
<span>                                   <span class="st">"Oct 2011"</span>, <span class="st">"Nov 2011"</span>, <span class="st">"Dic 2011"</span>,</span>
<span>                                   <span class="st">"Ene 2012"</span>, <span class="st">"Feb 2012"</span>, <span class="st">"Mar 2012"</span>, </span>
<span>                                   <span class="st">"Abr 2012"</span>, <span class="st">"May 2012"</span>, <span class="st">"Jun 2012"</span>,</span>
<span>                                   <span class="st">"Jul 2012"</span>, <span class="st">"Ago 2012"</span>, <span class="st">"Sep 2012"</span>, </span>
<span>                                   <span class="st">"Oct 2012"</span>, <span class="st">"Nov 2012"</span>, <span class="st">"Dic 2012"</span>,</span>
<span>                                   <span class="st">"Ene 2013"</span>, <span class="st">"Feb 2013"</span>, <span class="st">"Mar 2013"</span>, </span>
<span>                                   <span class="st">"Abr 2013"</span>, <span class="st">"May 2013"</span>, <span class="st">"Jun 2013"</span>,</span>
<span>                                   <span class="st">"Jul 2013"</span>, <span class="st">"Ago 2013"</span>, <span class="st">"Sep 2013"</span>, </span>
<span>                                   <span class="st">"Oct 2013"</span>, <span class="st">"Nov 2013"</span>, <span class="st">"Dic 2013"</span>,</span>
<span>                                   <span class="st">"Ene 2014"</span>, <span class="st">"Feb 2014"</span>, <span class="st">"Mar 2014"</span>, </span>
<span>                                   <span class="st">"Abr 2014"</span>, <span class="st">"May 2014"</span>, <span class="st">"Jun 2014"</span>,</span>
<span>                                   <span class="st">"Jul 2014"</span>, <span class="st">"Ago 2014"</span>, <span class="st">"Sep 2014"</span>, </span>
<span>                                   <span class="st">"Oct 2014"</span>, <span class="st">"Nov 2014"</span>, <span class="st">"Dic 2014"</span>,</span>
<span>                                   <span class="st">"Ene 2015"</span>, <span class="st">"Feb 2015"</span>, <span class="st">"Mar 2015"</span>, </span>
<span>                                   <span class="st">"Abr 2015"</span>, <span class="st">"May 2015"</span>, <span class="st">"Jun 2015"</span>,</span>
<span>                                   <span class="st">"Jul 2015"</span>, <span class="st">"Ago 2015"</span>, <span class="st">"Sep 2015"</span>, </span>
<span>                                   <span class="st">"Oct 2015"</span>, <span class="st">"Nov 2015"</span>, <span class="st">"Dic 2015"</span>,</span>
<span>                                   <span class="st">"Ene 2016"</span>, <span class="st">"Feb 2016"</span>, <span class="st">"Mar 2016"</span>, </span>
<span>                                   <span class="st">"Abr 2016"</span>, <span class="st">"May 2016"</span>, <span class="st">"Jun 2016"</span>,</span>
<span>                                   <span class="st">"Jul 2016"</span>, <span class="st">"Ago 2016"</span>, <span class="st">"Sep 2016"</span>, </span>
<span>                                   <span class="st">"Oct 2016"</span>, <span class="st">"Nov 2016"</span>, <span class="st">"Dic 2016"</span>,</span>
<span>                                   <span class="st">"Ene 2017"</span>, <span class="st">"Feb 2017"</span>, <span class="st">"Mar 2017"</span>, </span>
<span>                                   <span class="st">"Abr 2017"</span>, <span class="st">"May 2017"</span>, <span class="st">"Jun 2017"</span>,</span>
<span>                                   <span class="st">"Jul 2017"</span>, <span class="st">"Ago 2017"</span>, <span class="st">"Sep 2017"</span>, </span>
<span>                                   <span class="st">"Oct 2017"</span>, <span class="st">"Nov 2017"</span>, <span class="st">"Dic 2017"</span>,</span>
<span>                                   <span class="st">"Ene 2018"</span>, <span class="st">"Feb 2018"</span>, <span class="st">"Mar 2018"</span>, </span>
<span>                                   <span class="st">"Abr 2018"</span>, <span class="st">"May 2018"</span>, <span class="st">"Jun 2018"</span>,</span>
<span>                                   <span class="st">"Jul 2018"</span>, <span class="st">"Ago 2018"</span>, <span class="st">"Sep 2018"</span>, </span>
<span>                                   <span class="st">"Oct 2018"</span>, <span class="st">"Nov 2018"</span>, <span class="st">"Dic 2018"</span>,</span>
<span>                                   <span class="st">"Ene 2019"</span>, <span class="st">"Feb 2019"</span>, <span class="st">"Mar 2019"</span>, </span>
<span>                                   <span class="st">"Abr 2019"</span>, <span class="st">"May 2019"</span>, <span class="st">"Jun 2019"</span>,</span>
<span>                                   <span class="st">"Jul 2019"</span>, <span class="st">"Ago 2019"</span>, <span class="st">"Sep 2019"</span>, </span>
<span>                                   <span class="st">"Oct 2019"</span>, <span class="st">"Nov 2019"</span>, <span class="st">"Dic 2019"</span>,</span>
<span>                                   <span class="st">"Ene 2020"</span>, <span class="st">"Feb 2020"</span>, <span class="st">"Mar 2020"</span>, </span>
<span>                                   <span class="st">"Abr 2020"</span>, <span class="st">"May 2020"</span>, <span class="st">"Jun 2020"</span>,</span>
<span>                                   <span class="st">"Jul 2020"</span>, <span class="st">"Ago 2020"</span>, <span class="st">"Sep 2020"</span>, </span>
<span>                                   <span class="st">"Oct 2020"</span>, <span class="st">"Nov 2020"</span>, <span class="st">"Dic 2020"</span>,</span>
<span>                                   <span class="st">"Ene 2021"</span>, <span class="st">"Feb 2021"</span>, <span class="st">"Mar 2021"</span>, </span>
<span>                                   <span class="st">"Abr 2021"</span>, <span class="st">"May 2021"</span>, <span class="st">"Jun 2021"</span>,</span>
<span>                                   <span class="st">"Jul 2021"</span>, <span class="st">"Ago 2021"</span>, <span class="st">"Sep 2021"</span>, </span>
<span>                                   <span class="st">"Oct 2021"</span>, <span class="st">"Nov 2021"</span>, <span class="st">"Dic 2021"</span>,</span>
<span>                                   <span class="st">"Ene 2022"</span>, <span class="st">"Feb 2022"</span>, <span class="st">"Mar 2022"</span>, </span>
<span>                                   <span class="st">"Abr 2022"</span>, <span class="st">"May 2022"</span>, <span class="st">"Jun 2022"</span>,</span>
<span>                                   <span class="st">"Jul 2022"</span>, <span class="st">"Ago 2022"</span>, <span class="st">"Sep 2022"</span>, <span class="st">"</span></span>
<span><span class="st">                                   Oct 2022"</span>, <span class="st">"Nov 2022"</span>, <span class="st">"Dic 2022"</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Periodo</span>, y <span class="op">=</span> <span class="va">LINPC</span>, group <span class="op">=</span> <span class="va">Ciudad</span>, color <span class="op">=</span> <span class="va">Ciudad</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>          legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span> size <span class="op">=</span> <span class="fl">8</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-40-1.png" width="672"></div>
<p>Hagamos una pruebas de Raíces Unitarias.</p>
<p>Change to format wide:</p>
<pre><code>## # A tibble: 6 × 48
##   Fecha    `Acapulco, Gro.` `Aguascalientes, Ags.` Área Metropolitana de la Cd…¹
##   &lt;chr&gt;               &lt;dbl&gt;                  &lt;dbl&gt;                         &lt;dbl&gt;
## 1 Abr 2003             4.39                   4.35                          4.26
## 2 Abr 2004             4.39                   4.36                          4.31
## 3 Abr 2005             4.44                   4.36                          4.36
## 4 Abr 2006             4.47                   4.33                          4.40
## 5 Abr 2007             4.54                   4.38                          4.42
## 6 Abr 2008             4.60                   4.41                          4.44
## # ℹ abbreviated name: ¹​`Área Metropolitana de la Cd. de México`
## # ℹ 44 more variables: `Campeche, Camp.` &lt;dbl&gt;, `Cd. Acuña, Coah.` &lt;dbl&gt;,
## #   `Cd. Jiménez, Chih.` &lt;dbl&gt;, `Cd. Juárez, Chih.` &lt;dbl&gt;,
## #   `Chetumal, Q.R.` &lt;dbl&gt;, `Chihuahua, Chih.` &lt;dbl&gt;, `Colima, Col.` &lt;dbl&gt;,
## #   `Córdoba, Ver.` &lt;dbl&gt;, `Cortazar, Gto.` &lt;dbl&gt;, `Cuernavaca, Mor.` &lt;dbl&gt;,
## #   `Culiacán, Sin.` &lt;dbl&gt;, `Durango, Dgo.` &lt;dbl&gt;, `Fresnillo, Zac.` &lt;dbl&gt;,
## #   `Guadalajara, Jal.` &lt;dbl&gt;, `Hermosillo, Son.` &lt;dbl&gt;, …</code></pre>
<p>Time Series:</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_LINPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span> <span class="va">LINPC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">2</span><span class="op">:</span><span class="fl">48</span> <span class="op">)</span><span class="op">]</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ts_DLINPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span> <span class="va">LINPC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">2</span><span class="op">:</span><span class="fl">48</span> <span class="op">)</span><span class="op">]</span>, </span>
<span>                     start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>                     freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                  lag <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                  differences <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Unit Root Test: Test specifies the type of test to be performed among Levin et al. (2002), Im et al. (2003), Maddala and Wu (1999) and Hadri (2000)</p>
<p>Optimal lags:
<span class="math display">\[\begin{eqnarray*}
  p &amp; = &amp; Int(4*(T/100)^{(1/4)}) \\
   &amp; = &amp; Int(4*(244/100)^{(1/4)}) \\
   &amp; = &amp; Int(4.99) \\
   &amp; = &amp; 4
\end{eqnarray*}\]</span></p>
<p>Consider Levin et al. (2002):</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LINPC</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Levin-Lin-Chu Unit-Root Test (ex. var.: Individual Intercepts and
##  Trend)
## 
## data:  ts_LINPC
## z = -56.022, p-value &lt; 2.2e-16
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLINPC</span>, test <span class="op">=</span> <span class="st">"levinlin"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Levin-Lin-Chu Unit-Root Test (ex. var.: Individual Intercepts and
##  Trend)
## 
## data:  ts_DLINPC
## z = -107.84, p-value &lt; 2.2e-16
## alternative hypothesis: stationarity</code></pre>
<p>Consider Choi (2001):</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LINPC</span>, test <span class="op">=</span> <span class="st">"logit"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Choi's Logit Unit-Root Test (ex. var.: Individual Intercepts and Trend)
## 
## data:  ts_LINPC
## L* = -85.506, df = 239, p-value &lt; 2.2e-16
## alternative hypothesis: stationarity</code></pre>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLINPC</span>, test <span class="op">=</span> <span class="st">"logit"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Choi's Logit Unit-Root Test (ex. var.: Individual Intercepts and Trend)
## 
## data:  ts_DLINPC
## L* = -278.56, df = 239, p-value &lt; 2.2e-16
## alternative hypothesis: stationarity</code></pre>
<p>Consider Hadri (2000):</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_LINPC</span>, test <span class="op">=</span> <span class="st">"hadri"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Hadri Test (ex. var.: Individual Intercepts and Trend) (Heterosked.
##  Consistent)
## 
## data:  ts_LINPC
## z = -2.7, p-value = 0.9965
## alternative hypothesis: at least one series has a unit root</code></pre>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/purtest.html">purtest</a></span><span class="op">(</span><span class="va">ts_DLINPC</span>, test <span class="op">=</span> <span class="st">"hadri"</span>, exo <span class="op">=</span> <span class="st">"trend"</span>, <span class="co"># exo = c("none", "intercept", "trend"),</span></span>
<span>        lags <span class="op">=</span> <span class="st">"AIC"</span>, pmax <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Hadri Test (ex. var.: Individual Intercepts and Trend) (Heterosked.
##  Consistent)
## 
## data:  ts_DLINPC
## z = -8.9351, p-value = 1
## alternative hypothesis: at least one series has a unit root</code></pre>
<p>Estimación PANEL con TREND:</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modelo Final</span></span>
<span><span class="va">fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span> <span class="va">LINPC</span> <span class="op">~</span> <span class="va">Dummy_FIRMA</span> <span class="op">+</span> <span class="va">Marca_01</span> <span class="op">+</span> <span class="va">Marca_02</span> <span class="op">+</span> <span class="va">Marca_03</span> <span class="op">+</span> <span class="va">Marca_04</span> <span class="op">+</span> <span class="va">Marca_05</span> <span class="op">+</span> </span>
<span>              <span class="va">Marca_06</span> <span class="op">+</span> <span class="va">Marca_07</span> <span class="op">+</span> <span class="va">Marca_08</span> <span class="op">+</span> <span class="va">Marca_09</span> <span class="op">+</span> <span class="va">Marca_10</span> <span class="op">+</span> <span class="va">Marca_11</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Periodo</span><span class="op">)</span>,</span>
<span>             data <span class="op">=</span> <span class="va">Data</span>, </span>
<span>             index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ciudad"</span>, <span class="st">"Periodo"</span><span class="op">)</span>, </span>
<span>             model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in pdata.frame(data, index): at least one NA in at least one index dimension in resulting pdata.frame
##  to find out which, use, e.g., table(index(your_pdataframe), useNA = "ifany")</code></pre>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">fixed</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = LINPC ~ Dummy_FIRMA + Marca_01 + Marca_02 + Marca_03 + 
##     Marca_04 + Marca_05 + Marca_06 + Marca_07 + Marca_08 + Marca_09 + 
##     Marca_10 + Marca_11 + as.numeric(Periodo), data = Data, model = "within", 
##     index = c("Ciudad", "Periodo"))
## 
## Balanced Panel: n = 47, T = 243, N = 11421
## 
## Residuals:
##       Min.    1st Qu.     Median    3rd Qu.       Max. 
## -0.4220510 -0.0416329  0.0026154  0.0471479  0.2275376 
## 
## Coefficients:
##                        Estimate  Std. Error  t-value  Pr(&gt;|t|)    
## Dummy_FIRMA         -0.05972092  0.01892851  -3.1551 0.0016087 ** 
## Marca_01             0.04545555  0.02069006   2.1970 0.0280423 *  
## Marca_02             0.05452288  0.02372909   2.2977 0.0215956 *  
## Marca_03            -0.02925504  0.02041744  -1.4328 0.1519296    
## Marca_04            -0.07440826  0.02418665  -3.0764 0.0021000 ** 
## Marca_05             0.02633713  0.01045219   2.5198 0.0117567 *  
## Marca_06             0.12521494  0.01991655   6.2870 3.356e-10 ***
## Marca_07            -0.09242328  0.02514895  -3.6750 0.0002389 ***
## Marca_08             0.03362324  0.02086579   1.6114 0.1071193    
## Marca_09             0.05630828  0.02121641   2.6540 0.0079655 ** 
## Marca_10            -0.04866105  0.02638856  -1.8440 0.0652062 .  
## Marca_11            -0.03582620  0.03031018  -1.1820 0.2372361    
## as.numeric(Periodo)  0.00220384  0.00001018 216.4961 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Total Sum of Squares:    330.79
## Residual Sum of Squares: 60.08
## R-Squared:      0.81838
## Adj. R-Squared: 0.81743
## F-statistic: 3937.79 on 13 and 11361 DF, p-value: &lt; 2.22e-16</code></pre>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modelo Final</span></span>
<span><span class="va">fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span> <span class="va">LINPC</span> <span class="op">~</span> <span class="va">Dummy_FIRMA</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">Periodo</span><span class="op">)</span>,</span>
<span>             data <span class="op">=</span> <span class="va">Data</span>, </span>
<span>             index<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ciudad"</span>, <span class="st">"Periodo"</span><span class="op">)</span>, </span>
<span>             model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in pdata.frame(data, index): at least one NA in at least one index dimension in resulting pdata.frame
##  to find out which, use, e.g., table(index(your_pdataframe), useNA = "ifany")</code></pre>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">fixed</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = LINPC ~ Dummy_FIRMA + as.numeric(Periodo), data = Data, 
##     model = "within", index = c("Ciudad", "Periodo"))
## 
## Balanced Panel: n = 47, T = 243, N = 11421
## 
## Residuals:
##       Min.    1st Qu.     Median    3rd Qu.       Max. 
## -0.4337032 -0.0421466  0.0026796  0.0480377  0.2504866 
## 
## Coefficients:
##                        Estimate  Std. Error  t-value      Pr(&gt;|t|)    
## Dummy_FIRMA         -0.02239578  0.00417897  -5.3592 0.00000008525 ***
## as.numeric(Periodo)  0.00220318  0.00001032 213.4825     &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Total Sum of Squares:    330.79
## Residual Sum of Squares: 61.94
## R-Squared:      0.81275
## Adj. R-Squared: 0.81196
## F-statistic: 24680.5 on 2 and 11372 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div id="panel-var" class="section level3" number="7.1.5">
<h3>
<span class="header-section-number">7.1.5</span> Panel VAR<a class="anchor" aria-label="anchor" href="#panel-var"><i class="fas fa-link"></i></a>
</h3>
<p>En esta sección extenderemos el caso del modelo VAR(p) a uno en forma panel. En este caso asumimos que las variables exógenas son los <span class="math inline">\(p\)</span> rezagos de las <span class="math inline">\(k\)</span> variables endógenas. Consideremos el siguiente caso de un modelo panel VAR con efectos fijos –ciertamente es posible hacer estimaciones con efectos aleatorios, no obstante, requiere de supuestos adicionales que no contemplamos en estas notas–, el cual es la forma más común de estimación:
<span class="math display">\[\begin{equation}
    \mathbf{Y}_{it} = \mu_i + \sum_{l = 1}^p \mathbf{A}_l \mathbf{Y}_{i t - l} + \mathbf{B} \mathbf{X}_{it} + \varepsilon_{it}
   (\#eq:eq_PVAR)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{Y}_{it}\)</span> es un vector de variables endógenas estacionarias para la unidad de corte transversal <span class="math inline">\(i\)</span> en el tiempo <span class="math inline">\(t\)</span>, <span class="math inline">\(\mathbf{X}_{it}\)</span> es una matriz que contiene variables exógenas, y <span class="math inline">\(\varepsilon_{it}\)</span> es un término de error que cumple con:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[\varepsilon_{it}] &amp; = &amp; 0 \\
    Var[\varepsilon_{it}] &amp; = &amp; \Sigma_\varepsilon
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(\Sigma_\varepsilon\)</span> es una matriz definida positiva.</p>
<p>Para el porceso de estimación, la ecuación @ref(eq:eq_PVAR) se modifica en su versión en diferencias para quedar como:
<span class="math display">\[\begin{equation}
    \Delta \mathbf{Y}_{it} = \sum_{l = 1}^p \mathbf{A}_l \Delta \mathbf{Y}_{i t - l} + \mathbf{B} \Delta \mathbf{X}_{it} + \Delta \varepsilon_{it}
    (\#eq:eq_Dinamic_PVAR)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:eq_Dinamic_PVAR) se estima por un GMM.</p>
</div>
</div>
<div id="ejemplos-panel-varp" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Ejemplos: Panel VAR(p)<a class="anchor" aria-label="anchor" href="#ejemplos-panel-varp"><i class="fas fa-link"></i></a>
</h2>
<p>Dependencies and Setup</p>
<div id="ejemplo-1" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Ejemplo 1<a class="anchor" aria-label="anchor" href="#ejemplo-1"><i class="fas fa-link"></i></a>
</h3>
<p>We used the dynamic panel literature by Arellano and Bond (1991), Blundell and Bond (1998) and Roodman (2009b).
This data set describes employment, wages, capital and output of 140 firms in the United Kingdom from 1976 to 1984.
We estimate: Employment is explained by past values of employment (“l” lags), current and first lag of wages and output and current value of capital.</p>
<pre><code>##  [1] "c1"       "ind"      "year"     "emp"      "wage"     "cap"     
##  [7] "indoutpt" "n"        "w"        "k"        "ys"       "rec"     
## [13] "yearm1"   "id"       "nL1"      "nL2"      "wL1"      "kL1"     
## [19] "kL2"      "ysL1"     "ysL2"     "yr1976"   "yr1977"   "yr1978"  
## [25] "yr1979"   "yr1980"   "yr1981"   "yr1982"   "yr1983"   "yr1984"</code></pre>
<pre><code>##    c1 ind year   emp    wage    cap indoutpt        n        w          k
## 1 1-1   7 1977 5.041 13.1516 0.5894  95.7072 1.617604 2.576543 -0.5286502
## 2 2-1   7 1978 5.600 12.3018 0.6318  97.3569 1.722767 2.509746 -0.4591824
## 3 3-1   7 1979 5.015 12.8395 0.6771  99.6083 1.612433 2.552526 -0.3899363
## 4 4-1   7 1980 4.715 13.8039 0.6171 100.5501 1.550749 2.624951 -0.4827242
## 5 5-1   7 1981 4.093 14.2897 0.5076  99.5581 1.409278 2.659539 -0.6780615
## 6 6-1   7 1982 3.166 14.8681 0.4229  98.6151 1.152469 2.699218 -0.8606195
##         ys rec yearm1 id      nL1      nL2      wL1        kL1        kL2
## 1 4.561294   1   1977  1       NA       NA       NA         NA         NA
## 2 4.578383   2   1977  1 1.617604       NA 2.576543 -0.5286502         NA
## 3 4.601245   3   1978  1 1.722767 1.617604 2.509746 -0.4591824 -0.5286502
## 4 4.610656   4   1979  1 1.612433 1.722767 2.552526 -0.3899363 -0.4591824
## 5 4.600741   5   1980  1 1.550749 1.612433 2.624951 -0.4827242 -0.3899363
## 6 4.591224   6   1981  1 1.409278 1.550749 2.659539 -0.6780615 -0.4827242
##       ysL1     ysL2 yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983
## 1       NA       NA      0      1      0      0      0      0      0      0
## 2 4.561294       NA      0      0      1      0      0      0      0      0
## 3 4.578383 4.561294      0      0      0      1      0      0      0      0
## 4 4.601245 4.578383      0      0      0      0      1      0      0      0
## 5 4.610656 4.601245      0      0      0      0      0      1      0      0
## 6 4.600741 4.610656      0      0      0      0      0      0      1      0
##   yr1984
## 1      0
## 2      0
## 3      0
## 4      0
## 5      0
## 6      0</code></pre>
<p>Estimación</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#?pvargmm</span></span>
<span></span>
<span><span class="va">Arellano_Bond_1991_table4b</span> <span class="op">&lt;-</span> <span class="fu">pvargmm</span><span class="op">(</span> dependent_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,</span>
<span>                                       lags <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                       exog_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"wL1"</span>, <span class="st">"k"</span>, <span class="st">"ys"</span>, <span class="st">"ysL1"</span>, <span class="st">"yr1979"</span>, <span class="st">"yr1980"</span>, <span class="st">"yr1981"</span>, <span class="st">"yr1982"</span>,</span>
<span>                                                      <span class="st">"yr1983"</span>, <span class="st">"yr1984"</span><span class="op">)</span>,</span>
<span>                                       transformation <span class="op">=</span> <span class="st">"fd"</span>, data <span class="op">=</span> <span class="va">abdata</span>,  panel_identifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>                                       steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"twostep"</span><span class="op">)</span>,</span>
<span>                                       system_instruments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                       max_instr_dependent_vars <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                                       min_instr_dependent_vars <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                                       collapse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">Arellano_Bond_1991_table4b</span><span class="op">)</span></span></code></pre></div>
<p>
<b>Dynamic Panel VAR estimation, two-step GMM</b>
</p>
<p>
Transformation: <em>First-differences</em><br>Group variable: <em>id</em><br>Time variable: <em>year</em><br>Number of observations = <em>611</em><br>Number of groups = <em>140</em><br>Obs per group: min = <em>4</em><br>Obs per group: avg = <em>4.36428571428571</em><br>Obs per group: max = <em>6</em><br>Number of instruments = <em>38</em><br></p>
<div class="inline-table"><table class="texreg" style="margin: 10px;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<thead><tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
n
</th>
</tr></thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
lag1_n
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.4742<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1854)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag2_n
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0530
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0517)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
w
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.5132<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1456)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
wL1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2246
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1419)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
k
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2927<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0626)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
ys
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.6098<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1563)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
ysL1
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.4464<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2173)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1979
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0105
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0099)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1980
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0247
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0158)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1981
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0158
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0267)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1982
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0374
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0300)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1983
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0393
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0347)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
yr1984
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0495
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0349)
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="font-size: 0.8em;" colspan="2">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr></tfoot>
</table></div>
<p>
<b>Instruments for equation </b>
</p>
<p>
Standard<br><em>w, wL1, k, ys, ysL1, yr1979, yr1980, yr1981, yr1982, yr1983, yr1984</em>
</p>
<p>
GMM-type<br><em>Dependent vars: L(2,6))<br>Collapse = FALSE</em>
</p>
<p>
<b>Hansen test of overid. restrictions:</b> <em>chi2(25) = 30.11 Prob &gt; chi2 = 0.22<br>(Robust, but weakened by many instruments.)</em><br></p>
</div>
<div id="ejemplo-2" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Ejemplo 2:<a class="anchor" aria-label="anchor" href="#ejemplo-2"><i class="fas fa-link"></i></a>
</h3>
<p>We used the panel data set consists of 265 Swedish municipalities and covers 9 years (1979-1987).
These variables include total expenditures (expenditures), total own-source revenues (revenues) and intergovernmental grants received by the municipality (grants).
Source: Dahlberg and Johansson (2000)</p>
<p>Grants from the central to the local government are of three kinds: support to municipalities with small tax capacity, grants toward the running of certain local government activities and grants toward certain investments.</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Dahlberg"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Dahlberg</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "id"           "year"         "expenditures" "revenues"     "grants"</code></pre>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Dahlberg</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    id year expenditures  revenues    grants
## 1 114 1979    0.0229736 0.0181770 0.0054429
## 2 114 1980    0.0266307 0.0209142 0.0057304
## 3 114 1981    0.0273253 0.0210836 0.0056647
## 4 114 1982    0.0288704 0.0234310 0.0058859
## 5 114 1983    0.0226474 0.0179979 0.0055908
## 6 114 1984    0.0215601 0.0179949 0.0047536</code></pre>
<p>Estimación:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1_dahlberg_data</span> <span class="op">&lt;-</span> <span class="fu">pvargmm</span><span class="op">(</span>dependent_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"expenditures"</span>, <span class="st">"revenues"</span>, <span class="st">"grants"</span><span class="op">)</span>,</span>
<span>          lags <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          transformation <span class="op">=</span> <span class="st">"fod"</span>,</span>
<span>          data <span class="op">=</span> <span class="va">Dahlberg</span>,</span>
<span>          panel_identifier<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>          steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"twostep"</span><span class="op">)</span>,</span>
<span>          system_instruments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          max_instr_dependent_vars <span class="op">=</span> <span class="fl">99</span>,</span>
<span>          max_instr_predet_vars <span class="op">=</span> <span class="fl">99</span>,</span>
<span>          min_instr_dependent_vars <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>          min_instr_predet_vars <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>          collapse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in pvargmm(dependent_vars = c("expenditures", "revenues", "grants"), :
## The matrix D_e is singular, therefore the general inverse is used</code></pre>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">ex1_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<p>
<b>Dynamic Panel VAR estimation, two-step GMM</b>
</p>
<p>
Transformation: <em>Forward orthogonal deviations</em><br>Group variable: <em>id</em><br>Time variable: <em>year</em><br>Number of observations = <em>1855</em><br>Number of groups = <em>265</em><br>Obs per group: min = <em>7</em><br>Obs per group: avg = <em>7</em><br>Obs per group: max = <em>7</em><br>Number of instruments = <em>252</em><br></p>
<div class="inline-table"><table class="texreg" style="margin: 10px;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<thead><tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
expenditures
</th>
<th style="padding-left: 5px;padding-right: 5px;">
revenues
</th>
<th style="padding-left: 5px;padding-right: 5px;">
grants
</th>
</tr></thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
lag1_expenditures
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2846<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2583<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0167
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0664)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0795)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0172)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag1_revenues
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0470
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0588
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0405<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0637)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0726)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0151)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag1_grants
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.6746<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-2.2367<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.3204<sup>***</sup>
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2818)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2846)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0521)
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="font-size: 0.8em;" colspan="4">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr></tfoot>
</table></div>
<p>
<b>Instruments for equation </b>
</p>
<p>
Standard<br><em></em>
</p>
<p>
GMM-type<br><em>Dependent vars: L(2,7))<br>Collapse = FALSE</em>
</p>
<p>
<b>Hansen test of overid. restrictions:</b> <em>chi2(243) = 263.01 Prob &gt; chi2 = 0.18<br>(Robust, but weakened by many instruments.)</em><br></p>
<p>Model selection procedure of Andrews and Lu (2001) to select the optimal lag length for our example</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Andrews_Lu_MMSC</span><span class="op">(</span><span class="va">ex1_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $MMSC_BIC
## [1] -1610.877
## 
## $MMSC_AIC
## [1] -234.9924
## 
## $MMSC_HQIC
## [1] -792.3698</code></pre>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex2_dahlberg_data</span> <span class="op">&lt;-</span> <span class="fu">pvargmm</span><span class="op">(</span>dependent_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"expenditures"</span>, <span class="st">"revenues"</span>, <span class="st">"grants"</span><span class="op">)</span>,</span>
<span>                             lags <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                             transformation <span class="op">=</span> <span class="st">"fod"</span>,</span>
<span>                             data <span class="op">=</span> <span class="va">Dahlberg</span>,</span>
<span>                             panel_identifier<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"year"</span><span class="op">)</span>,</span>
<span>                             steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"twostep"</span><span class="op">)</span>,</span>
<span>                             system_instruments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             max_instr_dependent_vars <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                             max_instr_predet_vars <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                             min_instr_dependent_vars <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>                             min_instr_predet_vars <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>                             collapse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in pvargmm(dependent_vars = c("expenditures", "revenues", "grants"), :
## The matrix D_e is singular, therefore the general inverse is used</code></pre>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">ex2_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<p>
<b>Dynamic Panel VAR estimation, two-step GMM</b>
</p>
<p>
Transformation: <em>Forward orthogonal deviations</em><br>Group variable: <em>id</em><br>Time variable: <em>year</em><br>Number of observations = <em>1590</em><br>Number of groups = <em>265</em><br>Obs per group: min = <em>6</em><br>Obs per group: avg = <em>6</em><br>Obs per group: max = <em>6</em><br>Number of instruments = <em>243</em><br></p>
<div class="inline-table"><table class="texreg" style="margin: 10px;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<thead><tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
expenditures
</th>
<th style="padding-left: 5px;padding-right: 5px;">
revenues
</th>
<th style="padding-left: 5px;padding-right: 5px;">
grants
</th>
</tr></thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
lag1_expenditures
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2572<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.2486<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0135
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0893)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1018)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0178)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag1_revenues
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.1219
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0634
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0293
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0879)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0997)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0171)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag1_grants
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.0718<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-3.5849<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.1581<sup>*</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.5941)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.6168)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0636)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag2_expenditures
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0247
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0252
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0178
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0791)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0834)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0157)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag2_revenues
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2584<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.2446<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.0237
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0785)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0800)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0157)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
lag2_grants
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.5265<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.6687<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.0702
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.1873)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.2113)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.0586)
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="font-size: 0.8em;" colspan="4">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr></tfoot>
</table></div>
<p>
<b>Instruments for equation </b>
</p>
<p>
Standard<br><em></em>
</p>
<p>
GMM-type<br><em>Dependent vars: L(2,6))<br>Collapse = FALSE</em>
</p>
<p>
<b>Hansen test of overid. restrictions:</b> <em>chi2(225) = 260.11 Prob &gt; chi2 = 0.054<br>(Robust, but weakened by many instruments.)</em><br></p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Andrews_Lu_MMSC</span><span class="op">(</span><span class="va">ex2_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code>## $MMSC_BIC
## [1] -1486.935
## 
## $MMSC_AIC
## [1] -213.8917
## 
## $MMSC_HQIC
## [1] -734.1071</code></pre>
<p>Sstability of the autoregressive process:</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stab_ex1_dahlberg_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vars/man/stability.html">stability</a></span><span class="op">(</span><span class="va">ex1_dahlberg_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">stab_ex1_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Eigenvalue stability condition:
## 
##              Eigenvalue    Modulus
## 1 0.5370657+0.00000000i 0.53706574
## 2 0.0633651+0.06442426i 0.09036383
## 3 0.0633651-0.06442426i 0.09036383
## 
## All the eigenvalues lie inside the unit circle.
## PVAR satisfies stability condition.</code></pre>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">stab_ex1_dahlberg_data</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-61-1.png" width="672"></div>
<p>Generate impulse response functions.</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ex1_dahlberg_data_oirf &lt;-  oirf(ex1_dahlberg_data, n.ahead = 8)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ex1_dahlberg_data_girf &lt;-  girf(ex1_dahlberg_data, n.ahead = 8, ma_approx_steps= 8)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ex1_dahlberg_data_bs &lt;-  bootstrap_irf(ex1_dahlberg_data, typeof_irf = c("GIRF"),</span></span>
<span><span class="co">#                                        n.ahead = 8,</span></span>
<span><span class="co">#                                        nof_Nstar_draws = 500,</span></span>
<span><span class="co">#                                        confidence.band = 0.95)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># plot(ex1_dahlberg_data_girf, ex1_dahlberg_data_bs)</span></span></code></pre></div>
</div>
</div>
<div id="cointegración-1" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Cointegración<a class="anchor" aria-label="anchor" href="#cointegraci%C3%B3n-1"><i class="fas fa-link"></i></a>
</h2>
<p>[PENDIENTE]</p>
</div>
<div id="modelos-no-lineales" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Modelos No Lineales<a class="anchor" aria-label="anchor" href="#modelos-no-lineales"><i class="fas fa-link"></i></a>
</h2>
<div id="modelos-de-cambio-de-régimen" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> Modelos de cambio de régimen<a class="anchor" aria-label="anchor" href="#modelos-de-cambio-de-r%C3%A9gimen"><i class="fas fa-link"></i></a>
</h3>
<p>En años recientes, los modelos de serie de tiempo han sido incorporados en análisis de la existencia de diferentes estados que son generados por procesos estocásticos subyacentes. En esta sección del curso revisaremos algunos modelos de cambio de régimen. Restringimos nuestra revisión a modelos que asuman que la dinámica de las series puede ser descrita por modelos del tipo AR y dejamos fuera procesos del tipo MA.</p>
En general distinguimos que existen dos tipos de modelos:
</div>
<div id="regímenes-determinados-por-información-observable" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Regímenes determinados por información observable<a class="anchor" aria-label="anchor" href="#reg%C3%ADmenes-determinados-por-informaci%C3%B3n-observable"><i class="fas fa-link"></i></a>
</h3>
<p>En estos casos asumimos que el régimen ocurre en un momento <span class="math inline">\(t\)</span> y puede ser determinado por una variable observable. Este modelo es conocido como el modelo autoregresivo con umbral (TAR, Threshold Autoregressive model). En este caso también diremos que cuando el régimen está determinado por la información de la misma serie será llamado Self-Exciting TAR (SETAR).</p>
<p>Veámos un caso particular. Supongamos que existe un umbral, <span class="math inline">\(c\)</span>, para el régimen que está determinado por <span class="math inline">\(q_t = y_{t-1}\)</span> y que el estado de la naturaleza nos permite establecer dos estados o regímenes:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \varepsilon_t \text{ si } y_{t-1} \leq c \\
        \phi_{02} + \phi_{12} y_{t-1} + \varepsilon_t \text{ si } y_{t-1} &gt; c
    \end{cases}
\end{equation}\]</span></p>
<p>Donde asumiremos que <span class="math inline">\(\varepsilon_t\)</span> es i.i.d y que cumple con:
<span class="math display">\[\begin{equation*}
    \mathbb{E}[\varepsilon_t | \Omega_{t-1}] = 0
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(\Omega_{t-1} = \{ y_{t-1}, y_{t-2}, \ldots \}\)</span>. Existe una variante de este modelo que suaviza la transición entre regímenes conocido como Smooth Transition AR (STAR) y puede ser especificada en su modalidad de dos regímenes como:
<span class="math display">\[\begin{equation}
    y_t = (\phi_{01} + \phi_{11} y_{t-1}) (1 - G(y_{t-1}; \gamma, c)) + (\phi_{02} + \phi_{12} y_{t-1}) G(y_{t-1}; \gamma, c) + \varepsilon_t
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(G(y_{t-1}; \gamma, c)\)</span> es una función de distribución de probabilidad que suaviza la transición entre regímenes. La práctica común es suponer que esta tiene una forma logística:
<span class="math display">\[\begin{equation}
    G(y_{t-1}; \gamma, c) = \frac{1}{1 + e^{-\gamma (y_{t-1} - c)}}
\end{equation}\]</span></p>
<p>Es posible hacer extensiones de lo anterior a modelos de orden superior; dando como resultado:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \phi_{21} y_{t-2} + \ldots + \phi_{p_1 1} y_{t-p_1} + \varepsilon_t \text{ si } y_{t-1} \leq c \\
        \phi_{02} + \phi_{12} y_{t-1} + \phi_{22} y_{t-2} + \ldots + \phi_{p_2 2} y_{t-p_2} + \varepsilon_t \text{ si } y_{t-1} &gt; c
    \end{cases}
\end{equation}\]</span></p>
<p>En el segundo caso:
<span class="math display">\[\begin{eqnarray*}
    y_t &amp; = &amp; (\phi_{01} + \phi_{11} y_{t-1} + \phi_{21} y_{t-2} + \ldots + \phi_{p_1 1} y_{t-p_1}) (1 - G(y_{t-1}; \gamma, c)) \\
    &amp;  &amp; + (\phi_{02} + \phi_{12} y_{t-1} + \phi_{22} y_{t-2} + \ldots + \phi_{p_2 2} y_{t-p_2}) G(y_{t-1}; \gamma, c) \\
    &amp;  &amp; + \varepsilon_t
\end{eqnarray*}\]</span></p>
<p>De igual forma que en el caso de los modelos ARIMA y VAR, el número de rezagos utilizados es determinado mediante el uso de criterios de información como el de Akaike:
<span class="math display">\[\begin{equation}
    AIC(p_1, p_2) = n_1 ln(\hat{\sigma}^2_1) + n_2 ln(\hat{\sigma}^2_2) + 2(p_1 + 1) + 2(p_2 + 1)
\end{equation}\]</span></p>
Los modelos SETAR y STAR generan procesos estacionarios siempre que cumplan ciertas condiciones. En estas notas nos enfocaremos únicamente en el modelo SETAR; el cual genera en un proceso estacionario cuando:
<p>Finalmente, en ocasiones podemos estar interesados en modelos donde los regímenes sean más de 2, es decir, digamos <span class="math inline">\(m\)</span> umbrales bajo un modelo SETAR o STAR. Por ejemplo, en el caso de un modelo SETAR podemos verificar que <span class="math inline">\(m\)</span> regímenes implican <span class="math inline">\(m + 1\)</span> umbrales: <span class="math inline">\(c_0, c_1, \ldots, c_m\)</span>. En cuyo caso:
<span class="math display">\[\begin{equation*}
    -\infty = c_0 &lt; c_1 &lt; \ldots &lt; c_{m-1} &lt; c_m = \infty
\end{equation*}\]</span></p>
<p>Así, tendríamos ecuaciones:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0j} + \phi_{ij} y_{t-1} + \varepsilon_t \text{ si } c_{j-1} &lt; y_{t-1} &lt; c_j
\end{equation}\]</span></p>
<p>Para <span class="math inline">\(j = 1, 2, \ldots, m\)</span>. De forma similar, podemos recomponer el modelo STAR.</p>
</div>
<div id="regímenes-determinados-por-variables-no-observables" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> Regímenes determinados por variables no observables<a class="anchor" aria-label="anchor" href="#reg%C3%ADmenes-determinados-por-variables-no-observables"><i class="fas fa-link"></i></a>
</h3>
<p>Este tipo de modelos asume que el régimen ocurre en el momento <span class="math inline">\(t\)</span> y que no puede ser observado, ya que este es determinado por un proceso no observable, el cual denotamos como <span class="math inline">\(s_t\)</span>. En el caso de dos regímenes, <span class="math inline">\(s_t\)</span> puede ser asumido como que toma 2 valores: 1 y 2, por ejemplo. Supongamos que el proceso subyacente tiene una forma del tipo AR(1) dado por:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \varepsilon_t \text{ si } s_t = 1 \\
        \phi_{02} + \phi_{12} y_{t-1} + \varepsilon_t \text{ si } s_t = 2
    \end{cases}
    \label{eq_swching_obs}
\end{equation}\]</span></p>
<p>O en un formato más corto de notación:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0 s_t} + \phi_{1 s_t} y_{t-1} + \varepsilon_t
\end{equation}\]</span></p>
<p>Para complementar el modelo, las propiedades del proceso <span class="math inline">\(s_t\)</span> necesitan ser especificadas. El modelo más popular dentro de esta familia es el propuesto por James Hamilton en 1989, el cual es conocido como Markov Switching Model (MSM), en el cual el proceso <span class="math inline">\(s_t\)</span> se asume como un proceso de Markov de primer orden. Esto implica que el régimen actual <span class="math inline">\(s_t\)</span> sólo depende del período <span class="math inline">\(s_{t-1}\)</span>.</p>
<p>Así, el modelo es completado mediante la definición de las probabilidades de transición para moverse del un estado a otro:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{P}(s_t = 1 | s_{t-1} = 1) &amp; = &amp; p_{11} \\
    \mathbb{P}(s_t = 2 | s_{t-1} = 1) &amp; = &amp; p_{12} \\
    \mathbb{P}(s_t = 1 | s_{t-1} = 2) &amp; = &amp; p_{21} \\
    \mathbb{P}(s_t = 2 | s_{t-1} = 2) &amp; = &amp; p_{22}
\end{eqnarray*}\]</span></p>
<p>Así, <span class="math inline">\(p_{ij}\)</span> es igual a la probabilidad de que la cadena de Markov pase del estado <span class="math inline">\(i\)</span> en el momento <span class="math inline">\(t-1\)</span> al estado <span class="math inline">\(j\)</span> en el tiempo <span class="math inline">\(t\)</span>. En todo caso asumiremos que <span class="math inline">\(p_{ij} &gt; 0\)</span> y que:
<span class="math display">\[\begin{eqnarray*}
    p_{11} + p_{12} = 1 \\
    p_{21} + p_{22} = 1
\end{eqnarray*}\]</span></p>
<p>Otro tipo de probabilidades a analizar son las probabilidades incondicionales de <span class="math inline">\(\mathbb{P}(s_t = i)\)</span>, <span class="math inline">\(i = 1, 2\)</span>. Usando la teoría ergódica de las cadenas de Markov, estas probabilidades están dadas por:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{P}(s_t = 1) &amp; = &amp; \frac{1 - p_{22}}{2 - p_{11} - p_{22}} \\
    \mathbb{P}(s_t = 2) &amp; = &amp; \frac{1 - p_{11}}{2 - p_{11} - p_{22}}
\end{eqnarray*}\]</span></p>
<p>Un caso más general es el de múltiples regímenes en el cual <span class="math inline">\(s_t\)</span> puede tomar cualquier valor <span class="math inline">\(m &gt; 2\)</span>, <span class="math inline">\(m \in \mathbb{N}\)</span>. Este modelo se puede escribir como:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0j} + \phi_{1j} y_{t-1} + \varepsilon_t \text{ si } s_t = j \text{, para } j = 1, 2, \ldots, m
\end{equation}\]</span></p>
<p>Donde las probabilidades de transición estarán dadas por:
<span class="math display">\[\begin{equation}
    p_{ij} = \mathbb{P}(s_t = j | s_{t-1} = i) \text{ para } i , j = 1, 2, \ldots, m
\end{equation}\]</span></p>
<p>Donde la ecuación anterior satisface que <span class="math inline">\(p_{ij} &gt; 0\)</span>, <span class="math inline">\(\forall i, j = = 1, 2, \ldots, m\)</span> y que:
<span class="math display">\[\begin{equation*}
    \sum_{j=1}^m p_{ij} = 1 \text{ para } i = 1, 2, \ldots, m
\end{equation*}\]</span></p>
Finalmente, plantearemos el procedimiento empírico seguido para la estimación de este tipo de modelos:
</div>
</div>
<div id="ejemplo-modelos-de-cambio-de-regímen-tar" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Ejemplo: Modelos de Cambio de Regímen (TAR)<a class="anchor" aria-label="anchor" href="#ejemplo-modelos-de-cambio-de-reg%C3%ADmen-tar"><i class="fas fa-link"></i></a>
</h2>
<p>Dependencies and Setup:</p>
<p>Data: Monthly rates of deaths due to flu in the United States for 11 years</p>
<pre><code>##   X.8113721
## 1 0.4458291
## 2 0.3415985
## 3 0.2774243
## 4 0.2484958
## 5 0.2525427
## 6 0.2466902</code></pre>
<p>Convert time series</p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">flu</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_flu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">flu</span>, lag <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Plotting</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">flu</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"darkred"</span>, ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Monthly rates of deaths due to flu in the United States"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-65-1.png" width="672"></div>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">D_flu</span>, type<span class="op">=</span><span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"darkred"</span>, ylab <span class="op">=</span> <span class="st">""</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Diff Monthly rates of deaths due to flu in the United States"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-65-2.png" width="672"></div>
<p>The tsDyn package in R has simplified this code into a handful of steps:</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#?setar</span></span>
<span></span>
<span><span class="va">D_flu_tar4_05</span> <span class="op">&lt;-</span> <span class="fu">setar</span><span class="op">(</span><span class="va">D_flu</span>, m <span class="op">=</span> <span class="fl">4</span>, thDelay <span class="op">=</span> <span class="fl">0</span>, th <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> </span></code></pre></div>
<pre><code>## Warning: 
## With the threshold you gave (0.05) there is a regime with less than trim=15% observations (86.51%, 13.49%, )</code></pre>
<pre><code>## Warning: Possible unit root in the high regime. Roots are: 0.6182 0.6244 0.6244
## 0.6182</code></pre>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">D_flu_tar4_05</span><span class="op">)</span> </span></code></pre></div>
<pre><code>## 
## Non linear autoregressive model
## 
## SETAR model ( 2 regimes)
## Coefficients:
## Low regime:
##      const.L       phiL.1       phiL.2       phiL.3       phiL.4 
##  0.004432028  0.501179574 -0.206693004  0.120140800 -0.122254140 
## 
## High regime:
##    const.H     phiH.1     phiH.2     phiH.3     phiH.4 
##  0.4079353 -0.7483325 -1.0323129 -2.0450407 -6.7117769 
## 
## Threshold:
## -Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)+ (0)X(t-3)
## -Value: 0.05 (fixed)
## Proportion of points in low regime: 86.51%    High regime: 13.49% 
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.1319314 -0.0217073  0.0015801  0.0196093  0.2674245 
## 
## Fit:
## residuals variance = 0.002166,  AIC = -778, MAPE = 412.4%
## 
## Coefficient(s):
## 
##           Estimate  Std. Error  t value  Pr(&gt;|t|)    
## const.L  0.0044320   0.0051791   0.8558 0.3938357    
## phiL.1   0.5011796   0.0833821   6.0106 2.043e-08 ***
## phiL.2  -0.2066930   0.0608839  -3.3949 0.0009313 ***
## phiL.3   0.1201408   0.0576505   2.0839 0.0392868 *  
## phiL.4  -0.1222541   0.0522363  -2.3404 0.0209137 *  
## const.H  0.4079353   0.0314121  12.9866 &lt; 2.2e-16 ***
## phiH.1  -0.7483325   0.1118329  -6.6915 7.455e-10 ***
## phiH.2  -1.0323129   0.1420203  -7.2688 4.018e-11 ***
## phiH.3  -2.0450407   0.7055163  -2.8986 0.0044573 ** 
## phiH.4  -6.7117769   0.8367945  -8.0208 7.911e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Threshold
## Variable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)+ (0) X(t-3)
## 
## Value: 0.05 (fixed)</code></pre>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">D_flu_tar4_05</span><span class="op">)</span></span></code></pre></div>
<p><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-1.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-2.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-3.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-4.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-5.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-6.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-7.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-8.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-9.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-67-10.png" width="672"></p>
<p>If we do not provide a threshold to the th option, setar searches over a grid to choose a threshold ~ 0.038:</p>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D_flu_tar4</span> <span class="op">&lt;-</span> <span class="fu">setar</span><span class="op">(</span><span class="va">D_flu</span>, m <span class="op">=</span> <span class="fl">4</span>, thDelay <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Possible unit root in the high regime. Roots are: 0.6316 0.7222 0.7222
## 0.6316</code></pre>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">D_flu_tar4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Non linear autoregressive model
## 
## SETAR model ( 2 regimes)
## Coefficients:
## Low regime:
##        const.L         phiL.1         phiL.2         phiL.3         phiL.4 
## -0.00006287604  0.44640751264 -0.23158878472  0.10701408961 -0.14406085874 
## 
## High regime:
##    const.H     phiH.1     phiH.2     phiH.3     phiH.4 
##  0.3486150 -0.5903335 -1.0318488 -2.4053812 -4.8052422 
## 
## Threshold:
## -Variable: Z(t) = + (1) X(t)+ (0)X(t-1)+ (0)X(t-2)+ (0)X(t-3)
## -Value: 0.03798
## Proportion of points in low regime: 84.92%    High regime: 15.08% 
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.277686 -0.020554  0.005116  0.020762  0.119627 
## 
## Fit:
## residuals variance = 0.002405,  AIC = -762, MAPE = 372.5%
## 
## Coefficient(s):
## 
##             Estimate   Std. Error  t value  Pr(&gt;|t|)    
## const.L -0.000062876  0.005572290  -0.0113 0.9910158    
## phiL.1   0.446407513  0.089159422   5.0068 1.921e-06 ***
## phiL.2  -0.231588785  0.064328877  -3.6001 0.0004636 ***
## phiL.3   0.107014090  0.061034049   1.7534 0.0820953 .  
## phiL.4  -0.144060859  0.055198346  -2.6099 0.0102109 *  
## const.H  0.348615027  0.027460007  12.6954 &lt; 2.2e-16 ***
## phiH.1  -0.590333531  0.109881869  -5.3724 3.869e-07 ***
## phiH.2  -1.031848767  0.149570541  -6.8987 2.641e-10 ***
## phiH.3  -2.405381238  0.691344783  -3.4793 0.0007014 ***
## phiH.4  -4.805242210  0.828241480  -5.8017 5.451e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Threshold
## Variable: Z(t) = + (1) X(t) + (0) X(t-1)+ (0) X(t-2)+ (0) X(t-3)
## 
## Value: 0.03798</code></pre>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">D_flu_tar4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-1.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-2.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-3.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-4.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-5.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-6.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-7.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-8.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-9.png" width="672"><img src="Notas-Series-Tiempo_files/figure-html/unnamed-chunk-68-10.png" width="672"></p>

</div>
</div>






  <div class="chapter-nav">
<div class="prev"><a href="modelos-univariados-y-multivariados-de-volatilidad.html"><span class="header-section-number">6</span> Modelos Univariados y Multivariados de Volatilidad</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales"><span class="header-section-number">7</span> Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales</a></li>
<li>
<a class="nav-link" href="#modelos-de-datos-panel-y-panel-var"><span class="header-section-number">7.1</span> Modelos de Datos Panel y Panel VAR</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#motivaci%C3%B3n-2"><span class="header-section-number">7.1.1</span> Motivación</a></li>
<li><a class="nav-link" href="#pruebas-de-ra%C3%ADces-unitarias-en-panel"><span class="header-section-number">7.1.2</span> Pruebas de Raíces Unitarias en Panel</a></li>
<li><a class="nav-link" href="#ejemplo-pruebas-de-ra%C3%ADces-unitarias-en-panel"><span class="header-section-number">7.1.3</span> Ejemplo: Pruebas de Raíces Unitarias en Panel</a></li>
<li><a class="nav-link" href="#ejemplo-modelo-dif-in-dif-para-el-inpc-de-an%C3%A1lisis-cl%C3%ADnicos-update-nov-2022"><span class="header-section-number">7.1.4</span> Ejemplo: Modelo Dif-in-Dif para el INPC de análisis clínicos (update nov-2022)</a></li>
<li><a class="nav-link" href="#panel-var"><span class="header-section-number">7.1.5</span> Panel VAR</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ejemplos-panel-varp"><span class="header-section-number">7.2</span> Ejemplos: Panel VAR(p)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ejemplo-1"><span class="header-section-number">7.2.1</span> Ejemplo 1</a></li>
<li><a class="nav-link" href="#ejemplo-2"><span class="header-section-number">7.2.2</span> Ejemplo 2:</a></li>
</ul>
</li>
<li><a class="nav-link" href="#cointegraci%C3%B3n-1"><span class="header-section-number">7.3</span> Cointegración</a></li>
<li>
<a class="nav-link" href="#modelos-no-lineales"><span class="header-section-number">7.4</span> Modelos No Lineales</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelos-de-cambio-de-r%C3%A9gimen"><span class="header-section-number">7.4.1</span> Modelos de cambio de régimen</a></li>
<li><a class="nav-link" href="#reg%C3%ADmenes-determinados-por-informaci%C3%B3n-observable"><span class="header-section-number">7.4.2</span> Regímenes determinados por información observable</a></li>
<li><a class="nav-link" href="#reg%C3%ADmenes-determinados-por-variables-no-observables"><span class="header-section-number">7.4.3</span> Regímenes determinados por variables no observables</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ejemplo-modelos-de-cambio-de-reg%C3%ADmen-tar"><span class="header-section-number">7.5</span> Ejemplo: Modelos de Cambio de Regímen (TAR)</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notas de Clase: Series de Tiempo</strong>" was written by Benjamín Oliva, Omar Alfaro Rivera &amp; Emiliano Pérez Caullieres. It was last built on 2025-08-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
