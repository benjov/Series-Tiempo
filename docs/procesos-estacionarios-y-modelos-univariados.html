<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Procesos Estacionarios y Modelos Univariados | Notas de Clase: Series de Tiempo</title>
<meta name="author" content="Benjamín Oliva, Omar Alfaro Rivera, Emiliano Pérez Caullieres &amp; Luis Gerardo Ruíz">
<meta name="description" content="3.1 Definición de ergodicidad y estacionariedad A partir de esta sección introduciremos mayor formalidad matemática al análisis de las series de tiempo. Por ello cambiaremos un poco la notación y...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 3 Procesos Estacionarios y Modelos Univariados | Notas de Clase: Series de Tiempo">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 Definición de ergodicidad y estacionariedad A partir de esta sección introduciremos mayor formalidad matemática al análisis de las series de tiempo. Por ello cambiaremos un poco la notación y...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Procesos Estacionarios y Modelos Univariados | Notas de Clase: Series de Tiempo">
<meta name="twitter:description" content="3.1 Definición de ergodicidad y estacionariedad A partir de esta sección introduciremos mayor formalidad matemática al análisis de las series de tiempo. Por ello cambiaremos un poco la notación y...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notas de Clase: Series de Tiempo</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Análisis de Series de Tiempo</a></li>
<li><a class="" href="introducci%C3%B3n.html"><span class="header-section-number">1</span> Introducción</a></li>
<li><a class="" href="introducci%C3%B3n-al-an%C3%A1lisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><span class="header-section-number">2</span> Introducción al Análisis de Series de Tiempo y Elementos de Ecuaciones en Diferencia</a></li>
<li><a class="active" href="procesos-estacionarios-y-modelos-univariados.html"><span class="header-section-number">3</span> Procesos Estacionarios y Modelos Univariados</a></li>
<li><a class="" href="procesos-no-estacionarios-univariados.html"><span class="header-section-number">4</span> Procesos No Estacionarios Univariados</a></li>
<li><a class="" href="causalidad-de-granger-modelos-multivariados-de-vectores-autoregresivos-y-de-cointegraci%C3%B3n-modelos-ardl-y-filtro-multivariado.html"><span class="header-section-number">5</span> Causalidad de Granger, Modelos Multivariados de Vectores Autoregresivos y de Cointegración, Modelos ARDL y Filtro Multivariado</a></li>
<li><a class="" href="modelos-univariados-y-multivariados-de-volatilidad.html"><span class="header-section-number">6</span> Modelos Univariados y Multivariados de Volatilidad</a></li>
<li><a class="" href="modelos-de-datos-panel-panel-var-y-otros-modelos-no-lineales.html"><span class="header-section-number">7</span> Modelos de Datos Panel, Panel VAR y otros Modelos No Lineales</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="procesos-estacionarios-y-modelos-univariados" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Procesos Estacionarios y Modelos Univariados<a class="anchor" aria-label="anchor" href="#procesos-estacionarios-y-modelos-univariados"><i class="fas fa-link"></i></a>
</h1>
<div id="definición-de-ergodicidad-y-estacionariedad" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Definición de ergodicidad y estacionariedad<a class="anchor" aria-label="anchor" href="#definici%C3%B3n-de-ergodicidad-y-estacionariedad"><i class="fas fa-link"></i></a>
</h2>
<p>A partir de esta sección introduciremos mayor formalidad matemática al análisis de las series de tiempo. Por ello cambiaremos un poco la notación y ocuparemos a <span class="math inline">\(X_t\)</span> en lugar de <span class="math inline">\(Z_t\)</span> como objeto de nuestro análisis. Con <span class="math inline">\(X_t\)</span> denotaremos a una serie de tiempo, ya que con <span class="math inline">\(Z_t\)</span> denotaremos a una variable, sin que ella fuera necesariamente una serie de tiempo en los términos que a continuación discutimos. Asimismo, iniciaremos por establecer una serie de definiciones.</p>
<p>De esta forma, definiremos a una <em>serie de tiempo</em> como un vector de variables aleatorias de dimensión <span class="math inline">\(T\)</span>, dado como:
<span class="math display" id="eq:Serie0">\[\begin{equation}
    X_1, X_2, X_3, \ldots ,X_T
    \tag{3.1}
\end{equation}\]</span></p>
<p>Cada una de las <span class="math inline">\(X_t\)</span> (<span class="math inline">\(t = 1, 2, \ldots, T\)</span>) consideradas como una variable aleatoria. Así, también podemos denotar a la serie de tiempo como:
<span class="math display" id="eq:Serie">\[\begin{equation}
    \{ X_t \}^T_{t = 1}
    \tag{3.2}
\end{equation}\]</span></p>
<p>Es decir, definiremos a <em>una serie de tiempo como una realización de un proceso estocástico</em> –o un Proceso Generador de Datos (PGD). Consideremos una muestra de los múltiples posibles resultados de muestras de tamaño <span class="math inline">\(T\)</span>, la colección dada por:
<span class="math display" id="eq:Serie1">\[\begin{equation}
    \{X^{(1)}_1, X^{(1)}_2, \ldots, X^{(1)}_T\}
    \tag{3.3}
\end{equation}\]</span></p>
<p>Digamos que la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:Serie1">(3.3)</a> es una de las tantas posibles resultantes del proceso estocástico o PGD. Eventualmente podríamos estar dispuestos a observar este proceso indefinidamente, de forma tal que estemos interesados en la secuencia dada por <span class="math inline">\(\{ X^{(1)}_t \}^{\infty}_{t = 1}\)</span>, lo cual no dejaría de ser sólo una de las tantas realizaciones o secuencias del proceso estocástico original.</p>
<p>Tan solo por poner un ejemplo, podríamos observar las siguientes realizaciones del mismo PGD:
<span class="math display">\[\begin{eqnarray*}
    &amp; \{X^{(2)}_1, X^{(2)}_2, \ldots, X^{(2)}_T\} &amp; \\
    &amp; \{X^{(3)}_1, X^{(3)}_2, \ldots, X^{(3)}_T\} &amp; \\
    &amp; \{X^{(4)}_1, X^{(4)}_2, \ldots, X^{(4)}_T\} &amp; \\
    &amp; \vdots &amp; \\
    &amp; \{X^{(j)}_1, X^{(j)}_2, \ldots, X^{(j)}_T\} &amp;
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(j \in \mathbb{Z}\)</span>. En lo subsecuente, diremos que una serie de tiempo es una realización del proceso estocástico subyacente. Considerando, en consecuencia, al proceso estocástico con todas sus posibilidades de realización.</p>
<p>Para hacer más sencilla la notación no distinguiremos entre el proceso en sí mismo y una de sus realizaciones, es decir, siempre escribiremos a una serie de tiempo como la secuencia mostrada en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:Serie">(3.2)</a>, o más precisamente como la siguiente realización:
<span class="math display" id="eq:Serie2">\[\begin{equation}
    \{ X_1, X_2, \ldots, X_T \}
    \tag{3.4}
\end{equation}\]</span></p>
<p>O simplemente:
<span class="math display" id="eq:Serie3">\[\begin{equation}
    X_1, X_2, \ldots, X_T
    \tag{3.5}
\end{equation}\]</span></p>
<p>El proceso estocástico de dimensión <span class="math inline">\(T\)</span> puede ser completamente descrito por su función de distribución multivariada de dimensión <span class="math inline">\(T\)</span>. No obstante, esto no resulta ser práctico cuando se opere más adelante en el curso. Por ello, en el curso y, en general, en casi todos los textos lo hacen, sólo nos enfocaremos en sus primero y segundo momentos. Es decir, en sus media o valor esperado:
<span class="math display">\[\begin{equation*}
    \mathbb{E}[X_t]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t = 1, 2, \ldots, T\)</span>; o:
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c}
    \mathbb{E}[X_1] \\
    \mathbb{E}[X_2] \\
    \vdots \\
    \mathbb{E}[X_T]
    \end{array}
\right]
\end{equation*}\]</span></p>
<p>o,
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c}
    \mathbb{E}[X_1], \mathbb{E}[X_2], \ldots, \mathbb{E}[X_T]
    \end{array}
\right]
\end{equation*}\]</span></p>
<p>Y en su variaza:
<span class="math display">\[\begin{equation*}
    Var[X_t] = \mathbb{E}[(X_t - \mathbb{E}[X_t])^2]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t = 1, 2, \ldots, T\)</span>, y de sus <span class="math inline">\(T(T-1)/2\)</span> covarianzas:
<span class="math display">\[\begin{equation*}
    Cov[X_t,X_s] = \mathbb{E}[(X_t - \mathbb{E}[X_t])(X_s - \mathbb{E}[X_s])]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t &lt; s\)</span>. Por lo tanto, en la forma matricial podemos escribir lo siguiente:
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c c c c}
    Var[X_1] &amp; Cov[X_1,X_2] &amp; \cdots &amp; Cov[X_1,X_T] \\
    Cov[X_2,X_1] &amp; Var[X_2] &amp; \cdots &amp; Cov[X_2,X_T] \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    Cov[X_T,X_1] &amp; Cov[X_T,X_2] &amp; \cdots &amp; Var[X_T] \\
    \end{array}
\right]
\end{equation*}\]</span></p>
<p><span class="math display" id="eq:MATCOV">\[\begin{equation}
= \left[
    \begin{array}{c c c c}
    \sigma_1^2 &amp; \rho_{12} &amp; \cdots &amp; \rho_{1T} \\
    \rho_{21} &amp; \sigma_2^2 &amp; \cdots &amp; \rho_{2T} \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    \rho_{T1} &amp; \rho_{T2} &amp; \cdots &amp; \sigma_T^2 \\
    \end{array}
\right]
    \tag{3.6}
\end{equation}\]</span></p>
<p>Donde es claro que en la matriz de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MATCOV">(3.6)</a> existen <span class="math inline">\(T(T-1)/2\)</span> covarianzas distintas, ya que se cumple que <span class="math inline">\(Cov[X_t,X_s] = Cov[X_s,X_t]\)</span>, para <span class="math inline">\(t \neq s\)</span>.</p>
<p>A menudo, esas covarianzas son denominadas como autocovarianzas puesto que ellas son covarianzas entre variables aleatorias pertenecientes al mismo proceso estocástico pero en un momento <span class="math inline">\(t\)</span> diferente. Si el proceso estocástico tiene una distribución normal multivariada, su función de distribución estará totalmente descrita por sus momentos de primer y segundo orden.</p>
<p>Ahora introduciremos el concepto de ergodicidad, el cual indica que los momentos muestrales, los cuales son calculados en la base de una serie de tiempo con un número finito de observaciones, en la medida que <span class="math inline">\(T \rightarrow \infty\)</span> sus correspondientes momentos muestrales, tienden a los verdaderos valores poblacionales, los cuales definiremos como <span class="math inline">\(\mu\)</span>, para la media, y <span class="math inline">\(\sigma^2_X\)</span> para la varianza.</p>
<p>Este concepto sólo es cierto si asumimos que, por ejemplo, el valor esperado y la varianza son como se dice a continuación para todo <span class="math inline">\(t = 1, 2, \ldots, T\)</span>:
<span class="math display" id="eq:ESPERANZA">\[\begin{eqnarray}
    \mathbb{E}[X_t] = \mu_t = \mu \\
    \tag{3.7}
\end{eqnarray}\]</span>
<span class="math display" id="eq:VARIANZA">\[\begin{eqnarray}
    Var[X_t] = \sigma^2_X
    \tag{3.8}
\end{eqnarray}\]</span></p>
<p>Mas formalmente, se dice que el PGD o el proceso estocástico es ergódico en la media si:
<span class="math display" id="eq:LIM1">\[\begin{equation}
    \displaystyle\lim_{T \to \infty}{\mathbb{E} \left[ \left( \frac{1}{T} \sum^{T}_{t = 1} (X_t - \mu) \right) ^2 \right]} = 0
    \tag{3.9}
\end{equation}\]</span></p>
<p>y ergódico en la varianza si:
<span class="math display" id="eq:LIM2">\[\begin{equation}
    \displaystyle\lim_{T \to \infty}{\mathbb{E} \left[ \left( \frac{1}{T} \sum^{T}_{t = 1} (X_t - \mu) ^2 - \sigma^2_X \right) ^2 \right]} = 0
    \tag{3.10}
\end{equation}\]</span></p>
<p>Estas condiciones se les conoce como <em>propiedades de consistencia</em> para las variables aleatorias. Sin embargo, éstas no pueden ser probadas. Por ello se les denomina como un supuesto que pueden cumplir algunas de las series. Más importante aún: <strong>un proceso estocástico que tiende a estar en equilibrio estadístico en un orden ergódico, es estacionario</strong>.</p>
<p>Podemos distinguir dos tipos de estacionariedad. Si asumimos que la función común de distribución del proceso estocástico no cambia a lo largo del tiempo, se dice que el proceso es <em>estrictamente estacionario</em>. Como este concepto es difícil de aplicar en la práctica, solo consideraremos a la <em>estacionariedad débil</em> o estacionariedad en sus momentos.</p>
<p>Definiremos a la estacionariedad por sus momentos del correspondiente proceso estocástico dado por <span class="math inline">\(\{X_t\}\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p><em>Estacionariedad en media</em>: Un proceso estocástico es estacionario en media si <span class="math inline">\(E[X_t] = \mu_t = \mu\)</span> es constante para todo <span class="math inline">\(t\)</span>.</p></li>
<li><p><em>Estacionariedad en varianza</em>: Un proceso estocástico es estacionario en varianza si <span class="math inline">\(Var[X_t] = \mathbb{E}[(X_t - \mu_t)^2] = \sigma^2_X = \gamma(0)\)</span> es constante y finita para todo <span class="math inline">\(t\)</span>.</p></li>
<li><p><em>Estacionariedad en covarianza</em>: Un proceso estocástico es estacionario en covarianza si <span class="math inline">\(Cov[X_t,X_s] = \mathbb{E}[(X_t - \mu_t)(X_s - \mu_s)] = \gamma(|s-t|)\)</span> es sólo una función del tiempo y de la distancia entre las dos variables aleatorias. Por lo que no depende del tiempo denotado por <span class="math inline">\(t\)</span> (no depende de la información contemporánea).</p></li>
<li><p><em>Estacionariedad débil</em>: Como la estacionariedad en varianza resulta de forma inmediata de la estacionariedad en covarianza cuando se asume que <span class="math inline">\(s = t\)</span>, un proceso estocástico es débilmente estacionario cuando es estacionario en media y covarianza.</p></li>
</ol>
<p>Puesto que resulta poco factible asumir una estacionariedad diferente a la débil, es adelante siempre que digamos que un proceso es estacionario se referirá al caso débil y sólo diremos que el proceso es estacionario, sin el apelativo de débil.</p>
<p>. Supongamos una serie de tiempo denotada por: <span class="math inline">\(\{U_t\}^T_{t = 0}\)</span>. Decimos que el proceso estocástico <span class="math inline">\(\{U_t\}\)</span> es un <em>proceso estocástico puramente aleatorio</em> o es un <em>proceso estocástico de ruido blanco o caminata aleatoria</em>, si este tiene las siguientes propiedades:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(\forall t\)</span>;</p></li>
<li><p><span class="math inline">\(Var[U_t] = \mathbb{E}[(U_t - \mu_t)^2] = \mathbb{E}[(U_t - \mu)^2] = \mathbb{E}[(U_t)^2] = \sigma^2\)</span>, <span class="math inline">\(\forall t\)</span>, y</p></li>
<li><p><span class="math inline">\(Cov[U_t,U_s] = \mathbb{E}[(U_t - \mu_t)(U_s - \mu_s)] = \mathbb{E}[(U_t - \mu)(U_s - \mu)] = \mathbb{E}[U_t U_s] = 0\)</span>, <span class="math inline">\(\forall t \neq s\)</span>.</p></li>
</ol>
<p>En otras palabras, un proceso <span class="math inline">\(U_t\)</span> es un ruido blanco si su valor esperado (promedio) es cero (0), tiene una varianza finita y constante, y además no le importa la historia pasada. Así, su valor presente no se ve influenciado por sus valores pasados, no importando respecto de qué período se tome referencia.</p>
<p>En apariencia, por sus propiedades, este proceso es débilmente estacionario –o simplemente, estacionario–. Todas las variables aleatorias tienen una media de cero, una varianza <span class="math inline">\(\sigma^2\)</span> y no existe correlación entre ellas.</p>
<p>Ahora, supongamos que definimos un nuevo proceso estocástico <span class="math inline">\(\{X_t\}\)</span> como:
<span class="math display" id="eq:em1">\[\begin{equation}
    X_t = \left\{ \begin{array}{l} U_0  \mbox{ para } t = 0 \\ X_{t-1} + U_t \mbox{ para } t = 1, 2, 3, \ldots \end{array}\right.
    \tag{3.11}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\{ U_t \}\)</span> es un proceso puramente aleatorio. Este proceso estocástico, o caminata aleatoria sin tendencia (ajuste - drift), puede ser reescrito como:
<span class="math display" id="eq:em2">\[\begin{equation}
    X_t = \sum^t_{j = 0} U_j
    \tag{3.12}
\end{equation}\]</span></p>
<p>Tratemos de dar más claridad al ejemplo, para ello asumamos que generamos a <span class="math inline">\(\{U_t\}\)</span> por medio del lanzamiento de una moneda. Donde obtenemos una cara (águila) con una probabilidad de <span class="math inline">\(0.5\)</span>, en cuyo caso decimos que la variable aleatoria <span class="math inline">\(U_t\)</span> tomará el valor de <span class="math inline">\(+1\)</span>, y una cruz (sol) con una probabilidad de <span class="math inline">\(0.5\)</span>, en cuyo caso decimos que la variable aleatoria <span class="math inline">\(U_t\)</span> toma el valor de <span class="math inline">\(-1\)</span>.</p>
<p>Este planteamiento cumple con las propiedades enunciadas ya que:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mathbb{E}[U_t] = 0.5 \times -1 + 0.5 \times 1 = 0\)</span>, <span class="math inline">\(\forall t\)</span></p></li>
<li><p><span class="math inline">\(Var[U_t] = \mathbb{E}[(U_t - 0)^2] = \frac{1}{2}((-1)^2) + \frac{1}{2}((1)^2) = 1\)</span>, <span class="math inline">\(\forall t\)</span></p></li>
<li><p><span class="math inline">\(Cov[U_t,U_s] = \mathbb{E}[(U_t - 0)(U_s - 0)] = \mathbb{E}[U_t \cdot U_s] = 0\)</span>, <span class="math inline">\(\forall t \neq s\)</span>.</p></li>
</ol>
<p>Retomando a nuestro proceso <span class="math inline">\(X_t\)</span>, diremos que el caso de <span class="math inline">\(X_0 = 0\)</span>, para <span class="math inline">\(t = 0\)</span>. Si verificamos cuáles son sus primeros y segundos momentos de <span class="math inline">\(\{X_t\}\)</span>, tenemos:
<span class="math display" id="eq:em3">\[\begin{equation}
    \mathbb{E}[X_t] = \mathbb{E}\left[ \sum^t_{j=1} U_j \right] = \sum^t_{j=1} \mathbb{E}[U_j] = 0
    \tag{3.13}
\end{equation}\]</span></p>
<p>En cuanto a la varianza:
<span class="math display" id="eq:em4">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; Var \left[ \sum^t_{j=1} U_j \right] \nonumber \\
    &amp; = &amp; \sum^t_{j=1} Var[U_j] + 2 * \sum_{j \neq k} Cov[U_j,U_k] \nonumber \\
    &amp; = &amp; \sum^t_{j=1} 1 \nonumber \\
    &amp; = &amp; t
    \tag{3.14}
\end{eqnarray}\]</span></p>
<p>Lo anterior, dado que hemos supuesto que en la caminata aleatoria todas las variables aleatorias son independientes, es decir, <span class="math inline">\(Cov[U_t,U_s] = E[U_t \cdot U_s] = 0\)</span>. Por su parte, la covarianza del proceso estocástico se puede ver como:
<span class="math display">\[\begin{eqnarray*}
    Cov[X_t,X_s] &amp; = &amp; \mathbb{E} \left[ \left( \sum^t_{j=1} U_j - 0 \right) \left( \sum^s_{i=1} U_i - 0 \right) \right] \\
    &amp; = &amp; \mathbb{E}[(U_1 + U_2 + \ldots + U_t)(U_1 + U_2 + \ldots + U_s)] \\
    &amp; = &amp; \sum^t_{j=1} \sum^s_{i=1} \mathbb{E}[U_j U_i] \\
    &amp; = &amp; \mathbb{E}[U^2_1] + \mathbb{E}[U^2_2] + \ldots + \mathbb{E}[U^2_k] \\
    &amp; = &amp; \sigma^2 + \sigma^2 + \ldots + \sigma^2 \\
    &amp; = &amp; 1 + 1 + 1 + 1 \\
    &amp; = &amp; min(t,s)
\end{eqnarray*}\]</span></p>
<p>Así, el proceso estocástico dado por la caminata alaeatoria sin un término de ajuste es estacionario en media, pero no en varianza o en covarianza, y consecuentemente, en general no estacionario, condición que contraria al caso del proceso simple descrito en <span class="math inline">\(U_t\)</span>.</p>
<p>Es fácil ver que muchas de las posibilidades de realización de este proceso estocástico (series de tiempo) pueden tomar cualquiera de las rutas consideradas en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig31">3.1</a>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="co"># Utilizaremos una función guardada en un archivo a parte</span></span>
<span><span class="co"># Llamamos a la función:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Caminata.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Definimos argumentos de la función</span></span>
<span><span class="va">Opciones</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="va">Soporte</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="co"># Vamos a réplicar el proceso con estos parámetros</span></span>
<span><span class="va">Rango</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="co">#</span></span>
<span><span class="va">Caminos</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Caminos</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">TT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">Caminata</span><span class="op">(</span><span class="va">Opciones</span>, <span class="va">Soporte</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">G_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">Caminata</span><span class="op">(</span><span class="va">Opciones</span>, <span class="va">Soporte</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">TT</span>, <span class="va">G_t</span>, col <span class="op">=</span> <span class="st">"blue"</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"Ganancias"</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">Rango</span>,<span class="va">Rango</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span><span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig31"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig31-1.png" alt="Ejemplo de 10 trayectorias de la caminata aleatoria, cuando sólo es posible cambios de +1 y -1" width="672"><p class="caption">
Figure 3.1: Ejemplo de 10 trayectorias de la caminata aleatoria, cuando sólo es posible cambios de +1 y -1
</p>
</div>
</div>
<div id="función-de-autocorrelación" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Función de autocorrelación<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>Para ampliar la discusión, es posible calcular la fuerza o intensidad de la dependencia de las variables aleatorias dentro de un proceso estocástico, ello mediante el uso de las autocovarianzas. Cuando las covarianzas son normalizadas respecto de la varianza, el resultado es un término que es independiente de las unidades de medida aplicadas, y se conoce como la <em>función de autocorrelación</em>.</p>
<p>Para procesos estacionarios, dicha función de autocorrelación esta dada por:
<span class="math display" id="eq:em5">\[\begin{equation}
    \rho(\tau) = \frac{\mathbb{E}[(X_t - \mu)(X_{t+\tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\gamma(\tau)}{\gamma(0)}
    \tag{3.15}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Dicha función tiene las siguientes propiedades:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\rho(0) = 1\)</span>. Es fácil demostrar que la función <span class="math inline">\(\rho(0)\)</span> es:</li>
</ol>
<p><span class="math display">\[\begin{equation}
    \rho(0) = \frac{\mathbb{E}[(X_t - \mu)(X_{t + 0} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\mathbb{E}[(X_t - \mu)^2]}{\mathbb{E}[(X_t - \mu)^2]} = 1
\end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>
<span class="math inline">\(\rho(\tau) = \rho(-\tau)\)</span>. Partiendo de la definción de <span class="math inline">\(\rho(\tau)\)</span> podemos ver que la distancia que existe entre <span class="math inline">\(t\)</span> y <span class="math inline">\(t + \tau\)</span> es <span class="math inline">\(\tau\)</span>, de esta forma la autocorrelación de la variable <span class="math inline">\(X\)</span> entre los periodos antes señalados debería ser la misma para el caso en que <span class="math inline">\(\rho(-\tau)\)</span>. Partamos de la ecuación para ver más claramente:</li>
</ol>
<p><span class="math display">\[\begin{equation}
    \rho(\tau) = \frac{\mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\mathbb{E}[(X_t - \mu)(X_{t - \tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \rho(-\tau)
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>
<span class="math inline">\(\lvert\rho(\tau)\lvert \leq 1\)</span>, para todo <span class="math inline">\(\tau\)</span>.</li>
</ol>
<p>Derivado de las propiedades 1 y 2 antes descritas se puede concluir que sólo es necesario conocer la función de autocorrelación para el caso de <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span>, ya que de estos casos podemos derivar los valores de la función de autocorrelación complementarios de <span class="math inline">\(\tau = \ldots, -3, -2, -1\)</span>.</p>
<p>Partiendo de los supuestos de ergodicidad en relación a la media, varianza y covarianzas de un proceso estacionario, podemos estimar dichos parámetros con las siguientes formulaciones o propuestas de estimadores puntuales:
<span class="math display" id="eq:em6">\[\begin{equation}
    \hat{\mu} = \frac{1}{T} \sum^T_{t=1} X_t
    \tag{3.16}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:em7">\[\begin{equation}
    \hat{\gamma}(0) = \frac{1}{T} \sum^T_{t=1} (X_t - \hat{\mu})^2 = \hat{\sigma}^2
    \tag{3.17}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:em8">\[\begin{equation}
    \hat{\gamma}(\tau) = \frac{1}{T} \sum^{T - \tau}_{t=1} (X_t - \hat{\mu})(X_{t+\tau} - \hat{\mu}) \mbox{, para } \tau = 1, 2, \ldots, T-1
    \tag{3.18}
\end{equation}\]</span></p>
<p>No hacemos la demostración en estas notas –sería deseable que el alumno revisara la siguiente afirmación–, pero estos últimos son estimadores consistentes de <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\gamma(0)\)</span> y <span class="math inline">\(\gamma(\tau)\)</span>. Por su parte, un estimador consistente de la función de autocorrelación estará dado por:
<span class="math display" id="eq:eqautocorr">\[\begin{equation}
  \hat{\rho}(\tau) = \frac{\sum^{T - \tau}_{t=1} (X_t - \hat{\mu})(X_{t+\tau} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(\tau)}{\hat{\gamma}(0)}
  \tag{3.19}
\end{equation}\]</span></p>
<p>El estimador de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:eqautocorr">(3.19)</a> es asintóticamente insesgado. Por ejemplo, para el caso de un proceso de ruido blanco o caminata aleatoria, su varianza puede ser aproximada por el valor dado <span class="math inline">\(1/T\)</span>. Ésta tiene, asintóticamente, una distribución normal. Dado esto, el intervalo de confianza al <span class="math inline">\(95\%\)</span> será el dado por <span class="math inline">\(\pm 2/\sqrt{T}\)</span>, en el cual se encuentra la mayoría de los coeficientes de autocorrelación estimados.</p>
<p>Ahora discutamos algunos ejemplos o aplicaciones. Cuando se realiza la evaluación de la estimación de un modelo de series de tiempo es importante saber si los residuales del modelo realmente tienen propiedades de un proceso puramente aleatorio, en particular, si ellos no están correlacionados entre sí. Así, la hipótesis a probar será:
<span class="math display" id="eq:eqautocorr1">\[\begin{equation}
    H_0 : \rho(\tau) = 0 \mbox{, para todo } \tau = 1, 2, \ldots, m \mbox{ y } m &lt; T
    \tag{3.20}
\end{equation}\]</span></p>
<p>Esta expresión se puede interpretar como una prueba respecto de si la correlación entre la información de periodos atrás es cero con la información contemporánea. Para hacer una pruena global de la hipotésis de sí un número <span class="math inline">\(m\)</span> de coeficientes de autocovarianzas son cero Box y Pierce (1970) desarrollarón la siguiente estadística:
<span class="math display" id="eq:eqautocorr2">\[\begin{equation}
    Q^* = T \sum_{j = 1}^{m} \hat{\rho} (j)^2
    \tag{3.21}
\end{equation}\]</span></p>
<p>Bajo la hipotésis nula esta estadística se distribulle asintóticamente como una chi cuadrado (<span class="math inline">\(\chi^2\)</span>) con <span class="math inline">\(m-k\)</span> grados de libertad y con <span class="math inline">\(k\)</span> que representa al número de paramétros estimados.</p>
<p>Haciendo una aplicación estricta de la distribución de esta estadística, sabemos que esta se mantiene asintóticamente. Greta, Ljung y Box (1978) propusieron la siguiente modificación de la estadística para muestras pequeñas:
<span class="math display" id="eq:eqautocorr3">\[\begin{equation}
    Q = T(T + 2) \sum_{j = 1}^{m} \frac{\hat{\rho} (j)^2}{T - j}
    \tag{3.22}
\end{equation}\]</span></p>
<p>La cual también se distribulle asintóticamente como <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m-k\)</span> grados de libertad.</p>
<p>También es intuitivamente claro que la hipótesis nula de no autocorrelación de residuales debería ser rechazada si alguno de los valores <span class="math inline">\(\hat{\rho} (j)\)</span> es muy grande, es decir, si <span class="math inline">\(Q\)</span> o <span class="math inline">\(Q^*\)</span> es muy grande. O más precisamente, si estas estadísticas son más grandes que los correspondientes valores críticos de la distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m-k\)</span> grados de libertad a algún grado dado de signficancia.</p>
<p>Una alternativa para esta prueba es una del tipo Multiplicadores de Lagrange (o LM) desarrollada por Breusch (1978) y Godfrey (1978). La cual, al igual que las estadísticas <span class="math inline">\(Q\)</span> y <span class="math inline">\(Q^*\)</span>, la hipotesis nula está dada por:</p>
<blockquote>
<p><span class="math inline">\(H_0\)</span>: Los residuales no están autocorrelacionados.</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_a\)</span>: Los residuales muestran alguna acutocorrelación de forma autoregresiva o de medias móviles.</p>
</blockquote>
<p>La prueba consiste en realizar una regresión auxiliar en la cual los residuales se estiman en función de las variables explicativas del modelo original y en los residuales mismos pero rezagados hasta el término <span class="math inline">\(m\)</span> (regresión auxiliar). La prueba resulta en una estadística con una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m\)</span> grados de libertad la cual está dada por la expresión:
<span class="math display" id="eq:eqautocorr4">\[\begin{equation}
    LM = T \times R^2
    \tag{3.23}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(R^2\)</span> es el resultante de la regresión auxiliar y <span class="math inline">\(T\)</span> es el número de observaciones totales.</p>
<p>En comparación con una prueba Durbin - Watson que es comúnmente usada en la econometría tradicional, para probar autocorrelación de los residuales, las estadísticas <span class="math inline">\(Q\)</span>, <span class="math inline">\(Q^*\)</span> y <span class="math inline">\(LM\)</span> tienen las siguientes ventajas:</p>
<ol style="list-style-type: decimal">
<li><p>Permiten corroborar la existencia de autocorrelación para cualquier orden, y no solo para un primer orden (es decir, para cualquier valor de <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span>);</p></li>
<li><p>Los resultados se mantienen aún y cuando exista una probable variable endógena en forma rezagada, y</p></li>
<li><p>No depende del orden o la forma en que se acomoden las observaciones, algo que es muy probalble que ocurra en la econometría tradicional.</p></li>
</ol>
<p>El hecho de que los residuales no estén autocorrelacionados no implica que estos sean independientes y normalmente distribuidos. La ausencia de autocorrelación no implica una independencia estocástica si las variables son normalmente distribuidas.</p>
<p>A menudo se asume que estos residuales están distribuidos normalmente, ya que la mayoría de las pruebas estadísticas tienen este supuesto detrás. No obstante, ello también depende de los otros momentos de la distribución, específicamente del tercer y cuarto momento. Los cuales se expresan como:
<span class="math display">\[\begin{equation*}
    \mathbb{E}[(X_t - \mathbb{E}[X_t])^i] \mbox{, } i = 3, 4
\end{equation*}\]</span></p>
<p>El tercer momento es necesario para determinar el sesgo, el cual está dado como:
<span class="math display" id="eq:eqautocorr6">\[\begin{equation}
    \hat{S} = \frac{1}{T} \frac{\sum_{t = 1}^{T} (X_t - \hat{\mu})^3}{\sqrt{\hat{\gamma}(0)^3}}
    \tag{3.24}
\end{equation}\]</span></p>
<p>Para distribuciones simétricas (como en el caso de la distribución normal) el valor teórico para el sesgo es cero.</p>
<p>La curtosis, la cual está dada en función del cuarto momento, se puede expresar como:
<span class="math display" id="eq:eqautocorr7">\[\begin{equation}
    \hat{K} = \frac{1}{T} \frac{\sum_{t = 1}^{T} (X_t - \hat{\mu})^4}{\hat{\gamma}(0)^2}
    \tag{3.25}
\end{equation}\]</span></p>
<p>Para el caso de una distribución normal, esta estadística toma el valor de 3. Valores más grandes que 3 indican que la distribución tiene colas anchas. En tales casos se ubican los datos financieros.</p>
<p>Usando el valor de las estadísticas para medir el sesgo y la curtosis, <span class="math inline">\(S\)</span> y <span class="math inline">\(K\)</span>, respectivamente, Jarque y Bera (1980) propusieron una prueba de normalidad, la cual puede ser aplicada a series de tiempo en niveles o en diferencias indistintamente. Dicha prueba se expresa como:
<span class="math display" id="eq:eqautocorr8">\[\begin{equation}
    JB = \frac{T}{6} \left(\hat{S} + \frac{1}{4} (\hat{K} - 3)^2 \right)
    \tag{3.26}
\end{equation}\]</span></p>
<p>La cual tiene una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(2\)</span> grados de libertad y donde <span class="math inline">\(T\)</span> es el tamaño de la muestra. La hipótesis de que las observaciones están distribuidas de forma normal se rechaza si el valor de la estadística de prueba es más grande que los correspondientes valores críticos en tablas.</p>
<p>. Veamos un ejemplo para ilustrar el uso de la función de autocorrelación. Tomemos como variable al número de pasajeros transportados por el sistema de transporte del metro de la CDMX.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Los datos y algoritmo está disponible en el repositorio de GitHub y corresponde a la Clase 3.&lt;/p&gt;"><sup>1</sup></a> Los datos empleados fueron tomados del INEGI y son una serie de tiempo en el período que va de enero de 2000 a mayo de 2023, es decir, 281 observaciones. Como se puede apreciar en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig32">3.2</a>, el número de pasajeros por mes ha oscilado significativamente a lo largo del tiempo. Incluso podemos observar un cambio estructural de la serie entre 2011 y 2012. Asimismo, podemos ubicar una caída atípica que ocurrió en septiembre de 2017. Pero lo más relevante es la caída asociada a la pandemia de COVID-19 de 2020.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Datos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Periodo</span>, y <span class="op">=</span> <span class="va">Pax_Metro</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_point(size = 1.0, color = "darkblue") + </span></span>
<span>  <span class="co">#theme_bw() + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Millones de pasajeros"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Pasajeros Transportados en el Metro de la CDMX"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"(Ene-2000 a Jul-2021)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia con información del INEGI, \nhttps://www.inegi.org.mx/app/indicadores/?tm=0&amp;t=1090"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig32"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig32-1.png" alt="Evolución del número de pasajeros en el Metro de la CDMX, enero 2000 a mayo 2023" width="672"><p class="caption">
Figure 3.2: Evolución del número de pasajeros en el Metro de la CDMX, enero 2000 a mayo 2023
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"Pax_Metro.png"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">15</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
<p>A esta serie de tiempo le calculamos los pincipales estadísticos hasta ahora estudiados y obtenemos el Cuadro <a href="procesos-estacionarios-y-modelos-univariados.html#tab:foo">3.1</a>. En dicho cuadro se destaca que se muestra la función de autocirrelación para los tres primeros rezagos. Para mayor detalle, en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig33">3.3</a> se muestra la función de autocorrelación, en donde las bandas descritas por las líneas azules son el intervalo de confianza dentro de las cuales no se puede rechazar la hipotésis nula de que <span class="math inline">\(H_0: \hat{\rho}(p) = 0\)</span>, para todo <span class="math inline">\(\tau = 1, 2, \ldots, T-1\)</span>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:foo">Table 3.1: </span> Estadísticas descriptivas del número de pasajeros en el Metro de la CDMX, enero de 2000 a junio de 2019</caption>
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="center">Estadística</th>
<th align="center">Valor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\mu} = \frac{1}{T} \sum^T_{t=1} X_t\)</span></td>
<td align="center">124.3000</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\gamma}(0) = \frac{1}{T} \sum^T_{t=1} (X_t - \hat{\mu})^2\)</span></td>
<td align="center">103.6400</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\gamma}(1) = \frac{1}{T} \sum^{T - 1}_{t=1} (X_t - \hat{\mu})(X_{t+1} - \hat{\mu})\)</span></td>
<td align="center">63.1100</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\gamma}(2) = \frac{1}{T} \sum^{T - 2}_{t=1} (X_t - \hat{\mu})(X_{t+2} - \hat{\mu})\)</span></td>
<td align="center">72.9100</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\gamma}(3) = \frac{1}{T} \sum^{T - 3}_{t=1} (X_t - \hat{\mu})(X_{t+3} - \hat{\mu})\)</span></td>
<td align="center">63.6900</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\rho}(1) = \frac{\sum^{T - 1}_{t=1} (X_t - \hat{\mu})(X_{t+1} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(1)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.6089</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\rho}(2) = \frac{\sum^{T - 2}_{t=1} (X_t - \hat{\mu})(X_{t+2} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(2)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.7035</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\rho}(3) = \frac{\sum^{T - 3}_{t=1} (X_t - \hat{\mu})(X_{t+3} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(3)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.6145</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(Q^* = T \sum_{j = 1}^{1} \hat{\rho} (j)^2\)</span></td>
<td align="center">86.7577</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Q^* = T \sum_{j = 1}^{2} \hat{\rho} (j)^2\)</span></td>
<td align="center">290.9279</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span>, </span>
<span>                start <span class="op">=</span> <span class="fl">2000</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">Pax_Metro</span>, </span>
<span>    lag.max <span class="op">=</span> <span class="fl">150</span>, </span>
<span>    xlab <span class="op">=</span> <span class="st">'Resagos k en meses'</span>, </span>
<span>    main <span class="op">=</span> <span class="st">"Funcion de Autocorrelación del número de pasajeros del metro"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig33"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig33-1.png" alt="Función de Autocorrelación: 150 rezagos del número de pasajeros en el Metro de la CDMX, enero de 2000 a mayo de 2023" width="672"><p class="caption">
Figure 3.3: Función de Autocorrelación: 150 rezagos del número de pasajeros en el Metro de la CDMX, enero de 2000 a mayo de 2023
</p>
</div>
</div>
<div id="procesos-estacionarios-univariados" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Procesos estacionarios univariados<a class="anchor" aria-label="anchor" href="#procesos-estacionarios-univariados"><i class="fas fa-link"></i></a>
</h2>
<p>En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos
propuestos dentro de esta metodología o conjunto de métodos se han vuelto indispensables para efectos de realizar pronósticos de corto
plazo.</p>
<p>En este sentido, se analizarán los métodos más importantes en series de tiempo: procesos autoregresivos (AR, por sus siglas en inglés) y procesos de medias móviles (MA, por sus siglas en inglés). Asimismo, se realizará un análisis de los procesos que resultan de la combinación de ambos, conocida como ARMA, los cuales son más comúnmente usados para realizar pronósticos.</p>
</div>
<div id="procesos-autoregresivos-ar" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Procesos Autoregresivos (AR)<a class="anchor" aria-label="anchor" href="#procesos-autoregresivos-ar"><i class="fas fa-link"></i></a>
</h2>
<p>Los procesos autoregresivos tienen su origen en el trabajo de Cochrane y Orcutt de 1949, mediante el cual analizaron los residuales de una regresión clásica como un proceso autoregresivo. Puede consultarse el apéndice para la discusión del modelo de regresión clásica.</p>
<div id="ar1" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> AR(1)<a class="anchor" aria-label="anchor" href="#ar1"><i class="fas fa-link"></i></a>
</h3>
<p>Como primer caso analizaremos al proceso autoregresivo de primer orden, <span class="math inline">\(AR(1)\)</span>, el cual podemos definir como una Ecuación Lineal en Diferencia de Primer Orden Estocástica. Diremos que una Ecuación Lineal en Diferencia de Primer Orden es estocástica si en su representación analítica considera un componente estocástico como en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:EDOEst">(3.27)</a> descrita a continuación:
<span class="math display" id="eq:EDOEst">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + U_t
    \tag{3.27}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_0\)</span> es un término constante, <span class="math inline">\(U_t\)</span> es un proceso estacionario, con media cero (0), una varianza finita y constante (<span class="math inline">\(\sigma^2\)</span>) y una covarianza que depende de la distancia entre <span class="math inline">\(t\)</span> y cualquier <span class="math inline">\(t-s\)</span> (<span class="math inline">\(\gamma_s\)</span>)–que no depende de los valores pasados o futuros de la variable–, <span class="math inline">\(X_0\)</span> es el valor inicial del proceso <span class="math inline">\(X_t\)</span>. No obstante, en ocasiones vamos a asumir que la covarianza será cero (0), por lo que en esos casos tendremos un proceso puramente aleatorio. Considerando la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:EDOEst">(3.27)</a> y un proceso de sustitución sucesivo podemos establecer lo siguiente, empezando con <span class="math inline">\(X_1\)</span>:
<span class="math display">\[\begin{eqnarray*}
    X_{1} &amp; = &amp; a_0 + a_1 X_{0} + U_{1}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_2\)</span>:
<span class="math display">\[\begin{eqnarray*}
    X_{2} &amp; = &amp; a_0 + a_1 X_{1} + U_{2} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 X_{0} + U_{1}) + U_{2} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_3\)</span>:
<span class="math display">\[\begin{eqnarray*}
    X_{3} &amp; = &amp; a_0 + \alpha X_{2} + U_{3} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}) + U_{3} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 X_{0} + a_1^2 U_{1} + a_1 U_{2} + U_{3}
\end{eqnarray*}\]</span></p>
<p>Así, para cualquier <span class="math inline">\(X_t\)</span>, <span class="math inline">\(t = 1, 2, 3, \ldots\)</span>, obtendríamos:
<span class="math display" id="eq:EDOSSol">\[\begin{eqnarray}
    X_{t} &amp; = &amp; a_0 + a_1 X_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 a_0 + \ldots + a_1^{t-2} a_0 + a_1^{t-1} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-2} U_{1} + \ldots + a_1 U_{t - 2} + U_{t - 1}) + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 a_0 + \ldots + a_1^{t-1} a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots + a_1^{t-1}) a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots + a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t}  \nonumber\\
    &amp; = &amp; \frac{1 - a_1^t}{1 - a_1} a_0 + a_1^{t} X_{0} + \sum^{t-1}_{j = 0} a_1^{j} U_{t - j}
    \tag{3.28}
\end{eqnarray}\]</span></p>
<p>De esta forma en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:EDOSSol">(3.28)</a> observamos un proceso que es explicado por dos partes: una que depende del tiempo y otra que depende de un proceso estocástico. Asimismo, debe notarse que la condición de convergencia es idéntica al caso de ecuaciones en diferencia estudiadas al inicio del curso: $ |a_1| &lt; 1$, por lo que cuando <span class="math inline">\(t \to \infty\)</span>, la expresión <a href="procesos-estacionarios-y-modelos-univariados.html#eq:EDOSSol">(3.28)</a> será la siguiente:
<span class="math display" id="eq:EDOSLP">\[\begin{equation}
    X_t = a_0 \frac{1}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^{j} U_{t - j}
    \tag{3.29}
\end{equation}\]</span></p>
<p>Así, desaparece la parte dependiente del tiempo y únicamente prevalece la parte que es dependiente del proceso estocástico. Esta es la solución de largo plazo del proceso <span class="math inline">\(AR(1)\)</span>, la cual depende del proceso estocástico. Notemos, además, que esta solución implica que la variable o la serie de tiempo <span class="math inline">\(X_t\)</span> es también un proceso estocástico que hereda las propiedades de <span class="math inline">\(U_t\)</span>. Así, <span class="math inline">\(X_t\)</span> es también un proceso estocástico estacionario, como demostraremos más adelante.</p>
<p>Observemos que la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:EDOSLP">(3.29)</a> se puede reescribir si consideramos la formulación que en la literatura se denomina como la descomposición de Wold, en la cual se define que es posible asumir que <span class="math inline">\(\psi_j = a_1^j\)</span> y se considera el caso en el cual $ |a_1| &lt; 1 $. De esta forma tendremos que, por ejemplo, cuando:
<span class="math display">\[\begin{equation*}
    \sum^{\infty}_{j = 0} \psi^2_j = \sum^{\infty}_{j = 0} a_1^{2j} = \frac{1}{1 - a_1^2}
\end{equation*}\]</span></p>
<p>Alternativamente y de forma similar a las ecuaciones en diferencia estudiadas previamente, podemos escribir el proceso <span class="math inline">\(AR(1)\)</span> mediante el uso del operador rezago como:
<span class="math display" id="eq:AR01">\[\begin{eqnarray}
    X_t &amp; = &amp; a_0 + a_1 L X_t + U_t \nonumber \\
    X_t - a_1 L X_t &amp; = &amp; a_0 + U_t \nonumber \\
    (1 - a_1 L) X_t &amp; = &amp; a_0 + U_t \nonumber \\
    X_t &amp; = &amp; \frac{a_0}{1 - a_1 L} + \frac{1}{1 - a_1 L} U_t
    \tag{3.30}
\end{eqnarray}\]</span></p>
<p>En esta última ecuación retomamos el siguiente término para reescribirlo como:
<span class="math display">\[\begin{equation}
    \frac{1}{1 - a_1 L} = 1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots
\end{equation}\]</span></p>
<p>Tomando este resultado para sustituirlo en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR01">(3.30)</a>, obtenemos la siguiente expresión:
<span class="math display" id="eq:AR1Sol">\[\begin{eqnarray}
    X_t &amp; = &amp; (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) a_0 + (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) U_t \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots) a_0 + U_t + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j}
    \tag{3.31}
\end{eqnarray}\]</span></p>
<p>Donde la condición de convergencia y estabilidad del proceso descrito en esta ecuación es que $ |a_1| &lt; 1 $. Por lo que hemos demostrado que, mediante el uso del operador de rezago, es posible llegar al mismo resultado que obtuvimos mediante el procedimiento de sustituciones iterativas.</p>
<p>La ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a> se puede interpretar como sigue. La solución o trayectoria de equilibrio de un AR(1) se divide en dos partes. La primera es una constante que depende de los valores de <span class="math inline">\(a_0\)</span> y <span class="math inline">\(a_1\)</span>. La segunda parte es la suma ponderada de las desviaciones o errores observados y acumulados en el tiempo hasta el momento <span class="math inline">\(t\)</span>.</p>
<p>Ahora obtendremos los momentos que describen a la serie de tiempo cuando se trata de un proceso <span class="math inline">\(AR(1)\)</span>. Para ello debemos obtener la media, la varianza y las covarianzas de <span class="math inline">\(X_t\)</span>. Para los siguientes resultados debemos recordar y tener en mente que si <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, entonces:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\mathbb{E}[U_t] = 0\)</span> para todo <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(Var[U_t] = \sigma^2\)</span> para todo <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(Cov[U_t, U_s] = 0\)</span> para todo <span class="math inline">\(t \neq s\)</span></p></li>
</ol>
<p>Dicho lo anterior y partiendo de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a>, el primer momento o valor esperado de la serie de tiempo será el siguiente:
<span class="math display" id="eq:AR1m1">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E} \left[ \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} \right] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j \mathbb{E}[U_{t-j}] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} = \mu
    \tag{3.32}
\end{eqnarray}\]</span></p>
<p>Respecto de la varianza podemos escribir la siguiente expresión a partir de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a>:
<span class="math display" id="eq:AR1Var">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right)^2 \right] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_{t} + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t} + a_1^2 U^2_{t-1} + a_1^4 U^2_{t-2} + a_1^6 U^2_{t-3} + \ldots \nonumber \\
    &amp;   &amp; + 2 a_1 U_t U_{t-1} + 2 a_1^2 U_t U_{t-2} + \ldots] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t}] + a_1^2 \mathbb{E}[U^2_{t-1}] + a_1^4 \mathbb{E}[U^2_{t-2}] + a_1^6 \mathbb{E}[U^2_{t-3}] + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 + a_1^2 \sigma^2 + a_1^4 \sigma^2 + a_1^6 \sigma^2 + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 (1 + a_1^2 + a_1^4 + a_1^6 + \ldots) \nonumber \\
    &amp; = &amp; \sigma^2 \frac{1}{1 - a_1^2} = \gamma(0)
    \tag{3.33}
\end{eqnarray}\]</span></p>
<p>Previo a analizar la covarianza de la serie de tiempo, recordemos que para el proceso puramente aleatorio <span class="math inline">\(U_t\)</span> su varianza y covarianza puede verse como <span class="math inline">\(\mathbb{E}[U_t, U_s] = \sigma^2\)</span>, para <span class="math inline">\(t = s\)</span>, y <span class="math inline">\(\mathbb{E}[U_t, U_s] = 0\)</span>, para cualquier otro caso, respectivamente.</p>
<p>Dicho lo anterior, partiendo de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a> la covarianza de la serie estará dada por:
<span class="math display" id="eq:AR1Cov">\[\begin{eqnarray}
    Cov(X_t, X_{t-\tau}) &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t-\tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right) \right. \nonumber \\
    &amp;   &amp; \left. \times \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-\tau-j} - \frac{a_0}{1 - a_1} \right) \right] \nonumber \\
    &amp; = &amp; a_1^{\tau} \mathbb{E}[U^2_{t-\tau} + a_1 U^2_{t-\tau-1} + a_1^2 U^2_{t-\tau-2} + a_1^3 U^2_{t-\tau-3} + \ldots] \nonumber \\
    &amp; = &amp; a_1^{\tau} \sigma^2 \frac{1}{1 - a_1^2} = \gamma(\tau)
    \tag{3.34}
\end{eqnarray}\]</span></p>
<p>Notése que con estos resultados en las ecuaciones <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Var">(3.33)</a> y <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Cov">(3.34)</a> podemos construir la función de autocorrelación
teórica como sigue:
<span class="math display">\[\begin{eqnarray}
    \rho(\tau) &amp; = &amp; \frac{\gamma(\tau)}{\gamma(0)} \nonumber \\
    &amp; = &amp; a_1^\tau
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span> y $ |a_1| &lt; 1 $. Este último resultado significa que cuando el proceso autoregresivo es de orden 1 (es decir, AR(1)) la función de autocorrelación teóricamente es igual al parámetro <span class="math inline">\(a_1\)</span> elevado al número de rezagos considerados. No obstante, note que esto no significa que la autocorrelación observada sea como lo expresa en el planteamiento anterior. Por el contrario, una observación sencilla mostraría que la autocorrelación observada sería ligeramente distinta a la autocorrelación teórica. Ahora veamos algunos ejemplos.</p>
<p>. En el primer ejemplo simularemos una serie y mostraremos el análisis de un proceso construido considerando un proceso puramente aleatorio como componente <span class="math inline">\(U_t\)</span>. Por su parte, en un segundo ejemplo aplicaremos el análisis a una serie de tiempo de una variable económica observada.</p>
<p>Para el primer ejemplo, consideremos un proceso dado por la forma de un <span class="math inline">\(AR(1)\)</span> como en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR01">(3.30)</a> cuya solución está dada por la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a>. En específico, supongamos que el término o componente estocástico <span class="math inline">\(U_t\)</span> es una serie generada a partir de números aleatorios de una función normal con media <span class="math inline">\(0\)</span> y desviación estándar <span class="math inline">\(4\)</span>. Los detalles del proceso simulado se muestran en las siguientes gráficas.</p>
<p>La Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig41">3.4</a> ilustra el comportamiento que se debería observar en una serie considerando el procedimiento iterativo de construcción. Por su parte, la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig42">3.5</a> ilustra el proceso o trayectoria de la solución de la serie de tiempo. Finalmente, las Figuras <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig43">3.6</a> y <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig44">3.7</a> muestran el correlograma calculado considerando una función de autocorrelación aplicada al porceso real y una función de autocorrelación aplicada al proceso teórico, respectivamente.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="fl">5</span>; <span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>; <span class="va">X_0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a0</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a1</span><span class="op">)</span><span class="op">)</span>; <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Tiempo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agregamos un término estocástico al data frame</span></span>
<span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="cn">T</span><span class="op">+</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agregamos columnas con NA's para un proceso teorico y uno real</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># La serie teórica inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># La serie real inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># Agregamos una columna para la función de Autocorrelación teórica:</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span> <span class="op">&lt;-</span><span class="cn">NA</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Real:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">a0</span> <span class="op">+</span> <span class="va">a1</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Teórico:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Autocorrelación:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span>, y <span class="op">=</span> <span class="va">XR_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#theme_bw() + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento del Proceso Real ('Estimado')"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig41"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig41-1.png" alt="Comportamiento del Proceso Real ('Estimado')" width="672"><p class="caption">
Figure 3.4: Comportamiento del Proceso Real (‘Estimado’)
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"G_AR_1_Real.png"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">10</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span>, y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#theme_bw() + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento del Proceso Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig42"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig42-1.png" alt="Comportamiento del Proceso Teórico" width="672"><p class="caption">
Figure 3.5: Comportamiento del Proceso Teórico
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"G_AR_1_Teo.png"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">10</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span>, lag.max <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>    ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>    main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Real"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig43"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig43-1.png" alt="Funcion de Autocorrelacion Real" width="672"><p class="caption">
Figure 3.6: Funcion de Autocorrelacion Real
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>, names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>        border<span class="op">=</span><span class="st">"blue"</span>, density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>        main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Teórica"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig44"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig44-1.png" alt="Funcion de Autocorrelacion Teórica" width="672"><p class="caption">
Figure 3.7: Funcion de Autocorrelacion Teórica
</p>
</div>
<p>Recordemos que una trayectoria de equilibrio o solución de un <span class="math inline">\(AR(1)\)</span> es como se muestra en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR1Sol">(3.31)</a>. Así, nuestra serie simulada cumple con la característica de que los errores son más relevantes cuando la serie es corta. Por el contrario, los errores son menos relevantes, cuando la serie es muy larga. La Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig45">3.8</a> ilustra esta observación de la trayectoria de equilibrio.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">XR_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#theme_bw() + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento de los Procesos Real y Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig45"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig45-1.png" alt="Comportamiento de los Procesos Real y Teórico" width="672"><p class="caption">
Figure 3.8: Comportamiento de los Procesos Real y Teórico
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"G_AR_1_Comb.png"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">10</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
<p>. Para el segundo ejemplo consideremos una aplicación a una serie de tiempo en especifico: Pasajeros transportados mensualmente en el Sistema de Transporte Colectivo Metro (pasajeros medidos en millones).</p>
<p>A la serie se le aplicará una metodología de estimación dada por el método de Máxima Verosimilitud (ML, por sus siglas en inglés). Antes de realizar el proceso de estimación, consideremos una transformación de diferencias logarítmicas con el objeto de obtener una serie de tiempo expresada en tasas de crecimiento y con un comportamiento parecido a un proceso estacionario.</p>
<p>Así, para cada una de las series que analicemos en diferencias logarítmicas respecto del momento <span class="math inline">\(k\)</span> las expresaremos bajo la siguiente transformación:
<span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Esta expresión se puede interpretar como una tasa de crecimiento, puesto que asumimos variaciones pequeñas para las cuales se cumple que: <span class="math inline">\(log(X_t) - log(X_{t-k}) \approx \frac{X_t - X_{t-k}}{X_t}\)</span>.</p>
<p>Primero, para realizar el análisis de una serie de tiempo deberemos decidir si éste se realizará para la serie en niveles o en diferencias. Por convención, decimos que la serie está en niveles si ésta se analiza sin hacerle ninguna transformación o si se analiza aplicando solo logaritmos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos o aplicando logaritmos. Sin embargo, la convención es hacer un análisis en diferencias logarítmicas.</p>
<p>Para decidir cómo analizar la serie de pasajeros en el metro de la CDMX en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig46">3.9</a> se muestra la gráfica de la serie en niveles (sin transformación logaritmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con <span class="math inline">\(k = 1\)</span>).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># En Niveles</span></span>
<span><span class="va">Pax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># En Logaritmos:</span></span>
<span><span class="va">Pax_LMetro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span><span class="va">Pax_DLMetro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, <span class="fl">1</span> <span class="op">)</span>,</span>
<span>                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Metro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_LMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_DLMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros transportados (Millones) en el SCM"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig46"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig46-1.png" alt="Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas" width="672"><p class="caption">
Figure 3.9: Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A continuación, estimaremos una <span class="math inline">\(AR(1)\)</span> para la serie en niveles bajo la transformación logarítmica (<span class="math inline">\(PaxLMetro_t\)</span>) y en diferencias logarítmicas (<span class="math inline">\(PaxDLMetro_t\)</span>). Para el primer caso, obtenemos el siguiente resultado:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:AR01">Table 3.2: </span> AR(1) para la variable <span class="math inline">\(PaxLMetro_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(PaxLMetro_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(4.7419\)</span></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.5916\)</span></td>
<td align="center"><span class="math inline">\(PaxLMetro_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0105)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0526)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.004335\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-602.73\)</span></td>
</tr>
</tbody>
</table></div>
<p>Para el segundo caso, obtenemos el siguiente resultado:</p>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<caption>
<span id="tab:AR0101">Table 3.3: </span> AR(1) para la variable <span class="math inline">\(PaxDLMetro_t\)</span>.</caption>
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(PaxDLMetro_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.0007\)</span></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.6194\)</span></td>
<td align="center"><span class="math inline">\(PaxDLMetro_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0023)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0511)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.003344\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-660.53\)</span></td>
</tr>
</tbody>
</table></div>
<p>En ambos casos observamos que el parámetro asociado al componente AR es significativo y cumple con la restricción de ser en valor absoluto menor a 1, por lo que la solución asociada al proceso será convergente. También en ambos casos se reporta la estadística o Criterio de Información de Akaike (AIC, por sus siglas en inglés), misma que más adelante discutiremos su importancia y aplicación.</p>
</div>
<div id="ar2" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> AR(2)<a class="anchor" aria-label="anchor" href="#ar2"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez analizado el caso de <span class="math inline">\(AR(1)\)</span> analizaremos el caso del <span class="math inline">\(AR(2)\)</span>. La ecuación generalizada del proceso autoregresivo de orden 2 (denotado como <span class="math inline">\(AR(2)\)</span>) puede ser escrita como:
<span class="math display" id="eq:AR2Eq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + U_t
    \tag{3.35}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> denota un proceso puramente aleatorio con media cero (<span class="math inline">\(0\)</span>), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y autocovarianza cero (<span class="math inline">\(Cov(U_t, U_s) = 0\)</span>, con <span class="math inline">\(t \neq s\)</span>), y un parámetro <span class="math inline">\(a_2 \neq 0\)</span>. Así, utilizando el operador rezago podemos reescribir la ecuación
<a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR2Eq">(3.35)</a> como:
<span class="math display">\[\begin{eqnarray*}     
    X_t - a_1 X_{t-1} - a_2 X_{t-2} &amp; = &amp; a_0 + U_t \\
    (1 - a_1 L^1 - a_2 L^2) X_t &amp; = &amp; a_0 + U_t
\end{eqnarray*}\]</span></p>
<p>Donde, vamos a denotar a <span class="math inline">\(\alpha (L) = (1 - a_1 L^1 - a_2 L^2)\)</span>, y lo denotaremos como un polinomio que depende del operador rezago y que es distinto de cero. De esta forma podemos reescribir la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR2Eq">(3.35)</a> como:
<span class="math display">\[\begin{equation}
    \alpha(L) X_t = a_0 + U_t
\end{equation}\]</span></p>
<p>Ahora, supongamos que existe el inverso multiplicativo del polinomio <span class="math inline">\(\alpha(L)\)</span>, el cual será denotado como: <span class="math inline">\(\alpha^{-1}(L)\)</span> y cumple con que:
<span class="math display">\[\begin{equation}
    \alpha^{-1}(L) \alpha(L) = 1    
\end{equation}\]</span></p>
<p>Así, podemos escribir la solución a la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR2Eq">(3.35)</a> como:
<span class="math display">\[\begin{equation*}
    X_t = \alpha^{-1}(L) \delta + \alpha^{-1}(L) U_t
\end{equation*}\]</span></p>
<p>Si utilizamos el hecho que <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede descomponer a través del procedimiento de Wold en un polinomio de forma similar al caso de <span class="math inline">\(AR(1)\)</span>, tenemos que:
<span class="math display">\[\begin{equation}
    \alpha^{-1}(L) = \psi_0 + \psi_1 L + \psi_2 L^2 + \ldots
\end{equation}\]</span></p>
<p>Por lo tanto, el inverso multiplicativo <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede ver como:
<span class="math display" id="eq:InvAlpha">\[\begin{equation}
    1 = (1 - a_1 L^1 - a_2 L^2) (\psi_0 + \psi_1 L + \psi_2 L^2 + \ldots)
    \tag{3.36}
\end{equation}\]</span></p>
<p>Desarrollando la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:InvAlpha">(3.36)</a> tenemos la siguiente expresión:
<span class="math display">\[\begin{eqnarray*}
  1 &amp; = &amp; \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots \\
  &amp;  &amp;  - a_1 \psi_0 L - a_1 \psi_1 L^2 - a_1 \psi_2 L^3 - \ldots \\
  &amp;  &amp;  - a_2 \psi_0 L^2 - a_2 \psi_1 L^3 - \ldots
\end{eqnarray*}\]</span></p>
<p>Ahora, podemos agrupar todos los términos en función del exponente asociado al operador rezago <span class="math inline">\(L\)</span>. La siguiente es una solución partícular y es una de las múltiples que podrían existir que cumpla con la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:InvAlpha">(3.36)</a>. Sin embargo, para efectos del análisis, sólo necesitamos una de esas soluciones. Utilizaremos las siguientes condiciones que deben cumplirse en una de las posibles soluciones:
<span class="math display">\[\begin{eqnarray*}
  L^0 &amp; : &amp; \Rightarrow \psi_0 = 1 \\
  L^1 &amp; : &amp; \psi_1 - a_1 \psi_0 = 0 \Rightarrow \psi_1 = a_1 \\
  L^2 &amp; : &amp; \psi_2 - a_1 \psi_1 - a_2 \psi_0 = 0 \Rightarrow \psi_2 = a^2_1 + a_2 \\
  L^3 &amp; : &amp; \psi_3 - a_1 \psi_2 - a_2 \psi_1 = 0 \Rightarrow \psi_3 = a^3_1 + 2 a_1 a_2 \\
  &amp; \vdots &amp;
\end{eqnarray*}\]</span></p>
<p>De esta forma podemos observar que en el límite siempre obtendremos una ecuación del tipo <span class="math inline">\(\psi_j - a_1 \psi_{j-1} - a_2 \psi_{j-2} = 0\)</span> asociada a cada uno de los casos en que exista un <span class="math inline">\(L^j\)</span>, donde <span class="math inline">\(j \neq 0, 1\)</span>, y la cual siempre podremos resolver conociendo que las condiciones iniciales son: <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span>.</p>
<p>Así, de las relaciones antes mencionadas y considerando que <span class="math inline">\(\alpha^{-1} (L)\)</span> aplicada a una constante como <span class="math inline">\(a_0\)</span>, tendrá como resultado otra constante. De esta forma podemos escribir que la solución del proceso AR(2) en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR2Eq">(3.35)</a> será dada por una expresión como sigue:
<span class="math display" id="eq:AR2EqSol">\[\begin{equation}
    X_t = \frac{a_0}{1 - a_1 - a_2} + \sum^{\infty}_{j = 0} \psi_{t - j} U_{t - j}
    \tag{3.37}
\end{equation}\]</span></p>
<p>Donde todos los parámetros <span class="math inline">\(\psi_i\)</span> están determinados por los parámetros <span class="math inline">\(a_0\)</span>, <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span>. En particular, <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span>, como describimos anteriormente. Al igual que en el caso del <span class="math inline">\(AR(1)\)</span>, en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:AR2EqSol">(3.37)</a> las condiciones de estabilidad estarán dadas por las soluciones del siguiente polinomio característico:
<span class="math display">\[\begin{equation}
    \lambda^2 - \lambda a_1 - a_2 = 0
\end{equation}\]</span></p>
<p>Así, la condición de estabilidad de la trayectoria es que $ | _i | &lt; 1 $, para <span class="math inline">\(i = 1, 2\)</span>. Es decir, es necesario que cada una de las raíces sea, en valor absoluto, siempre menor que la unidad. Estas son las condiciones de estabilidad para el proceso <span class="math inline">\(AR(2)\)</span>.</p>
<p>Finalmente, al igual que en un <span class="math inline">\(AR(1)\)</span>, a continuación determinamos los momentos de una serie que sigue un proceso <span class="math inline">\(AR(2)\)</span>. Iniciamos con la determinación de la media de la serie:
<span class="math display">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_0}{1 - a_1 - a_2}
\end{equation}\]</span></p>
<p>Lo anterior es cierto puesto que <span class="math inline">\(\mathbb{E}[U_{t - i}] = 0\)</span>, para todo <span class="math inline">\(i = 0, 1, 2, \ldots\)</span>. Para determinar la varianza utilizaremos las siguientes relaciones basadas en el uso del valor esperado, varianza y covarianza de la serie. Adicionalmente, para simplificar el trabajo asumamos que <span class="math inline">\(a_0 = 0\)</span>, lo cual implica que <span class="math inline">\(\mu = 0\)</span>. Dicho lo anterior, partamos de:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[X_t X_{t - \tau}] &amp; = &amp; \mathbb{E}[(a_1 X_{t-1} + a_2 X_{t-2} + U_t) X_{t - \tau}]\\
    &amp; = &amp; a_1 \mathbb{E}[X_{t - 1} X_{t - \tau}] + a_2 \mathbb{E}[X_{t - 2} X_{t - \tau}] + \mathbb{E}[U_{t} X_{t - \tau}]
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, 3, \ldots\)</span> y <span class="math inline">\(\mathbb{E}[U_{t} X_{t - \tau}] = 0\)</span> para todo <span class="math inline">\(\tau \neq 0\)</span>. Dicho esto, podemos derivar el valor del valor esperado para diferentes valores de <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray*}
    \tau = 0 &amp; : &amp; \gamma(0) = \alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2 \\
    \tau = 1 &amp; : &amp; \gamma(1) = \alpha_1 \gamma(0) + \alpha_2 \gamma(1) \\
    \tau = 2 &amp; : &amp; \gamma(2) = \alpha_1 \gamma(1) + \alpha_2 \gamma(0) \\
    &amp; \vdots &amp;
\end{eqnarray*}\]</span></p>
<p>Donde debe ser claro que <span class="math inline">\(\mathbb{E}[(X_{t} - \mu)(X_{t - \tau} - \mu)] = \mathbb{E}[X_{t} X_{t - \tau}] = \gamma(\tau)\)</span>. Así, en general cuando <span class="math inline">\(\tau \neq 0\)</span>:
<span class="math display">\[\begin{equation}    
    \gamma(\tau) = a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2)
\end{equation}\]</span></p>
<p>Realizando la sustitución recursiva y solucionando el sistema respectivo obtenemos que la varianza y las covarianzas estarán determinadas por:
<span class="math display">\[\begin{equation}
    Var[X_t] = \gamma(0) = \frac{1 - a_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \gamma(1) = \frac{a_1}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \gamma(2) = \frac{a^2_1 + a_2 - a^2_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
\end{equation}\]</span></p>
<p>Recordemos que las funciones de autocorrelación se obtienen de la división de cada una de las funciones de covarianza (<span class="math inline">\(\gamma(\tau)\)</span>) por la varianza (<span class="math inline">\(\gamma(0)\)</span>). Así, podemos construir la siguiente expresión:
<span class="math display">\[\begin{equation}
    \rho(\tau) - a_1 \rho(\tau - 1) - a_2 \rho(\tau - 2) = 0
\end{equation}\]</span></p>
<p>. Utilizaremos la serie de Pasajeros en vuelos nacionales (en vuelos de salidas) para estimar un <span class="math inline">\(AR(2)\)</span> mediante el método de máxima verosimilitud (ML, por sus siglas en inglés). Antes de realizar el proceso de estimación, consideremos una transformación de la serie en logaritmos y una más en diferencias logarítmicas; lo anterior con el objeto de obtener una serie de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Así, para cada una de las series que analicemos en diferencias logarítmicas, las expresaremos bajo la siguiente transformación:
<span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Por convención, decimos que la serie está en niveles si esta se analiza sin hacerle ninguna transformación o se analiza en logaritmos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos. Y cuando la serie analizada está en diferencias logarítmicas también diremos que está en diferencias. Sin embargo, lo común es hacer un análisis en logaritmos y en diferencias logarítmicas.</p>
<p>Primero, para decidir si se realizará un AR(2) para la serie en niveles o en diferencias, analizaremos su gráfica. La serie en niveles, en niveles bajo una transformación logarítmica y en diferencias logarítmicas mensuales de los pasajeros en vuelos nacionales se muestra en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig47">3.10</a>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># En Niveles</span></span>
<span><span class="va">Pax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logaritmos:</span></span>
<span><span class="va">LPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span><span class="va">DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Nal</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros en vuelos nacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LPax_Nal</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"LN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros en vuelos nacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DLPax_Nal</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"DLN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros en vuelos nacionales de salida"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig47"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig47-1.png" alt="Pasajeros en vuelos de salidas nacionales en niveles y en diferencias logaritmicas" width="672"><p class="caption">
Figure 3.10: Pasajeros en vuelos de salidas nacionales en niveles y en diferencias logaritmicas
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A continuación, estimaremos un <span class="math inline">\(AR(2)\)</span> para la serie en niveles bajo una transformación logarítmica (<span class="math inline">\(LPaxNal_t\)</span>) y en diferencias logaritmitcas (<span class="math inline">\(DLPax_Nal_t\)</span>). Para el primer caso obtenemos el siguiente resultado:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:AR02">Table 3.4: </span> AR(2) para la variable <span class="math inline">\(LPaxNal_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(LPaxNal_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(14.6267\)</span></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.7637\)</span></td>
<td align="center"><span class="math inline">\(LPaxNal_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.1816)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0637)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(0.2025\)</span></td>
<td align="center"><span class="math inline">\(LPaxNal_{t-2}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0646)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.01138\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-372.64\)</span></td>
</tr>
</tbody>
</table></div>
<p>Para el segundo caso obtenemos el siguiente resultado:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:AR0201">Table 3.5: </span> AR(2) para la variable <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.0050\)</span></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.3205\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0036)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0592)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(0.4242\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-2}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0591)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.009378\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-418.3\)</span></td>
</tr>
</tbody>
</table></div>
<p>Para ambos casos, entre paréntesis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes para ello en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig48">3.11</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual, podemos concluir que ambas propuestas de AR(2) representan una solución convergente y estable.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"arroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_LPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Nal</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                     method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                      method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_LPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): LN Pax Nal"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_DLPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): Diff LN Pax Nal"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig48"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig48-1.png" alt="Inveso de las Raíces del polinomio característico" width="672"><p class="caption">
Figure 3.11: Inveso de las Raíces del polinomio característico
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="arp" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> AR(p)<a class="anchor" aria-label="anchor" href="#arp"><i class="fas fa-link"></i></a>
</h3>
<p>Veremos ahora una generalización de los procesos autoregresivos (AR). Esta generalización es conocida como un proceso <span class="math inline">\(AR(p)\)</span> y que puede ser descrito por la siguiente ecuación en diferencia estocástica:
<span class="math display" id="eq:ARpEq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + a_p X_{t-p} + U_t
    \tag{3.38}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_p \neq 0\)</span>, y <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con media cero (0), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y covarianza cero (0). Usando el operador rezago, <span class="math inline">\(L^k\)</span>, para <span class="math inline">\(k = 0, 1, 2, \ldots, p\)</span>, obtenemos la siguiente expresión de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARpEq">(3.38)</a>:
<span class="math display">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p) X_t = a_0 + U_t
\end{equation}\]</span></p>
<p>Definamos el polinomio <span class="math inline">\(\alpha(L)\)</span> como:
<span class="math display" id="eq:PolA">\[\begin{equation}
    \alpha(L) = 1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p
    \tag{3.39}
\end{equation}\]</span></p>
<p>De forma similar que en los procesos <span class="math inline">\(AR(1)\)</span> y <span class="math inline">\(AR(2)\)</span>, las condiciones de estabilidad del proceso <span class="math inline">\(AR(p)\)</span> estarán dadas por la solución de la ecuación característica:
<span class="math display">\[\begin{equation}
    \lambda^p - a_1 \lambda^{p-1} - a_2 \lambda^{p-2} - a_3 \lambda^{p-3} - \ldots - a_p = 0
\end{equation}\]</span></p>
<p>Así, solo si el polinomio anterior tiene raíces cuyo valor absoluto sea menor a uno ($ | _i | &lt; 1 $) y si <span class="math inline">\(1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p &lt; 1\)</span> podremos decir que el proceso es convergente y estable. Lo anterior significa que la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:PolA">(3.39)</a> puede expresarse en términos de la descomposición de Wold o como la suma infinita de términos como:
<span class="math display">\[\begin{equation}
    \frac{1}{1 - a_1 L  - a_2 L^2 - a_3 L^3  - \ldots - a_p L^p} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
\end{equation}\]</span></p>
<p>Donde, por construcción de <span class="math inline">\(\alpha(L) \alpha^{-1}(L) = 1\)</span> implica que <span class="math inline">\(\psi_0 = 1\)</span>. De forma similar a los procesos AR(1) y AR(2), es posible determinar el valor de los coeficientes <span class="math inline">\(\psi_j\)</span> en términos de los coeficientes <span class="math inline">\(a_i\)</span>. Así, la solución del proceso <span class="math inline">\(AR(p)\)</span> estará dada por:
<span class="math display" id="eq:ARpEqSol">\[\begin{equation}
    X_t = \frac{a_0}{1 - a_1  - a_2 - a_3  - \ldots - a_p} + \sum^{\infty}_{j = 0} \psi_j U_{t-j}
    \tag{3.40}
\end{equation}\]</span></p>
<p>Considerando la solución de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARpEq">(3.38)</a> expresada en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARpEqSol">(3.40)</a> podemos determinar los momentos del proceso y que estarán dados por una media como:
<span class="math display">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_o}{1 - a_1  - a_2 - a_3  - \ldots - a_p}
\end{equation}\]</span></p>
<p>Lo anterior, considerado que <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, para todo <span class="math inline">\(t\)</span>. Para determinar la varianza del proceso, sin pérdida de generalidad, podemos definir una ecuación: <span class="math inline">\(\gamma(\tau) = \mathbb{E}[X_{t - \tau} X_t]\)</span>, la cual (omitiendo la constante, ya que la correlación de una constante con cuaquier variable aleatoria que depende del tiempo es cero (0)) puede ser escrita como:
<span class="math display">\[\begin{equation}
    \gamma(\tau) = \mathbb{E}[(X_{t - \tau}) \cdot (a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + + a_p X_{t-p} + U_t)]
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, \ldots, p\)</span> y <span class="math inline">\(a_0 = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>. De lo anterior obtenemos el siguiente conjunto de ecuaciones mediante sustituciones de los valores de <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; a_1 \gamma(1) + a_2 \gamma(2) + \ldots + a_p \gamma(p) + \sigma^2 \nonumber \\
    \gamma(1) &amp; = &amp; a_1 \gamma(0) + a_2 \gamma(1) + \ldots + a_p \gamma(p-1) \nonumber \\
    \vdots \nonumber \\
    \gamma(p) &amp; = &amp; a_1 \gamma(p-1) + a_2 \gamma(p-2) + \ldots + a_p \gamma(0) \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma, es fácil observar que la ecuación general para <span class="math inline">\(p &gt; 0\)</span> estará dada por:
<span class="math display" id="eq:Gammap">\[\begin{equation}
    \gamma(p) - a_1 \gamma(\tau - 1) - a_2 \gamma(\tau - 2) - \ldots - a_p \gamma(\tau - p) = 0
    \tag{3.41}
\end{equation}\]</span></p>
<p>Dividiendo la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:Gammap">(3.41)</a> por <span class="math inline">\(\gamma(0)\)</span>, se obtiene la siguiente ecuación:
<span class="math display">\[\begin{equation}
    \rho(p) - a_1 \rho(\tau - 1) + a_2 \rho(\tau - 2) + \ldots + a_p \rho(\tau - p) = 0
\end{equation}\]</span></p>
<p>Así, podemos escribir el siguiente sistema de ecuaciones:
<span class="math display">\[\begin{eqnarray}
    \rho(1) &amp; = &amp; a_1 + a_2 \rho(1) + a_3 \rho(2) + \ldots + a_p \rho(p-1) \nonumber \\
    \rho(2) &amp; = &amp; a_1 \rho(1) + a_2 + a_3 \rho(1) + \ldots + a_p \rho(p-2) \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \rho(p) &amp; = &amp; a_1 \rho(p-1) + a_2 \rho(p-2) + \ldots + a_p \nonumber
\end{eqnarray}\]</span></p>
<p>Lo anterior se puede expresar como un conjunto de vectores y matrices de la siguiente forma:
<span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(p)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(p - 1) \\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(p - 2) \\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(p - 3) \\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
        \rho(p - 1) &amp; \rho(p - 2) &amp; \ldots &amp; 1 \\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        a_1 \\
        a_2 \\
        a_3 \\
        \vdots \\
        a_p \\
    \end{array}
    \right]
\end{equation}\]</span></p>
<p>De lo anterior podemos escribir la siguiente ecuación que es una forma alternativa para expresar los valores de los coeficientes <span class="math inline">\(a_i\)</span> de la solución del proceso <span class="math inline">\(AR(p)\)</span>:
<span class="math display">\[\begin{equation}
    \boldsymbol{\rho} = \mathbf{R} \mathbf{a}
\end{equation}\]</span></p>
<p>Es decir, podemos obtener la siguiente expresión:
<span class="math display">\[\begin{equation}
    \mathbf{a} = \mathbf{R}^{-1} \boldsymbol{\rho}
\end{equation}\]</span></p>
<p>. Utilizaremos la serie de Pasajeros en vuelos internacionales de salida para estimar un <span class="math inline">\(AR(p)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación, consideremos una transformación de la serie en logaritmos y una más en diferencias logarítmicas; lo anterior con el objeto de obtener una serie de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Primero, para decidir si se realizará un <span class="math inline">\(AR(p)\)</span> para la serie en niveles o en diferencias, analizaremos su gráfica. La serie de Pasajeros en vuelos internacionales de salidas se muestra en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig49">3.12</a>. En esta se muestra la gráfica de la serie en niveles (sin transformación logarítmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con diferencia respecto del mes inmediato anterior).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># En Niveles</span></span>
<span><span class="va">Pax_Int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Int</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logaritmos:</span></span>
<span><span class="va">LPax_Int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span><span class="va">DLPax_Int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Int</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros en vuelos internacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LPax_Int</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"LN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros en vuelos internacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DLPax_Int</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"DLN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros en vuelos internacionales de salia"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig49"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig49-1.png" alt="Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas" width="672"><p class="caption">
Figure 3.12: Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas
</p>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>De la gráfica en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig49">3.12</a> observamos que quizá la mejor forma de estimar un <span class="math inline">\(AR(p)\)</span> es mediante la serie en diferencias, ya que ésta es la que parece ser una serie estacionaria. A continuación, estimaremos una AR(4) para la serie en diferencias logarítmicas (<span class="math inline">\(DLPaxInt_t\)</span>):</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:AR04">Table 3.6: </span> AR(4) para la variable <span class="math inline">\(DLPaxInt_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxInt_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.0050\)</span></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.2701\)</span></td>
<td align="center"><span class="math inline">\(DLPaxInt_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0052)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0655)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-0.4326\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-2}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0664)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-0.1956\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-3}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0664)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-0.0316\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-4}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0653)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.02371\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-198.16\)</span></td>
</tr>
</tbody>
</table></div>
<p>Entre paréntesis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig410">3.13</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que el AR(4) representan una solución convergente y estable.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"arroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_LPax_Int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Int</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                     method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_DLPax_Int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Int</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>                      method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_LPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): LN Pax Int"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_DLPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): Diff LN Pax Int"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig410"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig410-1.png" alt="Inveso de las Raíces del polinomio característico" width="672"><p class="caption">
Figure 3.13: Inveso de las Raíces del polinomio característico
</p>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="procesos-de-medias-móviles-ma" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Procesos de Medias Móviles (MA)<a class="anchor" aria-label="anchor" href="#procesos-de-medias-m%C3%B3viles-ma"><i class="fas fa-link"></i></a>
</h2>
<div id="ma1" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> MA(1)<a class="anchor" aria-label="anchor" href="#ma1"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez planteado el proceso generalizado de <span class="math inline">\(AR(p)\)</span>, iniciamos el planteamiento de los procesos de medias móviles, denotados como <span class="math inline">\(MA(q)\)</span>. Iniciemos con el planteamiento del proceso <span class="math inline">\(MA(1)\)</span>, que se puede escribir como una ecuación como la siguiente:
<span class="math display" id="eq:MA1Eq">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1}
    \tag{3.42}
\end{equation}\]</span></p>
<p>O como:
<span class="math display">\[\begin{equation}
    X_t - \mu = (1 - b_1 L) U_{t}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, es decir, con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \sigma^2\)</span>, y <span class="math inline">\(Cov[U_t, U_s] = 0\)</span>. Así, un proceso <span class="math inline">\(MA(1)\)</span> puede verse como un proceso AR con una descomposición de Wold en la que <span class="math inline">\(\psi_0 = 1\)</span>, <span class="math inline">\(\psi_1 = - b_1\)</span> y <span class="math inline">\(\psi_j = 0\)</span> para todo <span class="math inline">\(j &gt; 1\)</span>.</p>
<p>Al igual que los procesos autoregresivos, determinaremos los momentos de un proceso <span class="math inline">\(MA(1)\)</span>. En el caso de la media, observamos que será:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t - 1}] \nonumber \\
    &amp; = &amp; \mu
\end{eqnarray}\]</span></p>
<p>Por su parte, la varianza estará dada por:
<span class="math display">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 - 2 b_1 U_t U_{t-1} + b_1^2 U_{t - 1}^2] \nonumber \\
    &amp; = &amp;\mathbb{E}[U_t^2] - 2 b_1 \mathbb{E}[U_t U_{t-1}] + b_1^2 \mathbb{E}[U_{t - 1}^2]] \nonumber \\
    &amp; = &amp; \sigma^2 + b_1^2 \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b_1^2) \sigma^2 = \gamma(0)
\end{eqnarray}\]</span></p>
<p>De esta forma, la varianza del proceso es constante en cualquier periodo <span class="math inline">\(t\)</span>. Para determinar la covarianza utilizaremos la siguiente ecuación:
<span class="math display" id="eq:MA1Cov">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + \tau} - \mu)] &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})(U_{t + \tau} - b_1 U_{t + \tau - 1})] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau} - b_1 U_t U_{t + \tau - 1} - b_1 U_{t - 1} U_{t + \tau} \nonumber \\
    &amp;   &amp; + b_1^2 U_{t - 1} U_{t + \tau - 1}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau}] - b_1 \mathbb{E}[U_t U_{t + \tau - 1}] \nonumber \\
    &amp;   &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t + \tau}] + b_1^2 \mathbb{E}[U_{t - 1} U_{t + \tau - 1}]
    \tag{3.43}
\end{eqnarray}\]</span></p>
<p>Si hacemos sustituciones de diferentes valores de <span class="math inline">\(\tau\)</span> en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MA1Cov">(3.43)</a> notaremos que la covarianza será distinta de cero únicamente para el caso de <span class="math inline">\(\tau = 1, -1\)</span>. En ambos casos tendremos como resultado:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + 1} - \mu)] &amp; = &amp; \mathbb{E}[(x_t - \mu)(x_{t - 1} - \mu)] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_t U_{t}] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t - 1}] \nonumber \\
    &amp; = &amp; - b_1^2 \sigma^2 = \gamma(1)
\end{eqnarray}\]</span></p>
<p>De esta forma tendremos que las funciones de autocorrelación estarán dadas por los siguientes casos:
<span class="math display">\[\begin{eqnarray}
    \rho(0) &amp; = &amp; 1 \nonumber \\
    \rho(1) &amp; = &amp; \frac{- b_1}{1 + b_1^2} \nonumber \\
    \rho(\tau) &amp; = &amp; 0 \text{ para todo } \tau &gt; 1 \nonumber
\end{eqnarray}\]</span></p>
<p>Ahora regresando a la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MA1Eq">(3.42)</a>, su solución la podemos expresar como:
<span class="math display">\[\begin{eqnarray}
    U_ t &amp; = &amp; - \frac{\mu}{1 - b_1} + \frac{1}{1 - b_1 L} X_t \nonumber \\
    &amp; = &amp; - \frac{\mu}{1 - b_1} + X_t + b_1 X_{t-1} + b_1^2 X_{t-2} + \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>Donde la condición para que se cumpla esta ecuación es que $ | b_1 | &lt; 1 $. La manera de interpretar esta condición es como una condición de estabilidad de la solución y cómo una condición de invertibilidad. Notemos que un <span class="math inline">\(MA(1)\)</span> (y en general un <span class="math inline">\(MA(q)\)</span>) es equivalente a un <span class="math inline">\(AR(\infty)\)</span>, es decir, cuando se invierte un MA se genera un AR con infinitos rezagos.</p>
<p>En esta sección no desarrollaremos un ejemplo, primero explicaremos en qué consiste una modelación del tipo <span class="math inline">\(MA(q)\)</span> y después plantearemos un ejemplo en concreto.</p>
</div>
<div id="maq" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> MA(q)<a class="anchor" aria-label="anchor" href="#maq"><i class="fas fa-link"></i></a>
</h3>
<p>En general, el proceso de medias móviles de orden <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span>, puede ser escrito como:
<span class="math display" id="eq:MAqEQ">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}
    \tag{3.44}
\end{equation}\]</span></p>
<p>Podemos reescribir la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MAqEQ">(3.44)</a> utilizando el operador rezago. Así, tendremos el proceso de <span class="math inline">\(MA(q)\)</span> como:
<span class="math display" id="eq:MAqRed">\[\begin{eqnarray}
    X_t - \mu &amp; = &amp; (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_{t} \nonumber \\
    X_t - \mu &amp; = &amp; \beta(L) U_t
    \tag{3.45}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \mathbb{E}[U_t^2] = 0\)</span> y <span class="math inline">\(Cov[U_t, U_s] = \mathbb{E}[U_t, U_s] = 0\)</span>, y <span class="math inline">\(\beta(L) = 1 - b_1 L - b_2 L^2 - \ldots - b_q L^q\)</span> es un polinomio del operador rezago <span class="math inline">\(L\)</span>. La ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MAqRed">(3.45)</a> puede ser interpretada como un proceso <span class="math inline">\(AR(q)\)</span> sobre la serie <span class="math inline">\(U_t\)</span>.</p>
<p>Ahora determinemos los momentos de un proceso <span class="math inline">\(MA(q)\)</span>:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}] \nonumber \\
    &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t-1}] - b_2 \mathbb{E}[U_{t-2}] - \ldots - b_q \mathbb{E}[U_{t-q}] \nonumber \\
    &amp; = &amp; \mu
\end{eqnarray}\]</span></p>
<p>En el caso de la varianza tenemos que se puede expresar como:
<span class="math display">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 + b_1^2 U_{t-1}^2 + b_2^2 U_{t-2}^2 + \ldots + b_q^2 U_{t-q}^2 \nonumber \\
    &amp;   &amp; - 2 b_1 U_t U_{t - 1} - \ldots - 2 b_{q - 1} b_q U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2] + b_1^2 \mathbb{E}[U_{t-1}^2] + b_2^2 \mathbb{E}[U_{t-2}^2] + \ldots + b_q^2 \mathbb{E}[U_{t-q}^2] \nonumber \\
    &amp;   &amp; - 2 b_1 \mathbb{E}[U_t U_{t - 1}] - \ldots - 2 b_{q - 1} b_q \mathbb{E}[U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \sigma^2 + b^2_1 \sigma^2 + b^2_2 \sigma^2 + \ldots + b^2_q \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b^2_1 + b^2_2 + \ldots + b^2_q) \sigma^2
\end{eqnarray}\]</span></p>
<p>En el caso de las covarianzas podemos utilizar una idea similar al caso del <span class="math inline">\(AR(p)\)</span>, construir una expresión general para cualquier rezago <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    Cov[X_t, X_{t + \tau}] &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}) \nonumber \\
    &amp;   &amp; (U_{t + \tau} - b_1 U_{t + \tau -1} - b_2 U_{t + \tau -2} - \ldots - b_q U_{t + \tau - q})] \nonumber
\end{eqnarray}\]</span></p>
<p>La expresión anterior se puede desarrollar para múltiples casos de <span class="math inline">\(\tau = 1, 2, \ldots, q\)</span>. De esta forma tenemos el siguiente sistema:
<span class="math display">\[\begin{eqnarray}
    \tau = 1 &amp; : &amp; \gamma(1) = (- b_1 + b_1 b_2 + \ldots + b_{q-1} b_q) \sigma^2 \nonumber \\
    \tau = 2 &amp; : &amp; \gamma(2) = (- b_2 + b_1 b_3 + \ldots + b_{q-2} b_q) \sigma^2 \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \tau = q &amp; : &amp; \gamma(q) = b_q \sigma^2 \nonumber
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\gamma(\tau) = 0\)</span> para todo <span class="math inline">\(\tau &gt; q\)</span>. Es decir, todas las autocovarianzas y autocorrelaciones con órdenes superiores a <span class="math inline">\(q\)</span> son cero (0). De esta forma, esta característica teórica permite identificar el orden de <span class="math inline">\(MA(q)\)</span> visualizando la función de autocorrelación y verificando a partir de cuál valor de rezago la autocorrelación es no significativa.</p>
<p>Regresando al problema original que es el de determinar una solución para la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MAqEQ">(3.44)</a>, tenemos que dicha solución estará dada por un <span class="math inline">\(AR(\infty)\)</span> en términos de <span class="math inline">\(U_t\)</span>:
<span class="math display" id="eq:MAqEQSol">\[\begin{eqnarray}
    U_t &amp; = &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \beta(L)^{-1} X_t \nonumber \\
    &amp;   &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \sum_{j = 0}^{\infty} c_j X_{t-j}
    \tag{3.46}
\end{eqnarray}\]</span></p>
<p>Donde se cumple que: <span class="math inline">\(1 = (1 - b_1 L^1 - b_2 L^2 - \ldots - b_q L^q)(1 - c_1 L - c_2 L^2 - \ldots)\)</span> y los coeficientes <span class="math inline">\(c_j\)</span> se pueden determinar por un método de coeficientes indeterminados y en términos de los valores <span class="math inline">\(b_i\)</span>. De igual forma que en el caso de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARpEq">(3.38)</a>, en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:MAqEQSol">(3.46)</a> se deben cumplir condiciones de estabilidad asociadas con las raíces del polinomio característico dado por:
<span class="math display">\[\begin{equation}
    1 - b_1 x - b_2 x^2 - \ldots b_q x^q = 0
\end{equation}\]</span></p>
<p>El cual debe cumplir que $ | x_i | &lt; 1 $ y que <span class="math inline">\(1 - b_1 - b_2 - \ldots b_q &lt; 1\)</span>.</p>
<p>. Ahora veamos un ejemplo del proceso <span class="math inline">\(MA(q)\)</span>, para lo cual retomaremos la serie de Pasajeros transportados en el metro de la CDMX (<span class="math inline">\(PaxMetro\)</span>). Estimaremos el <span class="math inline">\(MA(q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación, consideremos una transformación de la serie en logaritmos y una más en diferencias logarítmicas; lo anterior con el objeto de obtener una serie de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>La serie de Pasajeros transportados en el metro de la CDMX se muestra en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig46">3.9</a>. En esta, se muestra la gráfica de la serie en niveles (sin transformación logarítmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con una diferencia respecto del mes inmediato anterior). Utilizaremos la serie en diferencias, ya que es la que parece ser estacionaria. Esta serie tiene la peculiaridad de que tiene un salto a la baja y uno al alza entre septiembre de 2017 y octubre de 2017. Para controlar ese efecto, en nuestro modelo <span class="math inline">\(MA(q)\)</span> incluiremos dos variables dummies para dichos meses.</p>
<p>A continuación, estimaremos una <span class="math inline">\(MA(4)\)</span> para la serie en diferencias:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:MA04">Table 3.7: </span> MA(4) para la variable <span class="math inline">\(DLPaxMetro_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxMetro_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.0000\)</span></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.7804\)</span></td>
<td align="center"><span class="math inline">\(U_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0000)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0661)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.3591\)</span></td>
<td align="center"><span class="math inline">\(U_{t-2}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0826)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.2775\)</span></td>
<td align="center"><span class="math inline">\(U_{t-3}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0908)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.1120\)</span></td>
<td align="center"><span class="math inline">\(U_{t-4}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0769)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.3789\)</span></td>
<td align="center"><span class="math inline">\(DSep2017\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0436)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.3695\)</span></td>
<td align="center"><span class="math inline">\(DOct2017\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0434)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.002176\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-749.94\)</span></td>
</tr>
</tbody>
</table></div>
<p>Entre parentésis indicamos los errores estándar y al final reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si la solución serán convergente, para ello en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig411">3.14</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual, podemos concluir que ambas propuestas de MA(4) representan una solución convergente y estable.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte_ARIMA.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"maroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LPax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, </span>
<span>                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                 freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span> <span class="op">-</span> </span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                  freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Sep2017</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Sep2017</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_May2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_May2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MA_LPax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Metro</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>                       method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MA_LPax_Metro_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Metro</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                       xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Abr2020</span>, <span class="va">D_Sep2017</span>, </span>
<span>                                    <span class="va">D_May2020</span><span class="op">)</span>,</span>
<span>                       method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">maroots</span><span class="op">(</span><span class="va">MA_LPax_Metro</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse MA roots of \nMA(p): LN PAx Metro"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">maroots</span><span class="op">(</span><span class="va">MA_LPax_Metro_2</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse MA roots of \nMA(p): LN PAx Metro con Dummy"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig411"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig411-1.png" alt="Inveso de las Raíces del polinomio característico" width="672"><p class="caption">
Figure 3.14: Inveso de las Raíces del polinomio característico
</p>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="procesos-armap-q-y-arimap-d-q" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Procesos ARMA(p, q) y ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#procesos-armap-q-y-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Hemos establecido algunas relaciones de los procesos AR y los procesos MA, es decir, cómo un <span class="math inline">\(MA(q)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reexpresada como un <span class="math inline">\(AR(\infty)\)</span> de la serie <span class="math inline">\(U_t\)</span>, y viceversa un <span class="math inline">\(AR(p)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reeexpresada como un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>En este sentido, para cerrar esta sección veamos el caso de la especificación que conjunta ambos modelos en un modelo general conocido como <span class="math inline">\(ARMA(p, q)\)</span> o <span class="math inline">\(ARIMA(p, d, q)\)</span>. La diferencia entre el primero y el segundo es las veces que se tuvo que diferenciar la serie analizada, registro que se lleva en el índice <span class="math inline">\(d\)</span> de los parámetros dentro del concepto <span class="math inline">\(ARIMA(p, d, q)\)</span>. No obstante, en general nos referiremos al modelo como <span class="math inline">\(ARMA(p, q)\)</span> y dependerá del analista si modela la serie en niveles (por ejemplo, en logaritmos) o en diferencias logarítmicas (o diferencias sin logaritmos).</p>
<div id="arma1-1" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> ARMA(1, 1)<a class="anchor" aria-label="anchor" href="#arma1-1"><i class="fas fa-link"></i></a>
</h3>
<p>Dicho lo anterior, vamos a empezar con el análisis de un <span class="math inline">\(ARMA(1, 1)\)</span>. Un proceso <span class="math inline">\(ARMA(1, 1)\)</span> puede verse como:
<span class="math display" id="eq:ARMA11Eq">\[\begin{equation}
    X_t = \delta + a_1 X_{t - 1} + U_t - b_1 U_{t - 1}
    \tag{3.47}
\end{equation}\]</span></p>
<p>Aplicando el operado rezago podemos rescribir la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Eq">(3.47)</a> como:
<span class="math display">\[\begin{equation}
    (1 - a_1 L) X_t = \delta + (1 - b_1 L) U_t
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio como en los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>, y <span class="math inline">\(X_t\)</span> puede ser una serie en niveles o en diferencias (ambas, en términos logarítmicos).</p>
<p>Así, el modelo <span class="math inline">\(ARIMA (p, q)\)</span> también tiene una representación de Wold que estará dada por las siguientes expresiones:
<span class="math display" id="eq:ARMA11Prev">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + \frac{1 - b_1 L}{1 - a_1 L} U_t
    \tag{3.48}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_1 \neq b_1\)</span>, puesto que en caso contrario <span class="math inline">\(X_t\)</span> sería un proceso puramente aleatorio con una media <span class="math inline">\(\mu = \frac{\delta}{1 - a_1}\)</span>. Así, podemos reescribir la descomposición de Wold a partir del componente de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Prev">(3.48)</a>:
<span class="math display" id="eq:ARMA11EqWold">\[\begin{equation}
    \frac{1 - b_1 L}{1 - a_1 L} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
    \tag{3.49}
\end{equation}\]</span></p>
<p>Está ecuación es equivalente a la expresión:
<span class="math display">\[\begin{eqnarray}
    (1 - b_1 L) &amp; = &amp; (1 - a_1 L)(\psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots) \nonumber \\
    &amp; = &amp; \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots \nonumber \\
    &amp;   &amp; - a_1 \psi_0 L - a_1 \psi_1 L^2 - a_2 \psi_2 L^3 - a_1 \psi_3 L^4 - \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma podemos establecer el siguiente sistema de coeficientes indeterminados:
<span class="math display">\[\begin{eqnarray*}
    L^0 &amp; : &amp; \Rightarrow \psi_0 = 1 \\
    L^1 &amp; : &amp; \psi_1 - a_1 \psi_0 = - b_1 \Rightarrow \psi_1 = a_1 - b_1 \\
    L^2 &amp; : &amp; \psi_2 - a_1 \psi_1 = 0 \Rightarrow \psi_2 = a_1(a_1 - b_1) \\
    L^3 &amp; : &amp; \psi_3 - a_1 \psi_2 = 0 \Rightarrow \psi_3 = a^2_1(a_1 - b_1) \\
     &amp; \vdots &amp;  \\
    L^j &amp; : &amp; \psi_j - a_1 \psi_{j - 1} = 0 \Rightarrow \psi_j = a^{j - 1}_1(a_1 - b_1)
\end{eqnarray*}\]</span></p>
<p>Así, la solución a la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Eq">(3.47)</a> estará dada por la siguiente generalización:
<span class="math display" id="eq:ARMA11Sol">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + U_t + (a_1 - b_1) U_{t - 1} + a_1(a_1 - b_1) U_{t - 2} + a_1^2(a_1 - b_1) U_{t - 3} + \ldots
    \tag{3.50}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Sol">(3.50)</a> las condiciones de estabilidad y de invertibilidad del sistema (de un MA a un AR, y viceversa) estarán dadas por: $ | a_1 | &lt; 1 $ y $ | b_1 | &lt; 1 $. Adicionalmente, la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Sol">(3.50)</a> expresa cómo una serie que tiene un comportamiento <span class="math inline">\(ARMA(1, 1)\)</span> es equivalente a una serie modelada bajo un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>Al igual que en los demás modelos, ahora determinaremos los momentos del proceso <span class="math inline">\(ARMA(1, 1)\)</span>. La media estará dada por:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\delta + a_1 X_{t-1} + U_t - b_1 U_{t-1}] \nonumber \\
    &amp; = &amp; \delta + a_1 \mathbb{E}[X_{t-1}] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1} \nonumber \\
    &amp; = &amp; \mu
\end{eqnarray}\]</span></p>
<p>Donde hemos utilizado que <span class="math inline">\(\mathbb{E}[X_t] = \mathbb{E}[X_{t-1}] = \mu\)</span>. Es decir, la media de un <span class="math inline">\(ARMA(1, 1)\)</span> es idéntica a la de un <span class="math inline">\(AR(1)\)</span>.</p>
<p>Para determinar la varianza tomaremos una estrategia similar a los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>. Por lo que para todo <span class="math inline">\(\tau \geq 0\)</span>, y suponiendo por simplicidad que <span class="math inline">\(\delta = 0\)</span> (lo que implica que <span class="math inline">\(\mu = 0\)</span>) tendremos:
<span class="math display" id="eq:ARMA11Cov">\[\begin{eqnarray}
    \mathbb{E}[X_{t-\tau} X_t] &amp; = &amp; \mathbb{E}[(X_{t-\tau}) \cdot (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \mathbb{E}[X_{t-\tau} X_{t-1}] + \mathbb{E}[X_{t-\tau} U_t] - b_1 \mathbb{E}[X_{t-\tau} U_{t-1}]
    \tag{3.51}
\end{eqnarray}\]</span></p>
<p>De la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMA11Cov">(3.51)</a> podemos determinar una expresión para el caso de <span class="math inline">\(\tau = 0\)</span>:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_{t} X_t] &amp; = &amp; \gamma(0) \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \mathbb{E}[U_t X_t] - b_1 \mathbb{E}[X_t U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 + b_1 \mathbb{E}[U_{t-1} (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 - b_1 a_1 \sigma^2 + b_1 \sigma^2 \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + (1 - b_1 (a_1 - b_1)) \sigma^2
\end{eqnarray}\]</span></p>
<p>Para el caso en que <span class="math inline">\(\tau = 1\)</span>: <span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_{t-1} X_t] &amp; = &amp; \gamma(1) \nonumber \\
    &amp; = &amp; a_1 \gamma(0) + \mathbb{E}[X_{t-1} U_t] - b_1 \mathbb{E}[X_{t-1} U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(0) - b_1 \sigma^2
\end{eqnarray}\]</span></p>
<p>Estas últimas expresiones podemos resolverlas como sistema para determinar los siguientes valores:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; \frac{1 + b_1^2 - 2 a_1 b_1}{1 - a_1^2} \sigma^2 \\
    \gamma(1) &amp; = &amp; \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 - a_1^2} \sigma^2
\end{eqnarray}\]</span></p>
<p>En general, para cualquier valor <span class="math inline">\(\tau \geq 2\)</span> tenemos que la autocovarianza y la función de autocorrelación serán:
<span class="math display">\[\begin{eqnarray}
    \gamma(\tau) = a_1 \gamma(\tau - 1) \\
    \rho(\tau) = a_1 \rho(\tau - 1)
\end{eqnarray}\]</span></p>
<p>Por ejemplo, para el caso de <span class="math inline">\(\tau = 1\)</span> tendríamos:
<span class="math display">\[\begin{equation}
    \rho(1) = \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 + b_1^2 - 2 a_1 b_1}
\end{equation}\]</span></p>
<p>De esta forma, la función de autocorrelación oscilará en razón de los valores que tome <span class="math inline">\(a_1\)</span> y <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="armap-q" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> ARMA(p, q)<a class="anchor" aria-label="anchor" href="#armap-q"><i class="fas fa-link"></i></a>
</h3>
<p>La especificación general de un <span class="math inline">\(ARMA(p, q)\)</span> (donde <span class="math inline">\(p, q \in \mathbb{N}\)</span>) puede ser descrita por la siguiente ecuación:
<span class="math display" id="eq:ARMApqEq">\[\begin{eqnarray}
    X_t &amp; = &amp; \delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q}
    \tag{3.52}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, y <span class="math inline">\(X_t\)</span> puede ser modelada en niveles o en diferencias (ya sea en logaritmos o sin transformación logarítmica).</p>
<p>Mediante el uso del operador rezago se puede escribir la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqEq">(3.52)</a> como:
<span class="math display" id="eq:ARMApqEqLag">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p) X_t = \delta + (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_t
    \tag{3.53}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqEqLag">(3.53)</a> definamos dos polinomios: <span class="math inline">\(\alpha(L) = (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p)\)</span> y <span class="math inline">\(\beta(L) = (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q)\)</span>. Así, podemos reescribir la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqEqLag">(3.53)</a> como:
<span class="math display">\[\begin{equation}
    \alpha(L) X_t = \delta + \beta(L) U_t
\end{equation}\]</span></p>
<p>Asumiendo que existe el polinomio inverso tal que: <span class="math inline">\(\alpha(L)^{-1}\alpha(L) = 1\)</span>.La solución entonces puede ser escrita como:
<span class="math display" id="eq:ARMApqWold">\[\begin{eqnarray}
    X_t &amp; = &amp; \alpha(L)^{-1} \delta + \alpha(L)^{-1} \beta(L) U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + \frac{\beta(L)}{\alpha(L)} U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 L U_t + \psi_2 L^2 U_t + \ldots
    \tag{3.54}
\end{eqnarray}\]</span></p>
<p>Donde la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqWold">(3.54)</a> nos permite interpretar que un ARMA(p, q) se puede reexpresar e interpretar como un <span class="math inline">\(MA(\infty)\)</span> y donde las condiciones para la estabilidad de la solución y la invertibilidad son que las raíces de los polinomios característicos <span class="math inline">\(\alpha(L)\)</span> y <span class="math inline">\(\beta(L)\)</span> son en valor absoluto menores a 1.</p>
<p>Adicionalmente, la fracción en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqWold">(3.54)</a> se puede descomponer como en la forma de Wold:
<span class="math display">\[\begin{equation}
    \frac{\beta(L)}{\alpha(L)} = 1 + \psi_1 L + \psi_2 L^2 + \ldots
\end{equation}\]</span></p>
<p>Bajo los supuestos de estacionariedad del componente <span class="math inline">\(U_t\)</span>, los valores de la media y varianza de un proceso <span class="math inline">\(ARMA(p, q)\)</span> serán como describimos ahora. Para el caso de la media, podemos partir de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqWold">(3.54)</a> para generar:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}\left[ \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 U_{t-1} + \psi_2 U_{t-2} + \ldots \right] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} \nonumber \\
    &amp; = &amp; \mu
\end{eqnarray}\]</span></p>
<p>Esta expresión indica que en general un proceso <span class="math inline">\(ARMA(p, q)\)</span> converge a una media idéntica a la de un proceso <span class="math inline">\(AR(p)\)</span>. Para determinar la varianza utilizaremos la misma estrategia que hemos utilizado para otros modelos <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>.</p>
<p>Sin pérdida de generalidad podemos asumir que <span class="math inline">\(\delta = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>, de lo que podemos establecer una expresión de autocovarianzas para cualquier valor <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(\tau) &amp; = &amp; \mathbb{E}[X_{t-\tau} X_t] \nonumber \\
    &amp; = &amp; \mathbb{E}[X_{t-\tau} (\delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q})] \nonumber \\
    &amp; = &amp; a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2) + \ldots + a_p \gamma(\tau - p) \nonumber \\
    &amp;   &amp; + \mathbb{E}[X_{t-\tau} U_{t}] - b_1  \mathbb{E}[X_{t-\tau} U_{t-1}] - \ldots  - b_q  \mathbb{E}[X_{t-\tau} U_{t-q}]
\end{eqnarray}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos nacionales de salida para estimar un <span class="math inline">\(ARMA(p, q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación, consideremos una transformación de la serie en diferencias logarítmicas, ya que, según la gráfica en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig47">3.10</a>, esa es la que puede ser estacionaria.</p>
<p>A continuación, estimaremos una <span class="math inline">\(ARMA(1, 1)\)</span> para la serie en diferencias logarítmicas (<span class="math inline">\(DLPaxNal_t\)</span>). También incorporaremos al análisis variables exógenas tales como dummies de estacionalidad. En particular, utilizaremos los meses de enero, febrero, julio y diciembre. No debe pasar desapercibido que un análisis de estacionalidad más formal debería considerar todos los meses para separar del término de error la parte que puede ser explicada por los ciclos estacionales.</p>
<p>Así obtenemos el siguiente resultado:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:ARMA01">Table 3.8: </span> ARMA(1, 1) para la variable <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_t\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-0.0025\)</span></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.6018\)</span></td>
<td align="center"><span class="math inline">\(DLPaxNal_{t-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0045)\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0964)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.9064\)</span></td>
<td align="center"><span class="math inline">\(U_{t-1}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0397)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.0867\)</span></td>
<td align="center"><span class="math inline">\(DEne_t\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0230)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(-\)</span></td>
<td align="center"><span class="math inline">\(0.0409\)</span></td>
<td align="center"><span class="math inline">\(DFeb_t\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0263)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.1529\)</span></td>
<td align="center"><span class="math inline">\(DJul_t\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0245)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"><span class="math inline">\(+\)</span></td>
<td align="center"><span class="math inline">\(0.0628\)</span></td>
<td align="center"><span class="math inline">\(DDic_t\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\((0.0223)\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(0.007096\)</span></td>
<td align="center"><span class="math inline">\(AIC\)</span></td>
<td align="center"><span class="math inline">\(=\)</span></td>
<td align="center"><span class="math inline">\(-475.12\)</span></td>
</tr>
</tbody>
</table></div>
<p>Donde entre paréntesis indicamos los errores estándar. Adicionalmente, reportamos el estadístico de Akaike (AIC). Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig412">3.15</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual, podemos concluir que tenemos una solución convergente y estable. Por su parte, la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig413">3.16</a> muestra los residuales de la estimación del <span class="math inline">\(ARMA(1, 1)\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_Roots_ARMA11.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig412"></span>
<img src="Plots/G_Roots_ARMA11.png" alt="Inveso de las Raíces del polinomio característico de un ARMA(1,1)" width="95%"><p class="caption">
Figure 3.15: Inveso de las Raíces del polinomio característico de un ARMA(1,1)
</p>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_Residuals_ARMA11.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig413"></span>
<img src="Plots/G_Residuals_ARMA11.png" alt="Residuales de un $ARMA(1, 1)$ de la serie $DLPaxNal_t$" width="95%"><p class="caption">
Figure 3.16: Residuales de un <span class="math inline">\(ARMA(1, 1)\)</span> de la serie <span class="math inline">\(DLPaxNal_t\)</span>
</p>
</div>
<p>En lo que resta de este capítulo, utilizaremos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salida, <span class="math inline">\(DLPaxNal_t\)</span>, para discutir los ejemplos que ilustran cada uno de los puntos teóricos que a continuación exponemos.</p>
</div>
</div>
<div id="función-de-autocorrelación-parcial" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Función de Autocorrelación Parcial<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>Ahora introduciremos el concepto de Función de Autocorrelación Parcial (PACF, por sus siglas en inglés). Primero, dadas las condiciones de estabilidad y de convergencia, si suponemos que los procesos AR, MA, ARMA o ARIMA tienen toda la información de los rezagos de la serie en conjunto y toda la información de los promedios móviles del término de error, resulta importante construir una métrica para distinguir el efecto de <span class="math inline">\(X_{t - \tau}\)</span> o el efecto de <span class="math inline">\(U_{t - \tau}\)</span> (para cualquier <span class="math inline">\(\tau\)</span>) sobre <span class="math inline">\(X_t\)</span> de forma individual.</p>
<p>La idea es construir una métrica de la correlación que existe entre las diferentes variables aleatorias, si para tal efecto se ha controlado el efecto del resto de la información. Así, podemos definir la ecuación que puede responder a este planteamiento como:
<span class="math display" id="eq:PACFEq">\[\begin{equation}
    X_t = \phi_{k1} X_{t-1} + \phi_{k2} X_{t-2} + \ldots + \phi_{kk} X_{t-k} + U_t
    \tag{3.55}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\phi_{ki}\)</span> es el coeficiente de la variable dada con el rezago <span class="math inline">\(i\)</span> si el proceso tiene un órden <span class="math inline">\(k\)</span>. Así, los coeficientes <span class="math inline">\(\phi_{kk}\)</span> son los coeficientes de la autocorrelación parcial (considerando un proceso AR(k)). Observemos que la autocorrelación parcial mide la correlación entre <span class="math inline">\(X_t\)</span> y <span class="math inline">\(X_{t-k}\)</span> que se mantiene cuando el efecto de las variables <span class="math inline">\(X_{t-1}\)</span>, <span class="math inline">\(X_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span> y <span class="math inline">\(X_{t-k-1}\)</span> en <span class="math inline">\(X_{t}\)</span> y <span class="math inline">\(X_{t-k}\)</span> ha sido eliminado.</p>
<p>Dada la expresión considerada en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:PACFEq">(3.55)</a>, podemos resolver el problema de establecer el valor de cada <span class="math inline">\(\phi_{ki}\)</span> mediante la solución del sistema que se representa en lo siguiente:
<span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(k)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(k - 1)\\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(k - 2)\\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(k - 3)\\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
        \rho(k - 1) &amp; \rho(k - 2) &amp; \ldots &amp; 1\\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        \phi_{k1} \\
        \phi_{k2} \\
        \phi_{k3} \\
        \vdots \\
        \phi_{kk} \\
    \end{array}
    \right]
\end{equation}\]</span></p>
<p>Del cual se puede derivar una solución, resolviendo por cualquier método que consideremos y que permita calcular la solución de sistemas de ecuaciones.</p>
<p>Posterior al planteamiento analítico, plantearemos un enfoque para interpretar las funciones de autocorrelación y autocorrelación parcial. Este enfoque pretende aportar al principio de parsimonia, en el cual podemos identificar el número de parámetros que posiblemente puede describir mejor a la serie en un modelo ARMA(p, q).</p>
<p>En el siguiente cuadro mostramos un resumen de las características que debemos observar para determinar el número de parámetros de cada uno de los componentes AR y MA. Lo anterior por observación de las funciones de autocorrelación y autocorrelación parcial. Este enfoque no es el más formal, más adelante implementaremos uno más formal y que puede ser más claro de cómo determinar el número de parámetros.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:AcAcp">Table 3.9: </span> Relación entre la Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie <span class="math inline">\(X_t\)</span>.</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Modelo</th>
<th align="center">Función de Autocorrelación</th>
<th align="center">Función de Autocorrelación Parcial</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">MA(q)</td>
<td align="center">Rompimienttos en la función</td>
<td align="center">No hay rompimientos</td>
</tr>
<tr class="even">
<td align="center">AR(p)</td>
<td align="center">No hay rompimientos</td>
<td align="center">Rompimienttos en la función</td>
</tr>
</tbody>
</table></div>
<p>. Continuando con el ejemplo en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig414">3.17</a> mostramos tanto la Función de Autocorrelación como la Función de Autocorrelación Parcial. En esta identificamos que ambas gráficas muestran que el modelo que explica a la variable <span class="math inline">\(DLPaxNal_t\)</span> tiene tanto componentes AR como MA. Sin embargo, dado lo errático del comportamiento de ambas funciones, resulta complicado determinar cuál sería un buen número de parámetros <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a considerar en el <span class="math inline">\(ARMA(p,q)\)</span>. Por esta razón, a continuación, plantearemos algunas pruebas más formales para determinar dichos parámetros.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_ACF_PACF.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig414"></span>
<img src="Plots/G_ACF_PACF.png" alt="Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie $DLPaxNal_t$" width="95%"><p class="caption">
Figure 3.17: Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie <span class="math inline">\(DLPaxNal_t\)</span>
</p>
</div>
</div>
<div id="selección-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Respecto de cómo estimar un proceso ARMA(p, q) –en general utilizaremos este modelo para discutir, pero lo planteado en esta sección es igualmente aplicable en cualquier otro caso como aquellos modelos que incluyen variables exógenas– existen diversas formas de estimar los parámetros <span class="math inline">\(a_i\)</span> y <span class="math inline">\(b_i\)</span>: i) por máxima verosimilitud y ii) por mínimos cuadrados ordinarios. El primer caso requiere que conozcamos la distribución del proceso aleatorio <span class="math inline">\(U_t\)</span>. El segundo, por el contrario, no requiere el mismo supuesto. No obstante, para el curso utilizaremos el método de máxima verosimilitud.</p>
<p>Otra duda que debe quedar hasta el momento es ¿cómo determinar el orden <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> del proceso ARMA(p, q)? La manera más convencional y formal que existe para tal efecto es utilizar los criterios de información. Así, el orden se elige de acuerdo a aquel criterio de información que resulta ser el mínimo. En el caso de <span class="math inline">\(d\)</span> se selecciona revisando la gráfica que parezca más estacionaria–más adelante mostraremos un proceso más formal para su selección.</p>
<p>Los criterios de información más comunes son los siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>FPE (Final Prediction Error):
<span class="math display">\[\begin{equation}
FPE = \frac{T+m}{T-m}\frac{1}{T}\sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2
\end{equation}\]</span></p></li>
<li><p>Akaike:
<span class="math display">\[\begin{equation}
AIC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2}{T}
\end{equation}\]</span></p></li>
<li><p>Schwarz:
<span class="math display">\[\begin{equation}
SC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{ln(T)}{T}
\end{equation}\]</span></p></li>
<li><p>Hannan - Quinn:
<span class="math display">\[\begin{equation}
HQ = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2 ln(ln(T))}{T}
\end{equation}\]</span></p></li>
</ol>
<p>Donde <span class="math inline">\(\hat{U}_t^{(p)}\)</span> son los residuales estimados mediante un proceso ARIMA y <span class="math inline">\(m\)</span> es el número de parametros estimados: <span class="math inline">\(m = p + q + 0 + 1\)</span> (ya que asumimos que <span class="math inline">\(d = 0\)</span>). Una propiedad que no se debe perder de vista es que los criterios de información cumplen la siguiente relación:
<span class="math display">\[\begin{equation}
    orden(SC) \leq orden(HQ) \leq orden(AIC)
\end{equation}\]</span></p>
<p>Por esta razón, durante el curso solo utilizaremos el criterio de Akaike para determinar el orden óptimo del proceso ARMA, ya que ello garantiza el orden más grande posible.</p>
<p>. Ahora veamos un ejemplo de estimación del número de rezagos óptimo de un <span class="math inline">\(ARMA(p, q)\)</span>. Retomemos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salidas, pero ahora incluiremos las variables exógenas de dummies estacionales: enero, febrero, julio y diciembre.</p>
<p>Como mencionamos, las gráficas de las funciones de autocorrelación permiten observar el valor de la correlación existente entre la variable en el momento <span class="math inline">\(t\)</span> con cada uno de los rezagos. Incluso la Función de Autocorrelación Parcial puede ayudar a determinar el número máximo de rezagos que se debe incluir en el proceso <span class="math inline">\(AR(p)\)</span>. No obstante, una métrica más formal es el uso de los criterios de información. En nuestro caso, dado lo discutido, sólo utilizaremos el criterio de Akaike.</p>
<p>Al respecto, en el siguiente cuadro reportamos el criterio de Akaike que resulta de aplicar dicho criterio a los residuales resultantes de cada combinación de procesos <span class="math inline">\(ARMA(p, q)\)</span>. La forma de escoger será aquel modelo que reporta el criterio de Akaike menor. En la cuarta columna de la tabla se señala el valor del criterio de información que resulta ser el mínimo de todos los posibles.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:CIARMA">Table 3.10: </span> Criterio de Akike para diferentes modelos <span class="math inline">\(ARMA(p, q)\)</span> de la serie <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<thead><tr class="header">
<th align="center">Modelo</th>
<th align="center">AR(p)</th>
<th align="center">MA(p)</th>
<th align="center">Akaike (AIC)</th>
<th align="center">Óptimo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">-475.1190</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">-473.4397</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">-483.1239</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">-482.4932</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">-506.9880</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">1</td>
<td align="center">6</td>
<td align="center">-533.9411</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">-473.4758</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">24</td>
<td align="center">4</td>
<td align="center">6</td>
<td align="center">-752.8996</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">36</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">-752.2632</td>
<td align="center"></td>
</tr>
</tbody>
</table></div>
<p>El cuadro anterior reporta un resumen de los resultados para 36 diferentes modelos, todos incluyen variables exógenas. Como resultado del análisis concluimos que el modelo más adecuado es el 24, el cual considera un <span class="math inline">\(ARMA(4, 6)\)</span>, con variables dummies para controlar la estacionalidad de los meses de enero, febrero, julio y diciembre. Más adelante mostramos los resultados del modelo.</p>
<p>No obstante, una inspección de los residuales del modelo nos permite sospechar que requiere de incluir un par de dummies más. Ambas, asociadas con la caída del transporte aéreo en 2009, principalmente asociadas con la crisis mundial de ese año. La Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig415">3.18</a> muestra los residuales mencionados.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_Residuals_ARMA46.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig415"></span>
<img src="Plots/G_Residuals_ARMA46.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$" width="95%"><p class="caption">
Figure 3.18: Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>
</p>
</div>
<p>Una vez incluidas dos dummies más para mayo y junio de 2009, analizamos un total de 36 modelos ARMA y determinamos que el orden que minimiza el criterio de Akaike es un <span class="math inline">\(ARMA(4, 6)\)</span>. El siguiente cuadro muestra los resultados para este nuevo modelo. No lo motramos en esta sección, pero ambos modelos reportados tienen raices de sus respectivos polinomios característicos menores a 1 en valor absoluto. En la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig416">3.19</a> mostramos los residuales ahora ajustados por las dummies de mayo y junio de 2009.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:ARMApq">Table 3.11: </span> Modelo <span class="math inline">\(ARMA(p, q)\)</span> de la serie <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<thead><tr class="header">
<th align="center">Variable</th>
<th align="center">Coeficiente</th>
<th align="center">Error Est.</th>
<th align="center">Coeficiente</th>
<th align="center">Error Est.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="center">Modelo 1</td>
<td align="center">Modelo 2</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Constante</td>
<td align="center">0.0134</td>
<td align="center">0.0033</td>
<td align="center">0.0145</td>
<td align="center">0.0029</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-1}\)</span></td>
<td align="center">0.0004</td>
<td align="center">0.0011</td>
<td align="center">0.0014</td>
<td align="center">0.0016</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-2}\)</span></td>
<td align="center">0.9997</td>
<td align="center">0.0019</td>
<td align="center">0.9988</td>
<td align="center">0.0024</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-3}\)</span></td>
<td align="center">0.0001</td>
<td align="center">0.0012</td>
<td align="center">0.0002</td>
<td align="center">0.0014</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-4}\)</span></td>
<td align="center">-0.9997</td>
<td align="center">0.0004</td>
<td align="center">-0.9993</td>
<td align="center">0.0009</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-1}\)</span></td>
<td align="center">-0.2877</td>
<td align="center">0.0670</td>
<td align="center">-0.1472</td>
<td align="center">0.0633</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-2}\)</span></td>
<td align="center">-1.2028</td>
<td align="center">0.0608</td>
<td align="center">-1.3323</td>
<td align="center">0.0625</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-3}\)</span></td>
<td align="center">0.2302</td>
<td align="center">0.0765</td>
<td align="center">0.1201</td>
<td align="center">0.0756</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-4}\)</span></td>
<td align="center">1.2085</td>
<td align="center">0.0645</td>
<td align="center">1.3142</td>
<td align="center">0.0642</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-5}\)</span></td>
<td align="center">-0.2634</td>
<td align="center">0.0708</td>
<td align="center">-0.1034</td>
<td align="center">0.0717</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-6}\)</span></td>
<td align="center">-0.2171</td>
<td align="center">0.0606</td>
<td align="center">-0.3864</td>
<td align="center">0.0657</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DEne_{t}\)</span></td>
<td align="center">-0.2904</td>
<td align="center">0.0172</td>
<td align="center">-0.2865</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DFeb_{t}\)</span></td>
<td align="center">-0.1312</td>
<td align="center">0.0170</td>
<td align="center">-0.1273</td>
<td align="center">0.0140</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DJul_{t}\)</span></td>
<td align="center">0.3303</td>
<td align="center">0.0173</td>
<td align="center">0.3164</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Dic_{t}\)</span></td>
<td align="center">-0.0118</td>
<td align="center">0.0169</td>
<td align="center">-0.0138</td>
<td align="center">0.0137</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DMay2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">-0.3378</td>
<td align="center">0.0360</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DJun2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.2371</td>
<td align="center">0.0359</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center">0.001841</td>
<td align="center"></td>
<td align="center">0.001283</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">AIC</td>
<td align="center">-752.9</td>
<td align="center"></td>
<td align="center">-835.73</td>
<td align="center"></td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_Residuals_ARMA46_D.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig416"></span>
<img src="Plots/G_Residuals_ARMA46_D.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$" width="95%"><p class="caption">
Figure 3.19: Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>
</p>
</div>
</div>
<div id="pronósticos" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> Pronósticos<a class="anchor" aria-label="anchor" href="#pron%C3%B3sticos"><i class="fas fa-link"></i></a>
</h2>
<p>Para pronósticar el valor de la serie es necesario determinar cuál es el valor esperado de la serie en un momento <span class="math inline">\(t + \tau\)</span> condicional en que ésta se comporta como un <span class="math inline">\(AR(p)\)</span>, un <span class="math inline">\(MA(q)\)</span> o un <span class="math inline">\(ARMA(p, q)\)</span> y a que los valores antes de <span class="math inline">\(t\)</span> están dados. Por lo que el pronóstico de la serie estará dado por una expresión:
<span class="math display" id="eq:ARMApqFor">\[\begin{eqnarray}
    \mathbb{E}_t[X_{t+\tau}] = \delta + a_1 \mathbb{E}_t[X_{t+\tau-1}] + a_2 \mathbb{E}_t[X_{t+\tau-2}] + \ldots + + a_p \mathbb{E}_t[X_{t+\tau-p}]
    \tag{3.56}
\end{eqnarray}\]</span></p>
<p>Lo anterior para todo <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span> y considerando que los componentes MA(q) en la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARMApqFor">(3.56)</a> son cero dado que para todo valor <span class="math inline">\(t + \tau\)</span> es cierto que <span class="math inline">\(\mathbb{E}_t[U_{t+\tau}]\)</span>.</p>
<p>Continuando con el ejemplo, en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig417">3.20</a> mostramos el resultado del pronóstico de la serie a partir del modelo ARMA(4, 6) que hemos discutido anteriormente.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte_ARIMA.xlsx"</span>, </span>
<span>                    sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Mar2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jun2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Jun2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Jul2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Mar2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Ene</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Feb</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Jul</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Dic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">D_Dic</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ARMA_Ex_DLPax_Nal_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>                             xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene</span>, <span class="va">D_Feb</span>, <span class="va">D_Jul</span>, </span>
<span>                                          <span class="va">D_Dic</span>, <span class="va">D_Mar2020</span>, </span>
<span>                                          <span class="va">D_Abr2020</span>, <span class="va">D_Jun2020</span>, </span>
<span>                                          <span class="va">D_Jul2020</span>, <span class="va">D_Mar2021</span><span class="op">)</span>,</span>
<span>                             method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Predict_Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Predict_Base_Transporte_ARIMA.xlsx"</span>, </span>
<span>                            sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2020_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Mar2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr2020_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jun2020_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jun2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul2020_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jul2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2021_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Mar2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Ene</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Feb</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jul</span>, </span>
<span>           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Dic_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Dic</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2025</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Nal_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ARMA_Ex_DLPax_Nal_2</span>, n.ahead <span class="op">=</span> <span class="fl">24</span>, </span>
<span>                      newxreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene_f</span>, <span class="va">D_Feb_f</span>, <span class="va">D_Jul_f</span>, </span>
<span>                                      <span class="va">D_Dic_f</span>, <span class="va">D_Mar2020_f</span>, </span>
<span>                                      <span class="va">D_Abr2020_f</span>, <span class="va">D_Jun2020_f</span>, </span>
<span>                                      <span class="va">D_Jul2020_f</span>, <span class="va">D_Mar2021_f</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pronostico_Arima</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Pronostico_Arima.xlsx"</span>, </span>
<span>                               sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span> <span class="op">&lt;-</span> <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span><span class="op">[</span><span class="fl">306</span> <span class="op">+</span> <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span><span class="op">[</span><span class="fl">306</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">DLPax_Nal_f</span><span class="op">$</span><span class="va">pred</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span> <span class="co"># NO notacion cientifica</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Pronostico_Arima</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Periodo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Pax_Nal_f</span>, color <span class="op">=</span> <span class="st">"Pax_Nal_f"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Pax_Nal</span>, color <span class="op">=</span> <span class="st">"Pax_Nal"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#theme_bw() + </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Pasajeros"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, </span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Pasajeros en vuelos nacionales (Salidas)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"(Ene-2000 a Jun-2019)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig417"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig417-1.png" alt="Pronóstico de la serie $PaxNAl_t$ a partir de una ARMA(4,6) en diferencias logaritmicas" width="672"><p class="caption">
Figure 3.20: Pronóstico de la serie <span class="math inline">\(PaxNAl_t\)</span> a partir de una ARMA(4,6) en diferencias logaritmicas
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"Pax_Nal_f.png"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">15</span>, units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="desestacionalización-y-filtrado-de-series" class="section level2" number="3.10">
<h2>
<span class="header-section-number">3.10</span> Desestacionalización y filtrado de Series<a class="anchor" aria-label="anchor" href="#desestacionalizaci%C3%B3n-y-filtrado-de-series"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="motivación" class="section level2" number="3.11">
<h2>
<span class="header-section-number">3.11</span> Motivación<a class="anchor" aria-label="anchor" href="#motivaci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>Existen múltiples enfoques para la desestacionalización de series. Algunos modelos, por ejemplo, pueden estar basados en modelos ARIMA como un conjunto de dummies. No obstante, en el caso particular que discutiremos en este curso, estará basado en un modelo ARIMA de la serie. Este enfoque está basado en el modelo X11 de la oficina del censo de Estados Unidos (Census Bureau) el cual es conocido como el modelo X13-ARIMA-SEATS. El modelo X13-ARIMA-SEATS es, como su nombre lo indica, la combinación de un modelo ARIMA con componentes estacionales (por la traducción literal de la palabra: seasonal).</p>
<p>Un modelo ARIMA estacional emplea la serie en diferencias y como regresores los valores rezagados de las diferencias de la serie tantas veces como procesos estacionales <span class="math inline">\(s\)</span> existan en ésta, con el objeto de remover los efectos aditivos de la estacionalidad. Sólo para entender qué significa este mecanismo, recordemos que cuando se utiliza la primera diferencia de la serie respecto del periodo inmediato anterior se remueve la tendencia. Por su parte, cuando se incluye la diferencia respecto del mes <span class="math inline">\(s\)</span> se está en el caso en que se modela la serie como una media móvil en términos del rezago <span class="math inline">\(s\)</span>.</p>
<p>El modelo ARIMA estacional incluye como componentes autorregresivos y de medias móviles a los valores rezagados de la serie en el periodo <span class="math inline">\(s\)</span> en diferencias. El ARIMA(p, d, q)(P, D, Q) estacional puede ser expresado de la siguiente manera utilizando el operador rezago <span class="math inline">\(L\)</span>:
<span class="math display" id="eq:ARIMAseas">\[\begin{equation}
    \Theta_P(L^s) \theta_p(L) (1 - L^s)^D (1 - L)^d X_t = \Psi_Q(L^s) \psi_q(L) U_t
    \tag{3.57}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\Theta_P(.)\)</span>, <span class="math inline">\(\theta_p(.)\)</span>, <span class="math inline">\(\Psi_Q(.)\)</span> y <span class="math inline">\(\psi_q(.)\)</span> son polinomios de <span class="math inline">\(L\)</span> de orden <span class="math inline">\(P\)</span>, <span class="math inline">\(p\)</span>, <span class="math inline">\(Q\)</span> y <span class="math inline">\(q\)</span> respectivamente. En general, la representación es de una serie no estacionaria, aunque si <span class="math inline">\(D = d = 0\)</span> y las raíces del polinomio característico (de los polinomios del lado izquierdo de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARIMAseas">(3.57)</a> todas son más grandes que 1 en valor absoluto, el proceso modelado será estacionario.</p>
<p>Si bien es cierto que existen otras formas de modelar la desestacionalización, como la modelación en diferencias con dummies para identificar ciertos patrones regulares, en los algoritmos disponibles como el X11 o X13-ARIMA-SEATS se emplea la formulación de la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:ARIMAseas">(3.57)</a>. A continuación, implementaremos la desestacionalización de una serie.</p>
<p>Como ejemplo utilizaremos la serie del Índice Nacional de Precios al Consumidor (INPC). Podemos ver que la serie original del INPC y su ajuste estacional bajo una metodología X13-ARIMA-SEATS son como se muestra en la Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig51">3.21</a>.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.seasonal.website">seasonal</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'seasonal'</code></pre>
<pre><code>## The following object is masked from 'package:tibble':
## 
##     view</code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.seasonal.website">seasonalview</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'seasonalview'</code></pre>
<pre><code>## The following object is masked from 'package:seasonal':
## 
##     view</code></pre>
<pre><code>## The following object is masked from 'package:tibble':
## 
##     view</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/">shiny</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_VAR.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">INPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">INPC</span>, </span>
<span>           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>           freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Seas_INPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">INPC</span><span class="op">)</span></span>
<span></span>
<span><span class="va">INPC_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/final.html">final</a></span><span class="op">(</span><span class="va">Seas_INPC</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#names(Seas_INPC)</span></span>
<span></span>
<span><span class="co">#summary(Seas_INPC)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Seas_INPC</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig51"></span>
<img src="Notas-Series-Tiempo_files/figure-html/fig51-1.png" alt="Índice Nacional de Precios al Consumidor ($INPC_t$) y su serie desestacionalizada utilizando un proceso X13-ARIMA-SEATS" width="95%"><p class="caption">
Figure 3.21: Índice Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>) y su serie desestacionalizada utilizando un proceso X13-ARIMA-SEATS
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forma Facil:</span></span>
<span></span>
<span><span class="co">#view(Seas_INPC)</span></span>
<span></span>
<span><span class="va">TC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">TC</span>, </span>
<span>         start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>         freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Seas_TC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">TC</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TC_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/final.html">final</a></span><span class="op">(</span><span class="va">Seas_TC</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CETE28</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">CETE28</span>, </span>
<span>             start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>             freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Seas_CETE28</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">CETE28</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CETE28_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/final.html">final</a></span><span class="op">(</span><span class="va">Seas_CETE28</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IGAE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">IGAE</span>, </span>
<span>           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>           freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Seas_IGAE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">IGAE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IGAE_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/final.html">final</a></span><span class="op">(</span><span class="va">Seas_IGAE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IPI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">IPI</span>, </span>
<span>          start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>          freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Seas_IPI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">IPI</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IPI_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/final.html">final</a></span><span class="op">(</span><span class="va">Seas_IPI</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">INPC_Ad</span>, <span class="va">TC_Ad</span>, <span class="va">CETE28_Ad</span>, <span class="va">IGAE_Ad</span>, <span class="va">IPI_Ad</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Datos_Ad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">Datos</span>, <span class="va">Datos_Ad</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">Datos_Ad</span>, file <span class="op">=</span> <span class="st">"BD/Datos_Ad0.RData"</span><span class="op">)</span></span></code></pre></div>
El mismo procesamiento puede ser seguido para todas las series que busquemos analizar. En particular, en adelante, además del INPC que incluimos en la lista, utilizaremos las siguientes series, así como su versión desestacionalizada:
</div>
<div id="filtro-hodrick-prescott" class="section level2" number="3.12">
<h2>
<span class="header-section-number">3.12</span> Filtro Hodrick-Prescott<a class="anchor" aria-label="anchor" href="#filtro-hodrick-prescott"><i class="fas fa-link"></i></a>
</h2>
<p>Como último tema de los procesos univariados y que no necesariamente aplican a series estacionarias, a continuación desarrollaremos el procedimiento conocido como filtro de Hodrick y Prescott (1997). El trabajo de estos autores era determinar una técnica de regresión que permitiera utilizar series agregadas o macroeconómicas para separarlas en dos componentes: uno de ciclo de negocios y otro de tendencia. En su trabajo original, Hodrick y Prescott (1997) utilizaron datos trimestrales de algunas series como el Gross Domestic Product (GNP, por sus siglas en Inglés), los agregados monetarios M1, empleo, etc., de los Estados Unidos que fueron observados posteriormente a la Segunda Guerra Mundial.</p>
<p>El marco conceptual de Hodrick y Prescott (1997) parte de suponer una serie <span class="math inline">\(X_t\)</span> que se puede descomponer en la suma de componente de crecimiento tendencial, <span class="math inline">\(g_t\)</span>, y su componente de ciclio de negocios, <span class="math inline">\(c_t\)</span>, de esta forma para <span class="math inline">\(t = 1, 2, \ldots, T\)</span> tenemos que:
<span class="math display" id="eq:HPEq">\[\begin{equation}
    X_t = g_t + c_t
    \tag{3.58}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-y-modelos-univariados.html#eq:HPEq">(3.58)</a> se asume que el ajuste de la ruta seguida por <span class="math inline">\(g_t\)</span> es resultado de la suma de los cuadrados de su segunda diferencia. En esa misma ecuación asumiremos que <span class="math inline">\(c_t\)</span> son las desviaciones de <span class="math inline">\(g_t\)</span>, las cuales en el largo plazo tienen una media igual a cero (0). Por esta razón, se suele decir que el filtro de Hodrick y Prescott representa una descomposición de la serie en su componente de crecimiento natural y de sus desviaciones transitorias que en promedio son cero, en el largo plazo.</p>
<p>Estas consideraciones que hemos mencionado señalan que el procesimiento de Hodrick y Prescott (1997) implican resolver el siguiente problema minimización para determinar cada uno de los componentes en que <span class="math inline">\(X_t\)</span> se puede descomponer:
<span class="math display">\[\begin{equation}
    \min_{\{ g_t \}^T_{t = -1} } \left[ \sum^T_{t = 1} c^2_t + \lambda \sum^T_{t = 1} [ \Delta g_t - \Delta g_{t-1}]^2 \right]
\end{equation}\]</span></p>
Donde <span class="math inline">\(\Delta g_t = g_t - g_{t-1}\)</span> y <span class="math inline">\(\Delta g_{t-1} = g_{t-1} - g_{t-2}\)</span>; <span class="math inline">\(c_t = X_t - g_t\)</span>, y el parámetro <span class="math inline">\(\lambda\)</span> es un número positivo que penaliza la variabilidad en el crecimiento de las series. De acuerdo con el trabajo de Hodrick y Prescott (1997) la constante <span class="math inline">\(\lambda\)</span> debe tomar valores específicos de acuerdo con la periodicidad de las series. Así, <span class="math inline">\(\lambda\)</span> será:
<p>En resumen, podemos decir que el filtro de Hodrick y Prescott (1997) es un algoritmo que mimiza las distancias o variaciones de la trayectoria de largo plazo. De esta forma, determina una trayectoria estable de largo plazo, por lo que las desviaciones respecto de esta trayectoria serán componentes de ciclos de negocio o cambios transitorios (tanto positivos como negativos).</p>
<p>A contiuación, ilustraremos el filtro de Hodrick y Prescott (1997) para dos series desestacionalizadas: <span class="math inline">\(INPC_t\)</span> y <span class="math inline">\(TC_t\)</span>. Las Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig52">3.22</a> y Figura <a href="procesos-estacionarios-y-modelos-univariados.html#fig:fig53">3.23</a> muestran los resultados de la implementación del filtro.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.mbalcilar.net">mFilter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm">plm</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'plm'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     between, lag, lead</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"BD/Datos_Ad0.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">INPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos_Ad</span><span class="op">$</span><span class="va">INPC_Ad</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos_Ad</span><span class="op">$</span><span class="va">TC_Ad</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">INPC_hpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mFilter/man/hpfilter.html">hpfilter</a></span><span class="op">(</span><span class="va">INPC</span>, freq <span class="op">=</span> <span class="fl">14400</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot(INPC_hpf)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_INPC_HP.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig52"></span>
<img src="Plots/G_INPC_HP.png" alt="Descomposición del Índice Nacional de Precios al Consumidor ($INPC_t$) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)" width="95%"><p class="caption">
Figure 3.22: Descomposición del Índice Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)
</p>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TC_hpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mFilter/man/hpfilter.html">hpfilter</a></span><span class="op">(</span><span class="va">TC</span>, freq <span class="op">=</span> <span class="fl">14400</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot(TC_hpf)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"Plots/G_TC_HP.png"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig53"></span>
<img src="Plots/G_TC_HP.png" alt="Descomposición del Tipo de Cambio FIX ($TC_t$) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)" width="95%"><p class="caption">
Figure 3.23: Descomposición del Tipo de Cambio FIX (<span class="math inline">\(TC_t\)</span>) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)
</p>
</div>
<div id="filtro-hodrick-prescott-planteado-por-st-amant-van-norden" class="section level3" number="3.12.1">
<h3>
<span class="header-section-number">3.12.1</span> Filtro Hodrick-Prescott planteado por St-Amant &amp; van Norden<a class="anchor" aria-label="anchor" href="#filtro-hodrick-prescott-planteado-por-st-amant-van-norden"><i class="fas fa-link"></i></a>
</h3>
<p>Existen una técnica adicional que soluciona un problema de distribuciones de colas pesadas es el planteado por St-Amant &amp; van Norden. Analicemos ese caso. Método tradicional de HP consiste en minimizar la serie <span class="math inline">\(\{ \tau_t \}_{t=-1}^T\)</span>:</p>
<p><span class="math display">\[\begin{equation}
  \sum_{t=1}^T (y_t - \tau_t)^2 + \lambda \sum_{t=1}^{T} [(\tau_{t} - \tau_{t-1}) - (\tau_{t-1} - \tau_{t-2})]^2
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\lambda\)</span> es un parámetro fijo (determinado ex-ante) y <span class="math inline">\(\tau_t\)</span> es un componente de tendencia de <span class="math inline">\(y_t\)</span>.</p>
<p>Sin pérdida de generalidad, asumiremos que <span class="math inline">\(\tau_{-1}\)</span> y <span class="math inline">\(\tau_{0}\)</span> son cero (0). De esta manera, la forma matricial del filtro HP es:
<span class="math display">\[\begin{equation}
  (Y - G)'(Y - G) + \lambda G' K' K G
\end{equation}\]</span></p>
<p>La derivada de los anteriores:
<span class="math display">\[\begin{equation}
  -2 Y + 2 G + \lambda 2 K' K G = 0
\end{equation}\]</span></p>
<p>Despejando:
<span class="math display">\[\begin{equation}
  G_{hp} = [I_T + \lambda K' K]^{-1} Y
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(G\)</span> es el vector de tendencia, <span class="math inline">\(Y\)</span> es el vector de la serie de datos, <span class="math inline">\(\lambda\)</span> es la constante tradicional, y <span class="math inline">\(K\)</span> es de dimensión <span class="math inline">\(T \times T\)</span> y está dada por la expresión:
<span class="math display">\[\begin{equation}
  K =
  \begin{pmatrix}
  1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
  -2 &amp; 1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
  1 &amp; -2 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
  0 &amp; 1 &amp; -2 &amp; 1 &amp; \ldots &amp; 0 \\
  \vdots &amp; \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots \\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1 \\
  \end{pmatrix}
\end{equation}\]</span></p>
<p>Así:</p>
<p><span class="math display">\[\begin{equation}
  K' =
  \begin{pmatrix}
  1 &amp; -2 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
  0 &amp; 1 &amp; -2 &amp; 1 &amp; \ldots &amp; 0 \\
  0 &amp; 0 &amp; 1 &amp; -2 &amp; \ldots &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; 1 &amp; \ldots &amp; 0 \\
  \vdots &amp; \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots \\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1 \\
  \end{pmatrix}
\end{equation}\]</span></p>
<p>Método modificado de HP consiste en minimizar los valores de la serie <span class="math inline">\(\{ \tau_t \}_{t=1}^T\)</span>:
<span class="math display">\[\begin{equation}
  \sum_{t=1}^T (y_t - \tau_t)^2 + \lambda \sum_{t=2}^{T-1} [(\tau_{t+1} - \tau_t) - (\tau_t     - \tau_{t-1})]^2 + \lambda_{ss} \sum_{t=T-j}^{T} [\Delta \tau_t - u_{ss}]
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\lambda\)</span> es una parámetro fijo (determinado ex-ante), <span class="math inline">\(\tau_t\)</span> es un componente de tendencia de <span class="math inline">\(y_t\)</span>, y los nuevos parámetros son <span class="math inline">\(u_{ss}\)</span> y <span class="math inline">\(\lambda_{ss}\)</span> ajustadas por el procedimiento de Marcet y Ravn (2004).</p>
<p>Este procedimiento asume que parte del filtro HP y que esta versión tiene el problema de pérdida de información al final y al principio de la muestra. La razón es que es un procedimeinto univariado que requiere de mucha información futura y pasada para mejorar el ajuste.</p>
<p>El compoenente adicional al filtro HP es un componente de castigo por desviaciones de la tasa de crecimiento de largo plazo, <span class="math inline">\(u_{ss}\)</span>.</p>
<p>El proceso de selección de <span class="math inline">\(\lambda_{ss}\)</span> es e propuesto por Marcet y Ravn (2004), el cual consiste en utilizar un <span class="math inline">\(\lambda\)</span> convencional y el filtro HP convencional para estimar la siguiente función:
<span class="math display">\[\begin{equation}
  F(\lambda) = \frac{\sum_{t=2}^{T-1} ((\tau_{t+1} - \tau_t) - (\tau_t -                 \tau_{t-1}))^2}{\sum_{t=1}^T (y_t - \tau_t)^2}
\end{equation}\]</span></p>
<p>Entonces el valor de <span class="math inline">\(\lambda_{ss}\)</span> será aquel que:
<span class="math display">\[\begin{equation}
  F(\lambda_{ss}) = \frac{\sum_{t=2}^{T-1} ((\tau_{t+1} - \tau_t) - (\tau_t - \tau_{t-1}))^2}{\sum_{t=1}^T (y_t - \tau_t)^2} = F(\lambda)
\end{equation}\]</span></p>
<p>Nota: Antón (2009) estimó <span class="math inline">\(\lambda_{ss} = 1096\)</span> para datos trimestrales del PIB.</p>
<p>La forma matricial del filtro HP-SAVN es:
<span class="math display">\[\begin{equation}
  (Y - G)'(Y - G) + \lambda G' K' K G + \lambda_{ss} (L^j G + \overline{u}_{ss} M^j)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(L^j = (0, 0, \ldots, 0, -1, 0, \ldots, 0, 1)\)</span>, en el cual el valor <span class="math inline">\(-1\)</span> es en la posición <span class="math inline">\(T-j-1\)</span>-ésima, y <span class="math inline">\(M^j\)</span> es un vector que toma valores de cero hasta antes de <span class="math inline">\(T-j\)</span> y de 1 después.</p>
<p>La derivada de los anteriores:
<span class="math display">\[\begin{equation}
  -2 Y + 2 G + \lambda 2 K' K G + \lambda_{ss} L'^j = 0
\end{equation}\]</span></p>
<p>Despejando:
<span class="math display">\[\begin{equation}
  G_{SAVN} = \frac{1}{2} [I_T + \lambda K' K]^{-1} (2 Y - \lambda_{ss} L'^j)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
  G_{SAVN} = [I_T + \lambda K' K]^{-1} Y - \frac{1}{2} [I_T + \lambda K' K]^{-1} \lambda_{ss} L'^j
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(G\)</span> es el vector de tendencia, <span class="math inline">\(Y\)</span> es el vector de la serie de datos, <span class="math inline">\(\lambda\)</span> es la constante tradicional, y <span class="math inline">\(K\)</span> es de dimensión <span class="math inline">\(T \times T\)</span> y está dada por la expresión:</p>
<p><span class="math display">\[\begin{equation}
  K' =
  \begin{pmatrix}
  1 &amp; -2 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
  0 &amp; 1 &amp; -2 &amp; 1 &amp; \ldots &amp; 0 \\
  \vdots &amp; \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots \\
  0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1 \\
  \end{pmatrix}
\end{equation}\]</span></p>
<p>Dicho lo anterior, podemos modificar <span class="math inline">\(F(\lambda)\)</span> para el filtro HP convencional como en forma matricial:
<span class="math display">\[\begin{equation}
  F(\lambda) = \frac{G' K' K G}{(Y - G)'(Y - G)}
\end{equation}\]</span></p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="introducci%C3%B3n-al-an%C3%A1lisis-de-series-de-tiempo-y-elementos-de-ecuaciones-en-diferencia.html"><span class="header-section-number">2</span> Introducción al Análisis de Series de Tiempo y Elementos de Ecuaciones en Diferencia</a></div>
<div class="next"><a href="procesos-no-estacionarios-univariados.html"><span class="header-section-number">4</span> Procesos No Estacionarios Univariados</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#procesos-estacionarios-y-modelos-univariados"><span class="header-section-number">3</span> Procesos Estacionarios y Modelos Univariados</a></li>
<li><a class="nav-link" href="#definici%C3%B3n-de-ergodicidad-y-estacionariedad"><span class="header-section-number">3.1</span> Definición de ergodicidad y estacionariedad</a></li>
<li><a class="nav-link" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n"><span class="header-section-number">3.2</span> Función de autocorrelación</a></li>
<li><a class="nav-link" href="#procesos-estacionarios-univariados"><span class="header-section-number">3.3</span> Procesos estacionarios univariados</a></li>
<li>
<a class="nav-link" href="#procesos-autoregresivos-ar"><span class="header-section-number">3.4</span> Procesos Autoregresivos (AR)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ar1"><span class="header-section-number">3.4.1</span> AR(1)</a></li>
<li><a class="nav-link" href="#ar2"><span class="header-section-number">3.4.2</span> AR(2)</a></li>
<li><a class="nav-link" href="#arp"><span class="header-section-number">3.4.3</span> AR(p)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#procesos-de-medias-m%C3%B3viles-ma"><span class="header-section-number">3.5</span> Procesos de Medias Móviles (MA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ma1"><span class="header-section-number">3.5.1</span> MA(1)</a></li>
<li><a class="nav-link" href="#maq"><span class="header-section-number">3.5.2</span> MA(q)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#procesos-armap-q-y-arimap-d-q"><span class="header-section-number">3.6</span> Procesos ARMA(p, q) y ARIMA(p, d, q)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#arma1-1"><span class="header-section-number">3.6.1</span> ARMA(1, 1)</a></li>
<li><a class="nav-link" href="#armap-q"><span class="header-section-number">3.6.2</span> ARMA(p, q)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><span class="header-section-number">3.7</span> Función de Autocorrelación Parcial</a></li>
<li><a class="nav-link" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><span class="header-section-number">3.8</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)</a></li>
<li><a class="nav-link" href="#pron%C3%B3sticos"><span class="header-section-number">3.9</span> Pronósticos</a></li>
<li><a class="nav-link" href="#desestacionalizaci%C3%B3n-y-filtrado-de-series"><span class="header-section-number">3.10</span> Desestacionalización y filtrado de Series</a></li>
<li><a class="nav-link" href="#motivaci%C3%B3n"><span class="header-section-number">3.11</span> Motivación</a></li>
<li>
<a class="nav-link" href="#filtro-hodrick-prescott"><span class="header-section-number">3.12</span> Filtro Hodrick-Prescott</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#filtro-hodrick-prescott-planteado-por-st-amant-van-norden"><span class="header-section-number">3.12.1</span> Filtro Hodrick-Prescott planteado por St-Amant &amp; van Norden</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notas de Clase: Series de Tiempo</strong>" was written by Benjamín Oliva, Omar Alfaro Rivera, Emiliano Pérez Caullieres &amp; Luis Gerardo Ruíz. It was last built on 2025-09-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
